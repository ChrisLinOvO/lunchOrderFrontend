{"ast":null,"code":"import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n\nimport React, { Component } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport Icon from '../../icon';\nimport Overlay from '../../overlay';\nimport { func, obj, dom } from '../../util';\nimport Item from './item';\nimport SelectableItem from './selectable-item';\nimport { getChildSelected } from './util';\nvar bindCtx = func.bindCtx;\nvar setStyle = dom.setStyle;\nvar Popup = Overlay.Popup;\n/**\n * Menu.PopupItem\n * @order 2\n */\n\nvar PopupItem = (_temp = _class = function (_Component) {\n  _inherits(PopupItem, _Component);\n\n  function PopupItem(props) {\n    _classCallCheck(this, PopupItem);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n    bindCtx(_this, ['handleOpen', 'handlePopupOpen', 'handlePopupClose', 'getPopup']);\n    return _this;\n  }\n\n  PopupItem.prototype.getPopup = function getPopup(ref) {\n    this.popup = ref;\n  };\n\n  PopupItem.prototype.getOpen = function getOpen() {\n    var _props = this.props,\n        _key = _props._key,\n        root = _props.root;\n    var openKeys = root.state.openKeys;\n    return openKeys.indexOf(_key) > -1;\n  };\n\n  PopupItem.prototype.getPopupProps = function getPopupProps() {\n    var popupProps = this.props.root.props.popupProps;\n\n    if (typeof popupProps === 'function') {\n      popupProps = popupProps(this.props);\n    }\n\n    return popupProps;\n  };\n\n  PopupItem.prototype.handleOpen = function handleOpen(open, triggerType, e) {\n    var _props2 = this.props,\n        _key = _props2._key,\n        root = _props2.root;\n    root.handleOpen(_key, open, triggerType, e);\n    var popupProps = this.popupProps;\n    popupProps.onVisibleChange && popupProps.onVisibleChange(open, triggerType, e);\n  };\n\n  PopupItem.prototype.handlePopupOpen = function handlePopupOpen() {\n    var _props3 = this.props,\n        root = _props3.root,\n        level = _props3.level,\n        align = _props3.align,\n        autoWidth = _props3.autoWidth;\n    var _root$props = root.props,\n        rootPopupAutoWidth = _root$props.popupAutoWidth,\n        rootPopupAlign = _root$props.popupAlign,\n        direction = _root$props.direction;\n    var popupAlign = align || rootPopupAlign;\n    var popupAutoWidth = 'autoWidth' in this.props ? autoWidth : rootPopupAutoWidth;\n\n    try {\n      // avoid errors while dom removed and js executing\n      var itemNode = findDOMNode(this);\n      var menuNode = itemNode.parentNode;\n      this.popupNode = this.popup.getInstance().overlay.getInstance().getContentNode();\n      root.popupNodes.push(this.popupNode);\n\n      if (popupAutoWidth) {\n        var targetNode = direction === 'hoz' && level === 1 ? itemNode : menuNode;\n\n        if (targetNode.offsetWidth > this.popupNode.offsetWidth) {\n          setStyle(this.popupNode, 'width', targetNode.offsetWidth + 'px');\n        }\n      }\n\n      if (popupAlign === 'outside' && !(direction === 'hoz' && level === 1)) {\n        setStyle(this.popupNode, 'height', menuNode.offsetHeight + 'px');\n        this.popupNode.firstElementChild && setStyle(this.popupNode.firstElementChild, 'overflow-y', 'auto');\n      } // removeClass(this.popupNode, `${prefix}hide`);\n\n\n      var popupProps = this.popupProps;\n      popupProps.onOpen && popupProps.onOpen();\n    } catch (error) {\n      return null;\n    }\n  };\n\n  PopupItem.prototype.handlePopupClose = function handlePopupClose() {\n    var root = this.props.root;\n    var popupNodes = root.popupNodes;\n    var index = popupNodes.indexOf(this.popupNode);\n    index > -1 && popupNodes.splice(index, 1);\n    var popupProps = this.popupProps;\n    popupProps.onClose && popupProps.onClose();\n  };\n\n  PopupItem.prototype.renderItem = function renderItem(selectable, children, others) {\n    var _cx;\n\n    var _props4 = this.props,\n        _key = _props4._key,\n        root = _props4.root,\n        level = _props4.level,\n        inlineLevel = _props4.inlineLevel,\n        label = _props4.label,\n        className = _props4.className;\n    var _root$props2 = root.props,\n        prefix = _root$props2.prefix,\n        selectMode = _root$props2.selectMode;\n    var NewItem = selectable ? SelectableItem : Item;\n    var open = this.getOpen();\n    var _root$state = root.state,\n        selectedKeys = _root$state.selectedKeys,\n        _k2n = _root$state._k2n;\n    var isChildSelected = getChildSelected({\n      _key: _key,\n      _k2n: _k2n,\n      selectMode: selectMode,\n      selectedKeys: selectedKeys\n    });\n    var itemProps = {\n      'aria-haspopup': true,\n      'aria-expanded': open,\n      _key: _key,\n      root: root,\n      level: level,\n      inlineLevel: inlineLevel,\n      type: 'submenu'\n    };\n    itemProps.className = cx((_cx = {}, _cx[prefix + 'opened'] = open, _cx[prefix + 'child-selected'] = isChildSelected, _cx[className] = !!className, _cx));\n    return React.createElement(NewItem, _extends({}, itemProps, others), React.createElement('span', {\n      className: prefix + 'menu-item-text'\n    }, label), children);\n  };\n\n  PopupItem.prototype.renderPopup = function renderPopup(trigger, triggerType, positionProps, children) {\n    var _this2 = this;\n\n    var _props5 = this.props,\n        root = _props5.root,\n        level = _props5.level,\n        selectable = _props5.selectable,\n        propCls = _props5.className;\n    var direction = root.props.direction;\n    this.popupProps = this.getPopupProps();\n    var open = this.getOpen();\n\n    if (direction === 'hoz' && level === 1 && selectable) {\n      positionProps.target = function () {\n        return findDOMNode(_this2);\n      };\n    }\n\n    var posCls = positionProps.className,\n        otherPostion = _objectWithoutProperties(positionProps, ['className']);\n\n    var className = cx(propCls, posCls);\n    return React.createElement(Popup, _extends({\n      ref: this.getPopup\n    }, otherPostion, this.popupProps, {\n      canCloseByEsc: false,\n      trigger: trigger,\n      triggerType: triggerType,\n      visible: open,\n      pinFollowBaseElementWhenFixed: true,\n      onVisibleChange: this.handleOpen,\n      onOpen: this.handlePopupOpen,\n      onClose: this.handlePopupClose\n    }), React.createElement('div', {\n      className: className\n    }, children));\n  };\n\n  PopupItem.prototype.render = function render() {\n    var _this3 = this;\n\n    var _props6 = this.props,\n        root = _props6.root,\n        level = _props6.level,\n        hasSubMenu = _props6.hasSubMenu,\n        selectableFromProps = _props6.selectable,\n        children = _props6.children,\n        triggerType = _props6.triggerType,\n        align = _props6.align,\n        noIcon = _props6.noIcon,\n        rtl = _props6.rtl;\n    var others = obj.pickOthers(Object.keys(PopupItem.propTypes), this.props);\n    var _root$props3 = root.props,\n        prefix = _root$props3.prefix,\n        selectMode = _root$props3.selectMode,\n        direction = _root$props3.direction,\n        rootPopupAlign = _root$props3.popupAlign,\n        rootTriggerType = _root$props3.triggerType;\n    var popupAlign = align || rootPopupAlign;\n    var newTriggerType = triggerType || (hasSubMenu ? rootTriggerType : 'hover');\n    var newChildren = Array.isArray(children) ? children[0] : children; // let newChildren = Array.isArray(children) ? children[0] : children;\n    // newChildren = cloneElement(newChildren, {\n    //     className: cx({\n    //         [`${prefix}menu-popup-content`]: true,\n    //         [newChildren.props.className]: !!newChildren.props.className,\n    //         [`${prefix}hide`]: popupAutoWidth || popupAlign === 'outside'\n    //     })\n    // });\n\n    var selectable = selectMode && selectableFromProps;\n    var triggerIsIcon = selectable && newTriggerType === 'click';\n    var open = this.getOpen();\n    var positionProps = {};\n    var arrowProps = void 0;\n\n    if (direction === 'hoz' && level === 1) {\n      var _cx2;\n\n      positionProps.align = 'tl bl';\n      positionProps.className = prefix + 'menu-spacing-tb';\n      arrowProps = {\n        type: 'arrow-down',\n        className: cx((_cx2 = {}, _cx2[prefix + 'menu-hoz-icon-arrow'] = true, _cx2[prefix + 'open'] = open, _cx2))\n      };\n    } else {\n      if (popupAlign === 'outside') {\n        positionProps.target = function () {\n          return findDOMNode(root);\n        };\n\n        positionProps.align = 'tl tr';\n        positionProps.className = prefix + 'menu-spacing-lr ' + prefix + 'menu-outside';\n      } else {\n        if (triggerIsIcon) {\n          positionProps.target = function () {\n            return findDOMNode(_this3);\n          };\n        }\n\n        positionProps.align = 'tl tr';\n        positionProps.className = prefix + 'menu-spacing-lr';\n      }\n\n      arrowProps = {\n        type: 'arrow-right',\n        className: prefix + 'menu-icon-arrow ' + prefix + 'menu-symbol-popupfold'\n      };\n    }\n\n    var arrow = React.createElement(Icon, arrowProps);\n    var trigger = triggerIsIcon ? arrow : this.renderItem(selectable, noIcon ? null : arrow, others);\n    var popup = this.renderPopup(trigger, newTriggerType, positionProps, newChildren);\n    return triggerIsIcon ? this.renderItem(selectable, popup, others) : popup;\n  };\n\n  return PopupItem;\n}(Component), _class.menuChildType = 'submenu', _class.propTypes = {\n  _key: PropTypes.string,\n  root: PropTypes.object,\n  level: PropTypes.number,\n  hasSubMenu: PropTypes.bool,\n  noIcon: PropTypes.bool,\n  rtl: PropTypes.bool,\n  selectable: PropTypes.bool,\n\n  /**\n   * 标签内容\n   */\n  label: PropTypes.node,\n\n  /**\n   * 自定义弹层内容\n   */\n  children: PropTypes.node,\n  className: PropTypes.string,\n\n  /**\n   * 子菜单打开的触发行为\n   */\n  triggerType: PropTypes.oneOf(['click', 'hover']),\n  align: PropTypes.oneOf(['outside', 'follow']),\n  autoWidth: PropTypes.bool\n}, _class.defaultProps = {\n  selectable: false,\n  noIcon: false\n}, _temp);\nPopupItem.displayName = 'PopupItem';\nexport { PopupItem as default };","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/node_modules/@alifd/next/es/menu/view/popup-item.js"],"names":["_objectWithoutProperties","_extends","_classCallCheck","_possibleConstructorReturn","_inherits","_class","_temp","React","Component","findDOMNode","PropTypes","cx","Icon","Overlay","func","obj","dom","Item","SelectableItem","getChildSelected","bindCtx","setStyle","Popup","PopupItem","_Component","props","_this","call","prototype","getPopup","ref","popup","getOpen","_props","_key","root","openKeys","state","indexOf","getPopupProps","popupProps","handleOpen","open","triggerType","e","_props2","onVisibleChange","handlePopupOpen","_props3","level","align","autoWidth","_root$props","rootPopupAutoWidth","popupAutoWidth","rootPopupAlign","popupAlign","direction","itemNode","menuNode","parentNode","popupNode","getInstance","overlay","getContentNode","popupNodes","push","targetNode","offsetWidth","offsetHeight","firstElementChild","onOpen","error","handlePopupClose","index","splice","onClose","renderItem","selectable","children","others","_cx","_props4","inlineLevel","label","className","_root$props2","prefix","selectMode","NewItem","_root$state","selectedKeys","_k2n","isChildSelected","itemProps","type","createElement","renderPopup","trigger","positionProps","_this2","_props5","propCls","target","posCls","otherPostion","canCloseByEsc","visible","pinFollowBaseElementWhenFixed","render","_this3","_props6","hasSubMenu","selectableFromProps","noIcon","rtl","pickOthers","Object","keys","propTypes","_root$props3","rootTriggerType","newTriggerType","newChildren","Array","isArray","triggerIsIcon","arrowProps","_cx2","arrow","menuChildType","string","object","number","bool","node","oneOf","defaultProps","displayName","default"],"mappings":"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","sourcesContent":["import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n\nimport React, { Component } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport Icon from '../../icon';\nimport Overlay from '../../overlay';\nimport { func, obj, dom } from '../../util';\nimport Item from './item';\nimport SelectableItem from './selectable-item';\nimport { getChildSelected } from './util';\n\nvar bindCtx = func.bindCtx;\nvar setStyle = dom.setStyle;\n\nvar Popup = Overlay.Popup;\n\n/**\n * Menu.PopupItem\n * @order 2\n */\nvar PopupItem = (_temp = _class = function (_Component) {\n    _inherits(PopupItem, _Component);\n\n    function PopupItem(props) {\n        _classCallCheck(this, PopupItem);\n\n        var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n        bindCtx(_this, ['handleOpen', 'handlePopupOpen', 'handlePopupClose', 'getPopup']);\n        return _this;\n    }\n\n    PopupItem.prototype.getPopup = function getPopup(ref) {\n        this.popup = ref;\n    };\n\n    PopupItem.prototype.getOpen = function getOpen() {\n        var _props = this.props,\n            _key = _props._key,\n            root = _props.root;\n        var openKeys = root.state.openKeys;\n\n\n        return openKeys.indexOf(_key) > -1;\n    };\n\n    PopupItem.prototype.getPopupProps = function getPopupProps() {\n        var popupProps = this.props.root.props.popupProps;\n\n        if (typeof popupProps === 'function') {\n            popupProps = popupProps(this.props);\n        }\n        return popupProps;\n    };\n\n    PopupItem.prototype.handleOpen = function handleOpen(open, triggerType, e) {\n        var _props2 = this.props,\n            _key = _props2._key,\n            root = _props2.root;\n\n        root.handleOpen(_key, open, triggerType, e);\n\n        var popupProps = this.popupProps;\n        popupProps.onVisibleChange && popupProps.onVisibleChange(open, triggerType, e);\n    };\n\n    PopupItem.prototype.handlePopupOpen = function handlePopupOpen() {\n        var _props3 = this.props,\n            root = _props3.root,\n            level = _props3.level,\n            align = _props3.align,\n            autoWidth = _props3.autoWidth;\n        var _root$props = root.props,\n            rootPopupAutoWidth = _root$props.popupAutoWidth,\n            rootPopupAlign = _root$props.popupAlign,\n            direction = _root$props.direction;\n\n        var popupAlign = align || rootPopupAlign;\n        var popupAutoWidth = 'autoWidth' in this.props ? autoWidth : rootPopupAutoWidth;\n        try {\n            // avoid errors while dom removed and js executing\n            var itemNode = findDOMNode(this);\n            var menuNode = itemNode.parentNode;\n            this.popupNode = this.popup.getInstance().overlay.getInstance().getContentNode();\n            root.popupNodes.push(this.popupNode);\n\n            if (popupAutoWidth) {\n                var targetNode = direction === 'hoz' && level === 1 ? itemNode : menuNode;\n\n                if (targetNode.offsetWidth > this.popupNode.offsetWidth) {\n                    setStyle(this.popupNode, 'width', targetNode.offsetWidth + 'px');\n                }\n            }\n            if (popupAlign === 'outside' && !(direction === 'hoz' && level === 1)) {\n                setStyle(this.popupNode, 'height', menuNode.offsetHeight + 'px');\n                this.popupNode.firstElementChild && setStyle(this.popupNode.firstElementChild, 'overflow-y', 'auto');\n            }\n            // removeClass(this.popupNode, `${prefix}hide`);\n\n            var popupProps = this.popupProps;\n            popupProps.onOpen && popupProps.onOpen();\n        } catch (error) {\n            return null;\n        }\n    };\n\n    PopupItem.prototype.handlePopupClose = function handlePopupClose() {\n        var root = this.props.root;\n\n        var popupNodes = root.popupNodes;\n        var index = popupNodes.indexOf(this.popupNode);\n        index > -1 && popupNodes.splice(index, 1);\n\n        var popupProps = this.popupProps;\n        popupProps.onClose && popupProps.onClose();\n    };\n\n    PopupItem.prototype.renderItem = function renderItem(selectable, children, others) {\n        var _cx;\n\n        var _props4 = this.props,\n            _key = _props4._key,\n            root = _props4.root,\n            level = _props4.level,\n            inlineLevel = _props4.inlineLevel,\n            label = _props4.label,\n            className = _props4.className;\n        var _root$props2 = root.props,\n            prefix = _root$props2.prefix,\n            selectMode = _root$props2.selectMode;\n\n        var NewItem = selectable ? SelectableItem : Item;\n        var open = this.getOpen();\n\n        var _root$state = root.state,\n            selectedKeys = _root$state.selectedKeys,\n            _k2n = _root$state._k2n;\n\n        var isChildSelected = getChildSelected({\n            _key: _key,\n            _k2n: _k2n,\n            selectMode: selectMode,\n            selectedKeys: selectedKeys\n        });\n\n        var itemProps = {\n            'aria-haspopup': true,\n            'aria-expanded': open,\n            _key: _key,\n            root: root,\n            level: level,\n            inlineLevel: inlineLevel,\n            type: 'submenu'\n        };\n\n        itemProps.className = cx((_cx = {}, _cx[prefix + 'opened'] = open, _cx[prefix + 'child-selected'] = isChildSelected, _cx[className] = !!className, _cx));\n\n        return React.createElement(\n            NewItem,\n            _extends({}, itemProps, others),\n            React.createElement(\n                'span',\n                { className: prefix + 'menu-item-text' },\n                label\n            ),\n            children\n        );\n    };\n\n    PopupItem.prototype.renderPopup = function renderPopup(trigger, triggerType, positionProps, children) {\n        var _this2 = this;\n\n        var _props5 = this.props,\n            root = _props5.root,\n            level = _props5.level,\n            selectable = _props5.selectable,\n            propCls = _props5.className;\n        var direction = root.props.direction;\n\n        this.popupProps = this.getPopupProps();\n        var open = this.getOpen();\n\n        if (direction === 'hoz' && level === 1 && selectable) {\n            positionProps.target = function () {\n                return findDOMNode(_this2);\n            };\n        }\n\n        var posCls = positionProps.className,\n            otherPostion = _objectWithoutProperties(positionProps, ['className']);\n\n        var className = cx(propCls, posCls);\n\n        return React.createElement(\n            Popup,\n            _extends({\n                ref: this.getPopup\n            }, otherPostion, this.popupProps, {\n                canCloseByEsc: false,\n                trigger: trigger,\n                triggerType: triggerType,\n                visible: open,\n                pinFollowBaseElementWhenFixed: true,\n                onVisibleChange: this.handleOpen,\n                onOpen: this.handlePopupOpen,\n                onClose: this.handlePopupClose\n            }),\n            React.createElement(\n                'div',\n                { className: className },\n                children\n            )\n        );\n    };\n\n    PopupItem.prototype.render = function render() {\n        var _this3 = this;\n\n        var _props6 = this.props,\n            root = _props6.root,\n            level = _props6.level,\n            hasSubMenu = _props6.hasSubMenu,\n            selectableFromProps = _props6.selectable,\n            children = _props6.children,\n            triggerType = _props6.triggerType,\n            align = _props6.align,\n            noIcon = _props6.noIcon,\n            rtl = _props6.rtl;\n\n        var others = obj.pickOthers(Object.keys(PopupItem.propTypes), this.props);\n        var _root$props3 = root.props,\n            prefix = _root$props3.prefix,\n            selectMode = _root$props3.selectMode,\n            direction = _root$props3.direction,\n            rootPopupAlign = _root$props3.popupAlign,\n            rootTriggerType = _root$props3.triggerType;\n\n        var popupAlign = align || rootPopupAlign;\n        var newTriggerType = triggerType || (hasSubMenu ? rootTriggerType : 'hover');\n        var newChildren = Array.isArray(children) ? children[0] : children;\n        // let newChildren = Array.isArray(children) ? children[0] : children;\n        // newChildren = cloneElement(newChildren, {\n        //     className: cx({\n        //         [`${prefix}menu-popup-content`]: true,\n        //         [newChildren.props.className]: !!newChildren.props.className,\n        //         [`${prefix}hide`]: popupAutoWidth || popupAlign === 'outside'\n        //     })\n        // });\n        var selectable = selectMode && selectableFromProps;\n        var triggerIsIcon = selectable && newTriggerType === 'click';\n        var open = this.getOpen();\n\n        var positionProps = {};\n        var arrowProps = void 0;\n\n        if (direction === 'hoz' && level === 1) {\n            var _cx2;\n\n            positionProps.align = 'tl bl';\n            positionProps.className = prefix + 'menu-spacing-tb';\n\n            arrowProps = {\n                type: 'arrow-down',\n                className: cx((_cx2 = {}, _cx2[prefix + 'menu-hoz-icon-arrow'] = true, _cx2[prefix + 'open'] = open, _cx2))\n            };\n        } else {\n            if (popupAlign === 'outside') {\n                positionProps.target = function () {\n                    return findDOMNode(root);\n                };\n                positionProps.align = 'tl tr';\n\n                positionProps.className = prefix + 'menu-spacing-lr ' + prefix + 'menu-outside';\n            } else {\n                if (triggerIsIcon) {\n                    positionProps.target = function () {\n                        return findDOMNode(_this3);\n                    };\n                }\n                positionProps.align = 'tl tr';\n                positionProps.className = prefix + 'menu-spacing-lr';\n            }\n\n            arrowProps = {\n                type: 'arrow-right',\n                className: prefix + 'menu-icon-arrow ' + prefix + 'menu-symbol-popupfold'\n            };\n        }\n\n        var arrow = React.createElement(Icon, arrowProps);\n        var trigger = triggerIsIcon ? arrow : this.renderItem(selectable, noIcon ? null : arrow, others);\n        var popup = this.renderPopup(trigger, newTriggerType, positionProps, newChildren);\n        return triggerIsIcon ? this.renderItem(selectable, popup, others) : popup;\n    };\n\n    return PopupItem;\n}(Component), _class.menuChildType = 'submenu', _class.propTypes = {\n    _key: PropTypes.string,\n    root: PropTypes.object,\n    level: PropTypes.number,\n    hasSubMenu: PropTypes.bool,\n    noIcon: PropTypes.bool,\n    rtl: PropTypes.bool,\n    selectable: PropTypes.bool,\n    /**\n     * 标签内容\n     */\n    label: PropTypes.node,\n    /**\n     * 自定义弹层内容\n     */\n    children: PropTypes.node,\n    className: PropTypes.string,\n    /**\n     * 子菜单打开的触发行为\n     */\n    triggerType: PropTypes.oneOf(['click', 'hover']),\n    align: PropTypes.oneOf(['outside', 'follow']),\n    autoWidth: PropTypes.bool\n}, _class.defaultProps = {\n    selectable: false,\n    noIcon: false\n}, _temp);\nPopupItem.displayName = 'PopupItem';\nexport { PopupItem as default };"]},"metadata":{},"sourceType":"module"}