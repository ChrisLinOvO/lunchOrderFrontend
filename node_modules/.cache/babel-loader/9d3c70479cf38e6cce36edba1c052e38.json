{"ast":null,"code":"import _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport Icon from '../icon';\nimport Button from '../button';\nimport ConfigProvider from '../config-provider';\nimport nextLocale from '../locale/zh-cn';\n/**\n * Card.CollapseContent\n * @order 3\n */\n\nvar CardCollapseContent = (_temp = _class = function (_Component) {\n  _inherits(CardCollapseContent, _Component);\n\n  function CardCollapseContent(props, context) {\n    _classCallCheck(this, CardCollapseContent);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props, context));\n\n    _this.handleToggle = function () {\n      _this.setState(function (prevState) {\n        return {\n          expand: !prevState.expand\n        };\n      });\n    };\n\n    _this._contentRefHandler = function (ref) {\n      _this.content = ref;\n    };\n\n    _this.saveFooter = function (ref) {\n      _this.footer = ref;\n    };\n\n    _this.state = {\n      needMore: false,\n      expand: false,\n      contentHeight: 'auto'\n    };\n    return _this;\n  }\n\n  CardCollapseContent.prototype.componentDidMount = function componentDidMount() {\n    this._setNeedMore();\n\n    this._setContentHeight();\n  };\n\n  CardCollapseContent.prototype.componentDidUpdate = function componentDidUpdate() {\n    this._setContentHeight();\n  }; // 是否展示 More 按钮\n\n\n  CardCollapseContent.prototype._setNeedMore = function _setNeedMore() {\n    var contentHeight = this.props.contentHeight;\n\n    var childrenHeight = this._getNodeChildrenHeight(this.content);\n\n    this.setState({\n      needMore: contentHeight !== 'auto' && childrenHeight > contentHeight\n    });\n  }; // 设置 Body 的高度\n\n\n  CardCollapseContent.prototype._setContentHeight = function _setContentHeight() {\n    if (this.props.contentHeight === 'auto') {\n      this.content.style.height = 'auto';\n      return;\n    }\n\n    if (this.state.expand) {\n      var childrenHeight = this._getNodeChildrenHeight(this.content);\n\n      this.content.style.height = childrenHeight + 'px'; // get the real height\n    } else {\n      var el = ReactDOM.findDOMNode(this.footer);\n      var height = this.props.contentHeight;\n\n      if (el) {\n        height = height - el.getBoundingClientRect().height;\n      }\n\n      this.content.style.height = height + 'px';\n    }\n  };\n\n  CardCollapseContent.prototype._getNodeChildrenHeight = function _getNodeChildrenHeight(node) {\n    if (!node) {\n      return 0;\n    }\n\n    var contentChildNodes = node.childNodes;\n    var length = contentChildNodes.length;\n\n    if (!length) {\n      return 0;\n    }\n\n    var lastNode = contentChildNodes[length - 1];\n    return lastNode.offsetTop + lastNode.offsetHeight;\n  };\n\n  CardCollapseContent.prototype.render = function render() {\n    var _props = this.props,\n        prefix = _props.prefix,\n        children = _props.children,\n        locale = _props.locale;\n    var _state = this.state,\n        needMore = _state.needMore,\n        expand = _state.expand;\n    return React.createElement('div', {\n      className: prefix + 'card-body'\n    }, React.createElement('div', {\n      className: prefix + 'card-content',\n      ref: this._contentRefHandler\n    }, children), needMore ? React.createElement('div', {\n      className: prefix + 'card-footer',\n      ref: this.saveFooter,\n      onClick: this.handleToggle\n    }, React.createElement(Button, {\n      text: true,\n      type: 'primary'\n    }, expand ? locale.fold : locale.expand, React.createElement(Icon, {\n      type: 'arrow-down',\n      className: expand ? 'expand' : ''\n    }))) : null);\n  };\n\n  return CardCollapseContent;\n}(Component), _class.propTypes = {\n  prefix: PropTypes.string,\n\n  /**\n   * 内容区域的固定高度\n   */\n  contentHeight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  locale: PropTypes.object,\n  children: PropTypes.node\n}, _class.defaultProps = {\n  prefix: 'next-',\n  contentHeight: 120,\n  locale: nextLocale.Card\n}, _temp);\nCardCollapseContent.displayName = 'CardCollapseContent';\nexport default ConfigProvider.config(CardCollapseContent, {\n  componentName: 'Card'\n});","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/node_modules/@alifd/next/es/card/collapse-content.js"],"names":["_classCallCheck","_possibleConstructorReturn","_inherits","_class","_temp","React","Component","ReactDOM","PropTypes","Icon","Button","ConfigProvider","nextLocale","CardCollapseContent","_Component","props","context","_this","call","handleToggle","setState","prevState","expand","_contentRefHandler","ref","content","saveFooter","footer","state","needMore","contentHeight","prototype","componentDidMount","_setNeedMore","_setContentHeight","componentDidUpdate","childrenHeight","_getNodeChildrenHeight","style","height","el","findDOMNode","getBoundingClientRect","node","contentChildNodes","childNodes","length","lastNode","offsetTop","offsetHeight","render","_props","prefix","children","locale","_state","createElement","className","onClick","text","type","fold","propTypes","string","oneOfType","number","object","defaultProps","Card","displayName","config","componentName"],"mappings":"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","sourcesContent":["import _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport Icon from '../icon';\nimport Button from '../button';\nimport ConfigProvider from '../config-provider';\nimport nextLocale from '../locale/zh-cn';\n\n/**\n * Card.CollapseContent\n * @order 3\n */\nvar CardCollapseContent = (_temp = _class = function (_Component) {\n    _inherits(CardCollapseContent, _Component);\n\n    function CardCollapseContent(props, context) {\n        _classCallCheck(this, CardCollapseContent);\n\n        var _this = _possibleConstructorReturn(this, _Component.call(this, props, context));\n\n        _this.handleToggle = function () {\n            _this.setState(function (prevState) {\n                return {\n                    expand: !prevState.expand\n                };\n            });\n        };\n\n        _this._contentRefHandler = function (ref) {\n            _this.content = ref;\n        };\n\n        _this.saveFooter = function (ref) {\n            _this.footer = ref;\n        };\n\n        _this.state = {\n            needMore: false,\n            expand: false,\n            contentHeight: 'auto'\n        };\n        return _this;\n    }\n\n    CardCollapseContent.prototype.componentDidMount = function componentDidMount() {\n        this._setNeedMore();\n        this._setContentHeight();\n    };\n\n    CardCollapseContent.prototype.componentDidUpdate = function componentDidUpdate() {\n        this._setContentHeight();\n    };\n\n    // 是否展示 More 按钮\n    CardCollapseContent.prototype._setNeedMore = function _setNeedMore() {\n        var contentHeight = this.props.contentHeight;\n\n        var childrenHeight = this._getNodeChildrenHeight(this.content);\n        this.setState({\n            needMore: contentHeight !== 'auto' && childrenHeight > contentHeight\n        });\n    };\n\n    // 设置 Body 的高度\n\n\n    CardCollapseContent.prototype._setContentHeight = function _setContentHeight() {\n        if (this.props.contentHeight === 'auto') {\n            this.content.style.height = 'auto';\n            return;\n        }\n\n        if (this.state.expand) {\n            var childrenHeight = this._getNodeChildrenHeight(this.content);\n            this.content.style.height = childrenHeight + 'px'; // get the real height\n        } else {\n            var el = ReactDOM.findDOMNode(this.footer);\n            var height = this.props.contentHeight;\n\n            if (el) {\n                height = height - el.getBoundingClientRect().height;\n            }\n\n            this.content.style.height = height + 'px';\n        }\n    };\n\n    CardCollapseContent.prototype._getNodeChildrenHeight = function _getNodeChildrenHeight(node) {\n        if (!node) {\n            return 0;\n        }\n\n        var contentChildNodes = node.childNodes;\n        var length = contentChildNodes.length;\n\n        if (!length) {\n            return 0;\n        }\n\n        var lastNode = contentChildNodes[length - 1];\n\n        return lastNode.offsetTop + lastNode.offsetHeight;\n    };\n\n    CardCollapseContent.prototype.render = function render() {\n        var _props = this.props,\n            prefix = _props.prefix,\n            children = _props.children,\n            locale = _props.locale;\n        var _state = this.state,\n            needMore = _state.needMore,\n            expand = _state.expand;\n\n\n        return React.createElement(\n            'div',\n            { className: prefix + 'card-body' },\n            React.createElement(\n                'div',\n                { className: prefix + 'card-content', ref: this._contentRefHandler },\n                children\n            ),\n            needMore ? React.createElement(\n                'div',\n                { className: prefix + 'card-footer', ref: this.saveFooter, onClick: this.handleToggle },\n                React.createElement(\n                    Button,\n                    { text: true, type: 'primary' },\n                    expand ? locale.fold : locale.expand,\n                    React.createElement(Icon, { type: 'arrow-down', className: expand ? 'expand' : '' })\n                )\n            ) : null\n        );\n    };\n\n    return CardCollapseContent;\n}(Component), _class.propTypes = {\n    prefix: PropTypes.string,\n    /**\n     * 内容区域的固定高度\n     */\n    contentHeight: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    locale: PropTypes.object,\n    children: PropTypes.node\n}, _class.defaultProps = {\n    prefix: 'next-',\n    contentHeight: 120,\n    locale: nextLocale.Card\n}, _temp);\nCardCollapseContent.displayName = 'CardCollapseContent';\n\n\nexport default ConfigProvider.config(CardCollapseContent, {\n    componentName: 'Card'\n});"]},"metadata":{},"sourceType":"module"}