{"ast":null,"code":"import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React, { Children } from 'react';\nimport PropTypes from 'prop-types';\nimport { polyfill } from 'react-lifecycles-compat';\nimport Checkbox from '../checkbox';\nimport Radio from '../radio';\nimport { func, log } from '../util';\nimport zhCN from '../locale/zh-cn';\nimport SelectionRow from './selection/row';\nimport Col from './column';\nimport { statics } from './util';\nvar makeChain = func.makeChain;\n\nvar unique = function unique(arr) {\n  var key = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'this';\n  var temp = {},\n      ret = [];\n  arr.forEach(function (item) {\n    var value = void 0;\n\n    if (key === 'this') {\n      value = item;\n    } else {\n      value = item[key];\n    }\n\n    if (!temp[value]) {\n      ret.push(item);\n      temp[value] = true;\n    }\n  });\n  return ret;\n};\n\nexport default function selection(BaseComponent) {\n  var _class, _temp;\n  /** Table */\n\n\n  var SelectionTable = (_temp = _class = function (_React$Component) {\n    _inherits(SelectionTable, _React$Component);\n\n    function SelectionTable(props, context) {\n      _classCallCheck(this, SelectionTable);\n\n      var _this = _possibleConstructorReturn(this, _React$Component.call(this, props, context));\n\n      _this.addSelection = function (columns) {\n        var _this$props = _this.props,\n            prefix = _this$props.prefix,\n            rowSelection = _this$props.rowSelection,\n            size = _this$props.size;\n        var attrs = rowSelection.columnProps && rowSelection.columnProps() || {};\n\n        if (!columns.find(function (record) {\n          return record.key === 'selection';\n        })) {\n          columns.unshift(_extends({\n            key: 'selection',\n            title: _this.renderSelectionHeader.bind(_this),\n            cell: _this.renderSelectionBody.bind(_this),\n            width: size === 'small' ? 34 : 50,\n            className: prefix + 'table-selection ' + prefix + 'table-prerow',\n            __normalized: true\n          }, attrs));\n        }\n      };\n\n      _this.renderSelectionHeader = function () {\n        var onChange = _this.selectAllRow,\n            attrs = {},\n            _this$props2 = _this.props,\n            rowSelection = _this$props2.rowSelection,\n            primaryKey = _this$props2.primaryKey,\n            dataSource = _this$props2.dataSource,\n            entireDataSource = _this$props2.entireDataSource,\n            locale = _this$props2.locale,\n            selectedRowKeys = _this.state.selectedRowKeys,\n            mode = rowSelection.mode ? rowSelection.mode : 'multiple';\n        var checked = !!selectedRowKeys.length;\n        var indeterminate = false;\n        var source = entireDataSource || dataSource;\n\n        _this.flatDataSource(source).filter(function (record, index) {\n          if (!rowSelection.getProps) {\n            return true;\n          } else {\n            return !(rowSelection.getProps(record, index) || {}).disabled;\n          }\n        }).map(function (record) {\n          return record[primaryKey];\n        }).forEach(function (id) {\n          if (selectedRowKeys.indexOf(id) === -1) {\n            checked = false;\n          } else {\n            indeterminate = true;\n          }\n        });\n\n        attrs.onClick = makeChain(function (e) {\n          e.stopPropagation();\n        }, attrs.onClick);\n        var userAttrs = rowSelection.titleProps && rowSelection.titleProps() || {};\n\n        if (checked) {\n          indeterminate = false;\n        }\n\n        return [mode === 'multiple' ? React.createElement(Checkbox, _extends({\n          key: '_total',\n          indeterminate: indeterminate,\n          'aria-label': locale.selectAll,\n          checked: checked,\n          onChange: onChange\n        }, attrs, userAttrs)) : null, rowSelection.titleAddons && rowSelection.titleAddons()];\n      };\n\n      _this.renderSelectionBody = function (value, index, record) {\n        var _this$props3 = _this.props,\n            rowSelection = _this$props3.rowSelection,\n            primaryKey = _this$props3.primaryKey;\n        var selectedRowKeys = _this.state.selectedRowKeys;\n        var mode = rowSelection.mode ? rowSelection.mode : 'multiple';\n        var checked = selectedRowKeys.indexOf(record[primaryKey]) > -1;\n\n        var onChange = _this.selectOneRow.bind(_this, index, record);\n\n        var attrs = rowSelection.getProps ? rowSelection.getProps(record, index) || {} : {};\n        attrs.onClick = makeChain(function (e) {\n          e.stopPropagation();\n        }, attrs.onClick);\n        return mode === 'multiple' ? React.createElement(Checkbox, _extends({\n          checked: checked,\n          onChange: onChange\n        }, attrs)) : React.createElement(Radio, _extends({\n          checked: checked,\n          onChange: onChange\n        }, attrs));\n      };\n\n      _this.selectAllRow = function (checked, e) {\n        var ret = [].concat(_this.state.selectedRowKeys),\n            _this$props4 = _this.props,\n            rowSelection = _this$props4.rowSelection,\n            primaryKey = _this$props4.primaryKey,\n            dataSource = _this$props4.dataSource,\n            entireDataSource = _this$props4.entireDataSource,\n            selectedRowKeys = _this.state.selectedRowKeys,\n            getProps = rowSelection.getProps;\n        var attrs = {},\n            records = [];\n        var source = entireDataSource ? entireDataSource : dataSource;\n\n        _this.flatDataSource(source).forEach(function (record, index) {\n          var id = record[primaryKey];\n\n          if (getProps) {\n            attrs = getProps(record, index) || {};\n          } // 反选和全选的时候不要丢弃禁用项的选中状态\n\n\n          if (checked && (!attrs.disabled || selectedRowKeys.indexOf(id) > -1)) {\n            ret.push(id);\n            records.push(record);\n          } else if (attrs.disabled && selectedRowKeys.indexOf(id) > -1) {\n            ret.push(id);\n            records.push(record);\n          } else {\n            var i = ret.indexOf(id);\n            i > -1 && ret.splice(i, 1);\n          }\n        });\n\n        records = unique(records, primaryKey);\n\n        if (typeof rowSelection.onSelectAll === 'function') {\n          rowSelection.onSelectAll(checked, records);\n        }\n\n        _this.triggerSelection(rowSelection, unique(ret), records);\n\n        e.stopPropagation();\n      };\n\n      _this.state = {\n        selectedRowKeys: props.rowSelection && 'selectedRowKeys' in props.rowSelection ? props.rowSelection.selectedRowKeys || [] : []\n      };\n      return _this;\n    }\n\n    SelectionTable.prototype.getChildContext = function getChildContext() {\n      return {\n        rowSelection: this.props.rowSelection,\n        selectedRowKeys: this.state.selectedRowKeys\n      };\n    };\n\n    SelectionTable.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps) {\n      if (nextProps.rowSelection && 'selectedRowKeys' in nextProps.rowSelection) {\n        var selectedRowKeys = nextProps.rowSelection.selectedRowKeys || [];\n        return {\n          selectedRowKeys: selectedRowKeys\n        };\n      }\n\n      return null;\n    };\n\n    SelectionTable.prototype.normalizeChildren = function normalizeChildren(children) {\n      var _props = this.props,\n          prefix = _props.prefix,\n          rowSelection = _props.rowSelection,\n          size = _props.size;\n\n      if (rowSelection) {\n        children = Children.map(children, function (child, index) {\n          return React.cloneElement(child, {\n            key: index\n          });\n        });\n        var attrs = rowSelection.columnProps && rowSelection.columnProps() || {};\n        children.unshift(React.createElement(Col, _extends({\n          key: 'selection',\n          title: this.renderSelectionHeader.bind(this),\n          cell: this.renderSelectionBody.bind(this),\n          width: size === 'small' ? 34 : 50,\n          className: prefix + 'table-selection ' + prefix + 'table-prerow',\n          __normalized: true\n        }, attrs)));\n        return children;\n      }\n\n      return children;\n    };\n\n    SelectionTable.prototype.selectOneRow = function selectOneRow(index, record, checked, e) {\n      var selectedRowKeys = [].concat(this.state.selectedRowKeys),\n          i = void 0;\n      var _props2 = this.props,\n          primaryKey = _props2.primaryKey,\n          rowSelection = _props2.rowSelection,\n          dataSource = _props2.dataSource,\n          mode = rowSelection.mode ? rowSelection.mode : 'multiple',\n          id = record[primaryKey];\n\n      if (!id) {\n        log.warning('Can\\'t get value from record using given ' + primaryKey + ' as primaryKey.');\n      }\n\n      if (mode === 'multiple') {\n        if (checked) {\n          selectedRowKeys.push(id);\n        } else {\n          i = selectedRowKeys.indexOf(id);\n          selectedRowKeys.splice(i, 1);\n        }\n      } else if (checked) {\n        selectedRowKeys = [id];\n      }\n\n      var records = unique(dataSource.filter(function (item) {\n        return selectedRowKeys.indexOf(item[primaryKey]) > -1;\n      }), primaryKey);\n\n      if (typeof rowSelection.onSelect === 'function') {\n        rowSelection.onSelect(checked, record, records);\n      }\n\n      this.triggerSelection(rowSelection, selectedRowKeys, records);\n      e.stopPropagation();\n    };\n\n    SelectionTable.prototype.triggerSelection = function triggerSelection(rowSelection, selectedRowKeys, records) {\n      if (!('selectedRowKeys' in rowSelection)) {\n        this.setState({\n          selectedRowKeys: selectedRowKeys\n        });\n      }\n\n      if (typeof rowSelection.onChange === 'function') {\n        rowSelection.onChange(selectedRowKeys, records);\n      }\n    };\n\n    SelectionTable.prototype.flatDataSource = function flatDataSource(dataSource) {\n      var ret = dataSource;\n      var listHeader = this.context.listHeader;\n\n      if (listHeader) {\n        ret = [];\n        var hasChildrenSelection = listHeader.hasChildrenSelection,\n            hasSelection = listHeader.hasSelection;\n        dataSource.forEach(function (item) {\n          var children = item.children; // 如果需要渲染selection才将这条记录插入到dataSource\n          // 或者没有孩子节点\n\n          if (hasSelection) {\n            ret.push(item);\n          }\n\n          if (children && hasChildrenSelection) {\n            ret = ret.concat(children);\n          }\n        });\n      }\n\n      return ret;\n    };\n\n    SelectionTable.prototype.render = function render() {\n      /* eslint-disable prefer-const */\n      var _props3 = this.props,\n          rowSelection = _props3.rowSelection,\n          components = _props3.components,\n          children = _props3.children,\n          columns = _props3.columns,\n          others = _objectWithoutProperties(_props3, ['rowSelection', 'components', 'children', 'columns']);\n\n      var useColumns = columns && !children;\n\n      if (rowSelection) {\n        if (useColumns) {\n          this.addSelection(columns);\n        } else {\n          children = this.normalizeChildren(children || []);\n        }\n\n        components = _extends({}, components);\n        components.Row = components.Row || SelectionRow;\n      }\n\n      return React.createElement(BaseComponent, _extends({}, others, {\n        columns: columns,\n        components: components,\n        children: children\n      }));\n    };\n\n    return SelectionTable;\n  }(React.Component), _class.SelectionRow = SelectionRow, _class.propTypes = _extends({\n    /**\n     * 是否启用选择模式\n     * @property {Function} getProps `Function(record, index)=>Object` 获取selection的默认属性\n     * @property {Function} onChange `Function(selectedRowKeys:Array, records:Array)` 选择改变的时候触发的事件，**注意:** 其中records只会包含当前dataSource的数据，很可能会小于selectedRowKeys的长度。\n     * @property {Function} onSelect `Function(selected:Boolean, record:Object, records:Array)` 用户手动选择/取消选择某行的回调\n     * @property {Function} onSelectAll `Function(selected:Boolean, records:Array)` 用户手动选择/取消选择所有行的回调\n     * @property {Array} selectedRowKeys 设置了此属性,将rowSelection变为受控状态,接收值为该行数据的primaryKey的值\n     * @property {String} mode 选择selection的模式, 可选值为`single`, `multiple`，默认为`multiple`\n     * @property {Function} columnProps `Function()=>Object` 选择列 的props，例如锁列、对齐等，可使用`Table.Column` 的所有参数\n     * @property {Function} titleProps `Function()=>Object` 选择列 表头的props，仅在 `multiple` 模式下生效\n     */\n    rowSelection: PropTypes.object,\n    primaryKey: PropTypes.oneOfType([PropTypes.symbol, PropTypes.string]),\n    dataSource: PropTypes.array,\n    entireDataSource: PropTypes.array\n  }, BaseComponent.propTypes), _class.defaultProps = _extends({}, BaseComponent.defaultProps, {\n    locale: zhCN.Table,\n    primaryKey: 'id',\n    prefix: 'next-'\n  }), _class.contextTypes = {\n    listHeader: PropTypes.any\n  }, _class.childContextTypes = {\n    rowSelection: PropTypes.object,\n    selectedRowKeys: PropTypes.array\n  }, _temp);\n  SelectionTable.displayName = 'SelectionTable';\n  statics(SelectionTable, BaseComponent);\n  return polyfill(SelectionTable);\n}","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/node_modules/@alifd/next/es/table/selection.js"],"names":["_objectWithoutProperties","_extends","_classCallCheck","_possibleConstructorReturn","_inherits","React","Children","PropTypes","polyfill","Checkbox","Radio","func","log","zhCN","SelectionRow","Col","statics","makeChain","unique","arr","key","arguments","length","undefined","temp","ret","forEach","item","value","push","selection","BaseComponent","_class","_temp","SelectionTable","_React$Component","props","context","_this","call","addSelection","columns","_this$props","prefix","rowSelection","size","attrs","columnProps","find","record","unshift","title","renderSelectionHeader","bind","cell","renderSelectionBody","width","className","__normalized","onChange","selectAllRow","_this$props2","primaryKey","dataSource","entireDataSource","locale","selectedRowKeys","state","mode","checked","indeterminate","source","flatDataSource","filter","index","getProps","disabled","map","id","indexOf","onClick","e","stopPropagation","userAttrs","titleProps","createElement","selectAll","titleAddons","_this$props3","selectOneRow","concat","_this$props4","records","i","splice","onSelectAll","triggerSelection","prototype","getChildContext","getDerivedStateFromProps","nextProps","normalizeChildren","children","_props","child","cloneElement","_props2","warning","onSelect","setState","listHeader","hasChildrenSelection","hasSelection","render","_props3","components","others","useColumns","Row","Component","propTypes","object","oneOfType","symbol","string","array","defaultProps","Table","contextTypes","any","childContextTypes","displayName"],"mappings":"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","sourcesContent":["import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React, { Children } from 'react';\nimport PropTypes from 'prop-types';\nimport { polyfill } from 'react-lifecycles-compat';\nimport Checkbox from '../checkbox';\nimport Radio from '../radio';\nimport { func, log } from '../util';\nimport zhCN from '../locale/zh-cn';\nimport SelectionRow from './selection/row';\nimport Col from './column';\nimport { statics } from './util';\n\nvar makeChain = func.makeChain;\n\n\nvar unique = function unique(arr) {\n    var key = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'this';\n\n    var temp = {},\n        ret = [];\n    arr.forEach(function (item) {\n        var value = void 0;\n        if (key === 'this') {\n            value = item;\n        } else {\n            value = item[key];\n        }\n        if (!temp[value]) {\n            ret.push(item);\n            temp[value] = true;\n        }\n    });\n    return ret;\n};\n\nexport default function selection(BaseComponent) {\n    var _class, _temp;\n\n    /** Table */\n    var SelectionTable = (_temp = _class = function (_React$Component) {\n        _inherits(SelectionTable, _React$Component);\n\n        function SelectionTable(props, context) {\n            _classCallCheck(this, SelectionTable);\n\n            var _this = _possibleConstructorReturn(this, _React$Component.call(this, props, context));\n\n            _this.addSelection = function (columns) {\n                var _this$props = _this.props,\n                    prefix = _this$props.prefix,\n                    rowSelection = _this$props.rowSelection,\n                    size = _this$props.size;\n\n                var attrs = rowSelection.columnProps && rowSelection.columnProps() || {};\n\n                if (!columns.find(function (record) {\n                    return record.key === 'selection';\n                })) {\n                    columns.unshift(_extends({\n                        key: 'selection',\n                        title: _this.renderSelectionHeader.bind(_this),\n                        cell: _this.renderSelectionBody.bind(_this),\n                        width: size === 'small' ? 34 : 50,\n                        className: prefix + 'table-selection ' + prefix + 'table-prerow',\n                        __normalized: true\n                    }, attrs));\n                }\n            };\n\n            _this.renderSelectionHeader = function () {\n                var onChange = _this.selectAllRow,\n                    attrs = {},\n                    _this$props2 = _this.props,\n                    rowSelection = _this$props2.rowSelection,\n                    primaryKey = _this$props2.primaryKey,\n                    dataSource = _this$props2.dataSource,\n                    entireDataSource = _this$props2.entireDataSource,\n                    locale = _this$props2.locale,\n                    selectedRowKeys = _this.state.selectedRowKeys,\n                    mode = rowSelection.mode ? rowSelection.mode : 'multiple';\n\n\n                var checked = !!selectedRowKeys.length;\n                var indeterminate = false;\n\n                var source = entireDataSource || dataSource;\n\n                _this.flatDataSource(source).filter(function (record, index) {\n                    if (!rowSelection.getProps) {\n                        return true;\n                    } else {\n                        return !(rowSelection.getProps(record, index) || {}).disabled;\n                    }\n                }).map(function (record) {\n                    return record[primaryKey];\n                }).forEach(function (id) {\n                    if (selectedRowKeys.indexOf(id) === -1) {\n                        checked = false;\n                    } else {\n                        indeterminate = true;\n                    }\n                });\n                attrs.onClick = makeChain(function (e) {\n                    e.stopPropagation();\n                }, attrs.onClick);\n\n                var userAttrs = rowSelection.titleProps && rowSelection.titleProps() || {};\n\n                if (checked) {\n                    indeterminate = false;\n                }\n                return [mode === 'multiple' ? React.createElement(Checkbox, _extends({\n                    key: '_total',\n                    indeterminate: indeterminate,\n                    'aria-label': locale.selectAll,\n                    checked: checked,\n                    onChange: onChange\n                }, attrs, userAttrs)) : null, rowSelection.titleAddons && rowSelection.titleAddons()];\n            };\n\n            _this.renderSelectionBody = function (value, index, record) {\n                var _this$props3 = _this.props,\n                    rowSelection = _this$props3.rowSelection,\n                    primaryKey = _this$props3.primaryKey;\n                var selectedRowKeys = _this.state.selectedRowKeys;\n\n                var mode = rowSelection.mode ? rowSelection.mode : 'multiple';\n                var checked = selectedRowKeys.indexOf(record[primaryKey]) > -1;\n                var onChange = _this.selectOneRow.bind(_this, index, record);\n                var attrs = rowSelection.getProps ? rowSelection.getProps(record, index) || {} : {};\n\n                attrs.onClick = makeChain(function (e) {\n                    e.stopPropagation();\n                }, attrs.onClick);\n                return mode === 'multiple' ? React.createElement(Checkbox, _extends({ checked: checked, onChange: onChange }, attrs)) : React.createElement(Radio, _extends({ checked: checked, onChange: onChange }, attrs));\n            };\n\n            _this.selectAllRow = function (checked, e) {\n                var ret = [].concat(_this.state.selectedRowKeys),\n                    _this$props4 = _this.props,\n                    rowSelection = _this$props4.rowSelection,\n                    primaryKey = _this$props4.primaryKey,\n                    dataSource = _this$props4.dataSource,\n                    entireDataSource = _this$props4.entireDataSource,\n                    selectedRowKeys = _this.state.selectedRowKeys,\n                    getProps = rowSelection.getProps;\n\n                var attrs = {},\n                    records = [];\n\n                var source = entireDataSource ? entireDataSource : dataSource;\n\n                _this.flatDataSource(source).forEach(function (record, index) {\n                    var id = record[primaryKey];\n                    if (getProps) {\n                        attrs = getProps(record, index) || {};\n                    }\n                    // 反选和全选的时候不要丢弃禁用项的选中状态\n                    if (checked && (!attrs.disabled || selectedRowKeys.indexOf(id) > -1)) {\n                        ret.push(id);\n                        records.push(record);\n                    } else if (attrs.disabled && selectedRowKeys.indexOf(id) > -1) {\n                        ret.push(id);\n                        records.push(record);\n                    } else {\n                        var i = ret.indexOf(id);\n                        i > -1 && ret.splice(i, 1);\n                    }\n                });\n\n                records = unique(records, primaryKey);\n                if (typeof rowSelection.onSelectAll === 'function') {\n                    rowSelection.onSelectAll(checked, records);\n                }\n                _this.triggerSelection(rowSelection, unique(ret), records);\n                e.stopPropagation();\n            };\n\n            _this.state = {\n                selectedRowKeys: props.rowSelection && 'selectedRowKeys' in props.rowSelection ? props.rowSelection.selectedRowKeys || [] : []\n            };\n            return _this;\n        }\n\n        SelectionTable.prototype.getChildContext = function getChildContext() {\n            return {\n                rowSelection: this.props.rowSelection,\n                selectedRowKeys: this.state.selectedRowKeys\n            };\n        };\n\n        SelectionTable.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps) {\n            if (nextProps.rowSelection && 'selectedRowKeys' in nextProps.rowSelection) {\n                var selectedRowKeys = nextProps.rowSelection.selectedRowKeys || [];\n                return {\n                    selectedRowKeys: selectedRowKeys\n                };\n            }\n\n            return null;\n        };\n\n        SelectionTable.prototype.normalizeChildren = function normalizeChildren(children) {\n            var _props = this.props,\n                prefix = _props.prefix,\n                rowSelection = _props.rowSelection,\n                size = _props.size;\n\n            if (rowSelection) {\n                children = Children.map(children, function (child, index) {\n                    return React.cloneElement(child, {\n                        key: index\n                    });\n                });\n\n                var attrs = rowSelection.columnProps && rowSelection.columnProps() || {};\n\n                children.unshift(React.createElement(Col, _extends({\n                    key: 'selection',\n                    title: this.renderSelectionHeader.bind(this),\n                    cell: this.renderSelectionBody.bind(this),\n                    width: size === 'small' ? 34 : 50,\n                    className: prefix + 'table-selection ' + prefix + 'table-prerow',\n                    __normalized: true\n                }, attrs)));\n                return children;\n            }\n            return children;\n        };\n\n        SelectionTable.prototype.selectOneRow = function selectOneRow(index, record, checked, e) {\n            var selectedRowKeys = [].concat(this.state.selectedRowKeys),\n                i = void 0;\n            var _props2 = this.props,\n                primaryKey = _props2.primaryKey,\n                rowSelection = _props2.rowSelection,\n                dataSource = _props2.dataSource,\n                mode = rowSelection.mode ? rowSelection.mode : 'multiple',\n                id = record[primaryKey];\n\n            if (!id) {\n                log.warning('Can\\'t get value from record using given ' + primaryKey + ' as primaryKey.');\n            }\n            if (mode === 'multiple') {\n                if (checked) {\n                    selectedRowKeys.push(id);\n                } else {\n                    i = selectedRowKeys.indexOf(id);\n                    selectedRowKeys.splice(i, 1);\n                }\n            } else if (checked) {\n                selectedRowKeys = [id];\n            }\n            var records = unique(dataSource.filter(function (item) {\n                return selectedRowKeys.indexOf(item[primaryKey]) > -1;\n            }), primaryKey);\n            if (typeof rowSelection.onSelect === 'function') {\n                rowSelection.onSelect(checked, record, records);\n            }\n\n            this.triggerSelection(rowSelection, selectedRowKeys, records);\n\n            e.stopPropagation();\n        };\n\n        SelectionTable.prototype.triggerSelection = function triggerSelection(rowSelection, selectedRowKeys, records) {\n            if (!('selectedRowKeys' in rowSelection)) {\n                this.setState({\n                    selectedRowKeys: selectedRowKeys\n                });\n            }\n            if (typeof rowSelection.onChange === 'function') {\n                rowSelection.onChange(selectedRowKeys, records);\n            }\n        };\n\n        SelectionTable.prototype.flatDataSource = function flatDataSource(dataSource) {\n            var ret = dataSource;\n            var listHeader = this.context.listHeader;\n\n\n            if (listHeader) {\n                ret = [];\n                var hasChildrenSelection = listHeader.hasChildrenSelection,\n                    hasSelection = listHeader.hasSelection;\n\n                dataSource.forEach(function (item) {\n                    var children = item.children;\n                    // 如果需要渲染selection才将这条记录插入到dataSource\n                    // 或者没有孩子节点\n                    if (hasSelection) {\n                        ret.push(item);\n                    }\n                    if (children && hasChildrenSelection) {\n                        ret = ret.concat(children);\n                    }\n                });\n            }\n            return ret;\n        };\n\n        SelectionTable.prototype.render = function render() {\n            /* eslint-disable prefer-const */\n            var _props3 = this.props,\n                rowSelection = _props3.rowSelection,\n                components = _props3.components,\n                children = _props3.children,\n                columns = _props3.columns,\n                others = _objectWithoutProperties(_props3, ['rowSelection', 'components', 'children', 'columns']);\n\n            var useColumns = columns && !children;\n\n            if (rowSelection) {\n                if (useColumns) {\n                    this.addSelection(columns);\n                } else {\n                    children = this.normalizeChildren(children || []);\n                }\n                components = _extends({}, components);\n                components.Row = components.Row || SelectionRow;\n            }\n            return React.createElement(BaseComponent, _extends({}, others, { columns: columns, components: components, children: children }));\n        };\n\n        return SelectionTable;\n    }(React.Component), _class.SelectionRow = SelectionRow, _class.propTypes = _extends({\n        /**\n         * 是否启用选择模式\n         * @property {Function} getProps `Function(record, index)=>Object` 获取selection的默认属性\n         * @property {Function} onChange `Function(selectedRowKeys:Array, records:Array)` 选择改变的时候触发的事件，**注意:** 其中records只会包含当前dataSource的数据，很可能会小于selectedRowKeys的长度。\n         * @property {Function} onSelect `Function(selected:Boolean, record:Object, records:Array)` 用户手动选择/取消选择某行的回调\n         * @property {Function} onSelectAll `Function(selected:Boolean, records:Array)` 用户手动选择/取消选择所有行的回调\n         * @property {Array} selectedRowKeys 设置了此属性,将rowSelection变为受控状态,接收值为该行数据的primaryKey的值\n         * @property {String} mode 选择selection的模式, 可选值为`single`, `multiple`，默认为`multiple`\n         * @property {Function} columnProps `Function()=>Object` 选择列 的props，例如锁列、对齐等，可使用`Table.Column` 的所有参数\n         * @property {Function} titleProps `Function()=>Object` 选择列 表头的props，仅在 `multiple` 模式下生效\n         */\n        rowSelection: PropTypes.object,\n        primaryKey: PropTypes.oneOfType([PropTypes.symbol, PropTypes.string]),\n        dataSource: PropTypes.array,\n        entireDataSource: PropTypes.array\n    }, BaseComponent.propTypes), _class.defaultProps = _extends({}, BaseComponent.defaultProps, {\n        locale: zhCN.Table,\n        primaryKey: 'id',\n        prefix: 'next-'\n    }), _class.contextTypes = {\n        listHeader: PropTypes.any\n    }, _class.childContextTypes = {\n        rowSelection: PropTypes.object,\n        selectedRowKeys: PropTypes.array\n    }, _temp);\n    SelectionTable.displayName = 'SelectionTable';\n\n    statics(SelectionTable, BaseComponent);\n    return polyfill(SelectionTable);\n}"]},"metadata":{},"sourceType":"module"}