{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { func, obj, KEYCODE } from '../util';\nimport Input from '../input';\nimport Base from './base';\nvar bindCtx = func.bindCtx,\n    noop = func.noop;\n/**\n * Select.AutoComplete\n */\n\nvar AutoComplete = (_temp = _class = function (_Base) {\n  _inherits(AutoComplete, _Base);\n\n  function AutoComplete(props) {\n    _classCallCheck(this, AutoComplete);\n\n    var _this = _possibleConstructorReturn(this, _Base.call(this, props));\n\n    _this.handleChange = function (value, proxy, item) {\n      var _this$props = _this.props,\n          disabled = _this$props.disabled,\n          readOnly = _this$props.readOnly,\n          filterLocal = _this$props.filterLocal;\n\n      if (disabled || readOnly) {\n        return false;\n      }\n\n      var actionType = typeof proxy === 'string' ? proxy : 'change';\n      _this.isInputing = actionType === 'change';\n\n      if (filterLocal) {\n        _this.setState({\n          dataSource: _this.dataStore.updateByKey(value)\n        });\n\n        _this.shouldControlPopup(_this.props, actionType);\n\n        _this.setFirstHightLightKeyForMenu();\n      } // 非受控模式清空内部数据\n\n\n      if (!('value' in _this.props)) {\n        _this.setState({\n          value: value\n        });\n      } // 不自动高亮的情况下, highlightKey 根据value精确值走，也就是被选中元素自动高亮，这样也不会影响不在选项内的用户搜索操作\n\n\n      if (!_this.props.autoHighlightFirstItem) {\n        _this.setState({\n          highlightKey: value\n        });\n      }\n\n      _this.props.onChange(value, actionType, item);\n\n      if (actionType === 'itemClick' || actionType === 'enter') {\n        // 点击 item 的时候不会触发关闭，需要手动关闭，其它类型比如 keyDown 等都会有其它事件句柄处理\n        _this.setVisible(false, actionType);\n      }\n    };\n\n    _this.isAutoComplete = true;\n    _this.isInputing = false;\n\n    _this.dataStore.setOptions({\n      key: _this.state.value\n    });\n\n    _extends(_this.state, {\n      dataSource: _this.setDataSource(props)\n    });\n\n    bindCtx(_this, ['handleTriggerKeyDown', 'handleMenuSelect', 'handleItemClick']);\n    return _this;\n  }\n\n  AutoComplete.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var state = {};\n\n    if ('value' in nextProps && nextProps.value !== prevState.value) {\n      _extends(state, {\n        value: nextProps.value\n      });\n    }\n\n    if ('visible' in nextProps && nextProps.visible !== prevState.visible) {\n      _extends(state, {\n        visible: nextProps.visible\n      });\n    }\n\n    if (Object.keys(state).length) {\n      return state;\n    }\n\n    return null;\n  };\n\n  AutoComplete.prototype.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n    var props = this.props;\n\n    if ('value' in props) {\n      this.dataStore.setOptions({\n        key: props.value\n      });\n    }\n\n    if (props.filter !== prevProps.filter) {\n      this.dataStore.setOptions({\n        filter: props.filter\n      });\n    }\n\n    if (props.filterLocal !== prevProps.filterLocal) {\n      this.dataStore.setOptions({\n        filterLocal: props.filterLocal\n      });\n    }\n\n    if (prevProps.children !== props.children || prevProps.dataSource !== props.dataSource) {\n      /* eslint-disable react/no-did-update-set-state */\n      this.setState({\n        dataSource: this.setDataSource(props)\n      }); // remote dataSource and focused\n      // 因为autoComplete没有下拉数据不展示，搜索并且有数据了需要自动展示下拉\n\n      if (!props.filterLocal && this.isInputing) {\n        this.shouldControlPopup(props, 'update');\n      }\n\n      if (!props.filterLocal && !props.popupContent) {\n        this.setFirstHightLightKeyForMenu();\n      }\n    }\n  };\n\n  AutoComplete.prototype.shouldControlPopup = function shouldControlPopup() {\n    var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n    var type = arguments[1];\n    var hasPopup = props.popupContent || this.dataStore.getMenuDS().length;\n\n    if (hasPopup) {\n      this.setVisible(true, type);\n    } else {\n      this.setVisible(false, type);\n    }\n  };\n\n  AutoComplete.prototype.handleMenuSelect = function handleMenuSelect(keys) {\n    var key = keys[0];\n    var mapDS = this.dataStore.getMapDS();\n\n    if (key in mapDS) {\n      var item = mapDS[key];\n      this.handleSelectEvent(key, item, 'itemClick');\n    }\n  };\n\n  AutoComplete.prototype.handleItemClick = function handleItemClick() {\n    this.setVisible(false, 'itemClick');\n  };\n\n  AutoComplete.prototype.handleSelectEvent = function handleSelectEvent(key, item, triggerType) {\n    var value = item && item[this.props.fillProps] || key;\n\n    if (triggerType === 'itemClick' || triggerType === 'enter') {\n      // 点击 item 的时候不会触发关闭，需要手动关闭，其它类型比如 keyDown 等都会有其它事件句柄处理\n      this.setVisible(false, triggerType);\n    }\n\n    this.handleChange(value, triggerType, item);\n  };\n\n  AutoComplete.prototype.handleVisibleChange = function handleVisibleChange(visible, type) {\n    if (!('visible' in this.props) && visible && !this.props.popupContent && !this.dataStore.getMenuDS().length) {\n      return;\n    }\n\n    this.setVisible(visible, type);\n  };\n\n  AutoComplete.prototype.beforeClose = function beforeClose() {\n    this.isInputing = false;\n  };\n  /**\n   * Handle trigger keydown event\n   * @param {Event} e\n   */\n\n\n  AutoComplete.prototype.handleTriggerKeyDown = function handleTriggerKeyDown(e) {\n    var _props = this.props,\n        popupContent = _props.popupContent,\n        onToggleHighlightItem = _props.onToggleHighlightItem,\n        onKeyDown = _props.onKeyDown;\n\n    if (popupContent) {\n      e.stopPropagation(); //stopPropagation can make use onChange triggerd while typing space('') in Input\n\n      return onKeyDown(e);\n    }\n\n    switch (e.keyCode) {\n      case KEYCODE.UP:\n        e.preventDefault();\n        onToggleHighlightItem(this.toggleHighlightItem(-1, e), 'up');\n        break;\n\n      case KEYCODE.DOWN:\n        e.preventDefault();\n        onToggleHighlightItem(this.toggleHighlightItem(1, e), 'down');\n        break;\n\n      case KEYCODE.ENTER:\n        e.preventDefault();\n        this.chooseHighlightItem(e);\n        break;\n\n      case KEYCODE.SPACE:\n        // stopPropagation can make use onChange triggerd while typing space('') in Input\n        e.stopPropagation();\n        break;\n\n      case KEYCODE.ESC:\n        e.preventDefault();\n        this.state.visible && this.setVisible(false, 'esc');\n        break;\n\n      default:\n        break;\n    }\n\n    onKeyDown(e);\n  }; // 回车 选择高亮的 item\n\n\n  AutoComplete.prototype.chooseHighlightItem = function chooseHighlightItem() {\n    if (!this.state.visible) {\n      return false;\n    }\n\n    var highlightKey = this.state.highlightKey;\n    var highlightItem = this.dataStore.getEnableDS().find(function (item) {\n      return highlightKey === '' + item.value;\n    });\n\n    if (highlightItem) {\n      this.handleSelectEvent(highlightKey, highlightItem, 'enter');\n    }\n  };\n\n  AutoComplete.prototype.hasClear = function hasClear() {\n    var _props2 = this.props,\n        hasClear = _props2.hasClear,\n        readOnly = _props2.readOnly,\n        disabled = _props2.disabled;\n    var value = this.state.value;\n    return value && hasClear && !readOnly && !disabled;\n  };\n  /**\n   * 选择器\n   * @override\n   * @param {object} props\n   */\n\n\n  AutoComplete.prototype.renderSelect = function renderSelect() {\n    var _classNames;\n\n    var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n    var placeholder = props.placeholder,\n        size = props.size,\n        prefix = props.prefix,\n        className = props.className,\n        style = props.style,\n        label = props.label,\n        readOnly = props.readOnly,\n        disabled = props.disabled,\n        highlightHolder = props.highlightHolder,\n        locale = props.locale,\n        hasClear = props.hasClear,\n        state = props.state,\n        rtl = props.rtl;\n    var others = obj.pickOthers(AutoComplete.propTypes, props);\n    var othersData = obj.pickAttrsWith(others, 'data-');\n    var value = this.state.value;\n    var visible = this.state.visible; // // 下拉箭头\n    // const arrowNode = this.renderArrowNode(props, () => {\n    //     this.focusInput();\n    //     this.setVisible(!this.state.visible);\n    // });\n    // trigger className\n\n    var triggerClazz = classNames([prefix + 'select', prefix + 'select-auto-complete', prefix + 'size-' + size, className], (_classNames = {}, _classNames[prefix + 'active'] = visible, _classNames[prefix + 'disabled'] = disabled, _classNames)); // highlightKey into placeholder\n    // compatible with selectPlaceHolder. TODO: removed in 2.0 version\n\n    var _placeholder = placeholder || locale.autoCompletePlaceholder || locale.autoCompletePlaceHolder;\n\n    if (highlightHolder && visible) {\n      _placeholder = this.state.highlightKey || _placeholder;\n    } // Input props\n\n\n    var _inputProps = _extends({}, obj.pickOthers(othersData, others), {\n      state: state,\n      ref: this.saveInputRef,\n      hasClear: hasClear,\n      value: value,\n      size: size,\n      disabled: disabled,\n      readOnly: readOnly,\n      placeholder: _placeholder,\n      label: label,\n      // extra: arrowNode,\n      onChange: this.handleChange,\n      onKeyDown: this.handleTriggerKeyDown\n    });\n\n    return React.createElement('span', _extends({}, othersData, {\n      className: triggerClazz,\n      style: style,\n      dir: rtl ? 'rtl' : undefined,\n      ref: this.saveSelectRef,\n      onClick: this.focusInput\n    }), React.createElement(Input, _extends({\n      role: 'combobox',\n      'aria-autocomplete': 'list',\n      'aria-disabled': disabled,\n      'aria-expanded': this.state.visible\n    }, _inputProps)), React.createElement('span', {\n      className: prefix + 'sr-only',\n      'aria-live': 'polite'\n    }, this.state.srReader));\n  };\n\n  AutoComplete.prototype.render = function render() {\n    var _this2 = this;\n\n    if (this.hasClear()) {\n      // clear 按钮点击后，会在 dom 结构中被删除掉，需要将其额外设置为安全节点，防止触发弹层的显示或隐藏\n      var safeNode = this.props.popupProps.safeNode || [];\n      var safeNodes = Array.isArray(safeNode) ? safeNode : [safeNode];\n      safeNodes.push(function () {\n        return _this2.clearNode;\n      });\n      this.props.popupProps.safeNode = safeNodes;\n    }\n\n    return _Base.prototype.render.call(this, _extends({}, this.props, {\n      canCloseByTrigger: false\n    }));\n  };\n\n  return AutoComplete;\n}(Base), _class.propTypes = _extends({}, Base.propTypes, {\n  /**\n   * 当前值，用于受控模式\n   */\n  value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n\n  /**\n   * 初始化的默认值\n   */\n  defaultValue: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n\n  /**\n   * Select发生改变时触发的回调\n   * @param {*} value 选中的值\n   * @param {String} actionType 触发的方式, 'itemClick', 'enter', 'change'\n   * @param {*} item 选中的值的对象数据\n   */\n  onChange: PropTypes.func,\n\n  /**\n   * 传入的数据源，可以动态渲染子项\n   */\n  dataSource: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.shape({\n    value: PropTypes.string,\n    label: PropTypes.any,\n    disabled: PropTypes.bool,\n    children: PropTypes.array\n  }), PropTypes.string])),\n\n  /**\n   * 填充到选择框里的值的 key\b\b，默认是 value\n   */\n  fillProps: PropTypes.string,\n\n  /**\n   * 渲染 MenuItem 内容的方法\n   * @param {Object} item 渲染节点的 item\n   * @return {ReactNode} item node\n   */\n  itemRender: PropTypes.func,\n  // input keydown\n  onKeyDown: PropTypes.func,\n  // 是否将当前高亮的选项作为 placeholder\n  highlightHolder: PropTypes.bool,\n  style: PropTypes.object\n}), _class.defaultProps = _extends({}, Base.defaultProps, {\n  onKeyDown: noop,\n  fillProps: 'value'\n}), _temp);\nexport default polyfill(AutoComplete);","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/node_modules/@alifd/next/es/select/auto-complete.js"],"names":["_extends","_classCallCheck","_possibleConstructorReturn","_inherits","_class","_temp","React","PropTypes","classNames","polyfill","func","obj","KEYCODE","Input","Base","bindCtx","noop","AutoComplete","_Base","props","_this","call","handleChange","value","proxy","item","_this$props","disabled","readOnly","filterLocal","actionType","isInputing","setState","dataSource","dataStore","updateByKey","shouldControlPopup","setFirstHightLightKeyForMenu","autoHighlightFirstItem","highlightKey","onChange","setVisible","isAutoComplete","setOptions","key","state","setDataSource","getDerivedStateFromProps","nextProps","prevState","visible","Object","keys","length","prototype","componentDidUpdate","prevProps","filter","children","popupContent","arguments","undefined","type","hasPopup","getMenuDS","handleMenuSelect","mapDS","getMapDS","handleSelectEvent","handleItemClick","triggerType","fillProps","handleVisibleChange","beforeClose","handleTriggerKeyDown","e","_props","onToggleHighlightItem","onKeyDown","stopPropagation","keyCode","UP","preventDefault","toggleHighlightItem","DOWN","ENTER","chooseHighlightItem","SPACE","ESC","highlightItem","getEnableDS","find","hasClear","_props2","renderSelect","_classNames","placeholder","size","prefix","className","style","label","highlightHolder","locale","rtl","others","pickOthers","propTypes","othersData","pickAttrsWith","triggerClazz","_placeholder","autoCompletePlaceholder","autoCompletePlaceHolder","_inputProps","ref","saveInputRef","createElement","dir","saveSelectRef","onClick","focusInput","role","srReader","render","_this2","safeNode","popupProps","safeNodes","Array","isArray","push","clearNode","canCloseByTrigger","oneOfType","string","number","defaultValue","arrayOf","shape","any","bool","array","itemRender","object","defaultProps"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { polyfill } from 'react-lifecycles-compat';\n\nimport { func, obj, KEYCODE } from '../util';\nimport Input from '../input';\nimport Base from './base';\n\nvar bindCtx = func.bindCtx,\n    noop = func.noop;\n\n/**\n * Select.AutoComplete\n */\n\nvar AutoComplete = (_temp = _class = function (_Base) {\n    _inherits(AutoComplete, _Base);\n\n    function AutoComplete(props) {\n        _classCallCheck(this, AutoComplete);\n\n        var _this = _possibleConstructorReturn(this, _Base.call(this, props));\n\n        _this.handleChange = function (value, proxy, item) {\n            var _this$props = _this.props,\n                disabled = _this$props.disabled,\n                readOnly = _this$props.readOnly,\n                filterLocal = _this$props.filterLocal;\n\n\n            if (disabled || readOnly) {\n                return false;\n            }\n\n            var actionType = typeof proxy === 'string' ? proxy : 'change';\n\n            _this.isInputing = actionType === 'change';\n\n            if (filterLocal) {\n                _this.setState({\n                    dataSource: _this.dataStore.updateByKey(value)\n                });\n\n                _this.shouldControlPopup(_this.props, actionType);\n                _this.setFirstHightLightKeyForMenu();\n            }\n\n            // 非受控模式清空内部数据\n            if (!('value' in _this.props)) {\n                _this.setState({\n                    value: value\n                });\n            }\n\n            // 不自动高亮的情况下, highlightKey 根据value精确值走，也就是被选中元素自动高亮，这样也不会影响不在选项内的用户搜索操作\n            if (!_this.props.autoHighlightFirstItem) {\n                _this.setState({\n                    highlightKey: value\n                });\n            }\n\n            _this.props.onChange(value, actionType, item);\n\n            if (actionType === 'itemClick' || actionType === 'enter') {\n                // 点击 item 的时候不会触发关闭，需要手动关闭，其它类型比如 keyDown 等都会有其它事件句柄处理\n                _this.setVisible(false, actionType);\n            }\n        };\n\n        _this.isAutoComplete = true;\n        _this.isInputing = false;\n\n        _this.dataStore.setOptions({ key: _this.state.value });\n        _extends(_this.state, {\n            dataSource: _this.setDataSource(props)\n        });\n\n        bindCtx(_this, ['handleTriggerKeyDown', 'handleMenuSelect', 'handleItemClick']);\n        return _this;\n    }\n\n    AutoComplete.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n        var state = {};\n\n        if ('value' in nextProps && nextProps.value !== prevState.value) {\n            _extends(state, {\n                value: nextProps.value\n            });\n        }\n\n        if ('visible' in nextProps && nextProps.visible !== prevState.visible) {\n            _extends(state, {\n                visible: nextProps.visible\n            });\n        }\n\n        if (Object.keys(state).length) {\n            return state;\n        }\n\n        return null;\n    };\n\n    AutoComplete.prototype.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n        var props = this.props;\n\n        if ('value' in props) {\n            this.dataStore.setOptions({ key: props.value });\n        }\n\n        if (props.filter !== prevProps.filter) {\n            this.dataStore.setOptions({\n                filter: props.filter\n            });\n        }\n        if (props.filterLocal !== prevProps.filterLocal) {\n            this.dataStore.setOptions({\n                filterLocal: props.filterLocal\n            });\n        }\n\n        if (prevProps.children !== props.children || prevProps.dataSource !== props.dataSource) {\n            /* eslint-disable react/no-did-update-set-state */\n            this.setState({\n                dataSource: this.setDataSource(props)\n            });\n\n            // remote dataSource and focused\n            // 因为autoComplete没有下拉数据不展示，搜索并且有数据了需要自动展示下拉\n            if (!props.filterLocal && this.isInputing) {\n                this.shouldControlPopup(props, 'update');\n            }\n            if (!props.filterLocal && !props.popupContent) {\n                this.setFirstHightLightKeyForMenu();\n            }\n        }\n    };\n\n    AutoComplete.prototype.shouldControlPopup = function shouldControlPopup() {\n        var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n        var type = arguments[1];\n\n        var hasPopup = props.popupContent || this.dataStore.getMenuDS().length;\n        if (hasPopup) {\n            this.setVisible(true, type);\n        } else {\n            this.setVisible(false, type);\n        }\n    };\n\n    AutoComplete.prototype.handleMenuSelect = function handleMenuSelect(keys) {\n        var key = keys[0];\n\n        var mapDS = this.dataStore.getMapDS();\n\n        if (key in mapDS) {\n            var item = mapDS[key];\n            this.handleSelectEvent(key, item, 'itemClick');\n        }\n    };\n\n    AutoComplete.prototype.handleItemClick = function handleItemClick() {\n        this.setVisible(false, 'itemClick');\n    };\n\n    AutoComplete.prototype.handleSelectEvent = function handleSelectEvent(key, item, triggerType) {\n        var value = item && item[this.props.fillProps] || key;\n\n        if (triggerType === 'itemClick' || triggerType === 'enter') {\n            // 点击 item 的时候不会触发关闭，需要手动关闭，其它类型比如 keyDown 等都会有其它事件句柄处理\n            this.setVisible(false, triggerType);\n        }\n\n        this.handleChange(value, triggerType, item);\n    };\n\n    AutoComplete.prototype.handleVisibleChange = function handleVisibleChange(visible, type) {\n        if (!('visible' in this.props) && visible && !this.props.popupContent && !this.dataStore.getMenuDS().length) {\n            return;\n        }\n\n        this.setVisible(visible, type);\n    };\n\n    AutoComplete.prototype.beforeClose = function beforeClose() {\n        this.isInputing = false;\n    };\n\n    /**\n     * Handle trigger keydown event\n     * @param {Event} e\n     */\n\n\n    AutoComplete.prototype.handleTriggerKeyDown = function handleTriggerKeyDown(e) {\n        var _props = this.props,\n            popupContent = _props.popupContent,\n            onToggleHighlightItem = _props.onToggleHighlightItem,\n            onKeyDown = _props.onKeyDown;\n\n        if (popupContent) {\n            e.stopPropagation(); //stopPropagation can make use onChange triggerd while typing space('') in Input\n            return onKeyDown(e);\n        }\n\n        switch (e.keyCode) {\n            case KEYCODE.UP:\n                e.preventDefault();\n                onToggleHighlightItem(this.toggleHighlightItem(-1, e), 'up');\n                break;\n            case KEYCODE.DOWN:\n                e.preventDefault();\n                onToggleHighlightItem(this.toggleHighlightItem(1, e), 'down');\n                break;\n            case KEYCODE.ENTER:\n                e.preventDefault();\n                this.chooseHighlightItem(e);\n                break;\n            case KEYCODE.SPACE:\n                // stopPropagation can make use onChange triggerd while typing space('') in Input\n                e.stopPropagation();\n                break;\n            case KEYCODE.ESC:\n                e.preventDefault();\n                this.state.visible && this.setVisible(false, 'esc');\n                break;\n            default:\n                break;\n        }\n\n        onKeyDown(e);\n    };\n\n    // 回车 选择高亮的 item\n\n\n    AutoComplete.prototype.chooseHighlightItem = function chooseHighlightItem() {\n        if (!this.state.visible) {\n            return false;\n        }\n\n        var highlightKey = this.state.highlightKey;\n\n        var highlightItem = this.dataStore.getEnableDS().find(function (item) {\n            return highlightKey === '' + item.value;\n        });\n\n        if (highlightItem) {\n            this.handleSelectEvent(highlightKey, highlightItem, 'enter');\n        }\n    };\n\n    AutoComplete.prototype.hasClear = function hasClear() {\n        var _props2 = this.props,\n            hasClear = _props2.hasClear,\n            readOnly = _props2.readOnly,\n            disabled = _props2.disabled;\n        var value = this.state.value;\n\n\n        return value && hasClear && !readOnly && !disabled;\n    };\n\n    /**\n     * 选择器\n     * @override\n     * @param {object} props\n     */\n\n\n    AutoComplete.prototype.renderSelect = function renderSelect() {\n        var _classNames;\n\n        var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.props;\n        var placeholder = props.placeholder,\n            size = props.size,\n            prefix = props.prefix,\n            className = props.className,\n            style = props.style,\n            label = props.label,\n            readOnly = props.readOnly,\n            disabled = props.disabled,\n            highlightHolder = props.highlightHolder,\n            locale = props.locale,\n            hasClear = props.hasClear,\n            state = props.state,\n            rtl = props.rtl;\n\n        var others = obj.pickOthers(AutoComplete.propTypes, props);\n        var othersData = obj.pickAttrsWith(others, 'data-');\n\n        var value = this.state.value;\n        var visible = this.state.visible;\n\n        // // 下拉箭头\n        // const arrowNode = this.renderArrowNode(props, () => {\n        //     this.focusInput();\n        //     this.setVisible(!this.state.visible);\n        // });\n\n        // trigger className\n        var triggerClazz = classNames([prefix + 'select', prefix + 'select-auto-complete', prefix + 'size-' + size, className], (_classNames = {}, _classNames[prefix + 'active'] = visible, _classNames[prefix + 'disabled'] = disabled, _classNames));\n\n        // highlightKey into placeholder\n        // compatible with selectPlaceHolder. TODO: removed in 2.0 version\n        var _placeholder = placeholder || locale.autoCompletePlaceholder || locale.autoCompletePlaceHolder;\n        if (highlightHolder && visible) {\n            _placeholder = this.state.highlightKey || _placeholder;\n        }\n\n        // Input props\n        var _inputProps = _extends({}, obj.pickOthers(othersData, others), {\n            state: state,\n            ref: this.saveInputRef,\n            hasClear: hasClear,\n            value: value,\n            size: size,\n            disabled: disabled,\n            readOnly: readOnly,\n            placeholder: _placeholder,\n            label: label,\n            // extra: arrowNode,\n            onChange: this.handleChange,\n            onKeyDown: this.handleTriggerKeyDown\n        });\n\n        return React.createElement(\n            'span',\n            _extends({}, othersData, {\n                className: triggerClazz,\n                style: style,\n                dir: rtl ? 'rtl' : undefined,\n                ref: this.saveSelectRef,\n                onClick: this.focusInput\n            }),\n            React.createElement(Input, _extends({\n                role: 'combobox',\n                'aria-autocomplete': 'list',\n                'aria-disabled': disabled,\n                'aria-expanded': this.state.visible\n            }, _inputProps)),\n            React.createElement(\n                'span',\n                { className: prefix + 'sr-only', 'aria-live': 'polite' },\n                this.state.srReader\n            )\n        );\n    };\n\n    AutoComplete.prototype.render = function render() {\n        var _this2 = this;\n\n        if (this.hasClear()) {\n            // clear 按钮点击后，会在 dom 结构中被删除掉，需要将其额外设置为安全节点，防止触发弹层的显示或隐藏\n            var safeNode = this.props.popupProps.safeNode || [];\n            var safeNodes = Array.isArray(safeNode) ? safeNode : [safeNode];\n            safeNodes.push(function () {\n                return _this2.clearNode;\n            });\n            this.props.popupProps.safeNode = safeNodes;\n        }\n\n        return _Base.prototype.render.call(this, _extends({}, this.props, { canCloseByTrigger: false }));\n    };\n\n    return AutoComplete;\n}(Base), _class.propTypes = _extends({}, Base.propTypes, {\n    /**\n     * 当前值，用于受控模式\n     */\n    value: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    /**\n     * 初始化的默认值\n     */\n    defaultValue: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n    /**\n     * Select发生改变时触发的回调\n     * @param {*} value 选中的值\n     * @param {String} actionType 触发的方式, 'itemClick', 'enter', 'change'\n     * @param {*} item 选中的值的对象数据\n     */\n    onChange: PropTypes.func,\n    /**\n     * 传入的数据源，可以动态渲染子项\n     */\n    dataSource: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.shape({\n        value: PropTypes.string,\n        label: PropTypes.any,\n        disabled: PropTypes.bool,\n        children: PropTypes.array\n    }), PropTypes.string])),\n    /**\n     * 填充到选择框里的值的 key\b\b，默认是 value\n     */\n    fillProps: PropTypes.string,\n    /**\n     * 渲染 MenuItem 内容的方法\n     * @param {Object} item 渲染节点的 item\n     * @return {ReactNode} item node\n     */\n    itemRender: PropTypes.func,\n    // input keydown\n    onKeyDown: PropTypes.func,\n    // 是否将当前高亮的选项作为 placeholder\n    highlightHolder: PropTypes.bool,\n    style: PropTypes.object\n}), _class.defaultProps = _extends({}, Base.defaultProps, {\n    onKeyDown: noop,\n    fillProps: 'value'\n}), _temp);\n\n\nexport default polyfill(AutoComplete);"]},"metadata":{},"sourceType":"module"}