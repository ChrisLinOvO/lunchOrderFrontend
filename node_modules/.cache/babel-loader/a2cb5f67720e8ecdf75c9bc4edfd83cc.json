{"ast":null,"code":"import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Overlay from '../overlay';\nimport zhCN from '../locale/zh-cn';\nimport { focus, obj, func, events, dom, env } from '../util';\nimport Inner from './inner';\n\nvar noop = function noop() {};\n\nvar limitTabRange = focus.limitTabRange;\nvar bindCtx = func.bindCtx;\nvar pickOthers = obj.pickOthers;\nvar getStyle = dom.getStyle,\n    setStyle = dom.setStyle; // [fix issue #1609](https://github.com/alibaba-fusion/next/issues/1609)\n// https://stackoverflow.com/questions/19717907/getcomputedstyle-reporting-different-heights-between-chrome-safari-firefox-and-i\n\nfunction _getSize(dom, name) {\n  var boxSizing = getStyle(dom, 'boxSizing');\n\n  if (env.ieVersion && ['width', 'height'].indexOf(name) !== -1 && boxSizing === 'border-box') {\n    return parseFloat(dom.getBoundingClientRect()[name].toFixed(1));\n  } else {\n    return getStyle(dom, name);\n  }\n}\n/**\n * Dialog\n */\n\n\nvar Dialog = (_temp = _class = function (_Component) {\n  _inherits(Dialog, _Component);\n\n  function Dialog(props, context) {\n    _classCallCheck(this, Dialog);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props, context));\n\n    bindCtx(_this, ['onKeyDown', 'beforePosition', 'adjustPosition', 'getOverlayRef']);\n    return _this;\n  }\n\n  Dialog.prototype.componentDidMount = function componentDidMount() {\n    events.on(document, 'keydown', this.onKeyDown);\n\n    if (!this.useCSSToPosition()) {\n      this.adjustPosition();\n    }\n  };\n\n  Dialog.prototype.componentWillUnmount = function componentWillUnmount() {\n    events.off(document, 'keydown', this.onKeyDown);\n  };\n\n  Dialog.prototype.useCSSToPosition = function useCSSToPosition() {\n    var _props = this.props,\n        align = _props.align,\n        isFullScreen = _props.isFullScreen;\n    return align === 'cc cc' && isFullScreen;\n  };\n\n  Dialog.prototype.onKeyDown = function onKeyDown(e) {\n    var node = this.getInnerNode();\n\n    if (node) {\n      limitTabRange(node, e);\n    }\n  };\n\n  Dialog.prototype.beforePosition = function beforePosition() {\n    if (this.props.visible && this.overlay) {\n      var inner = this.getInner();\n\n      if (inner) {\n        var node = this.getInnerNode();\n\n        if (this._lastDialogHeight !== _getSize(node, 'height')) {\n          this.revertSize(inner.bodyNode);\n        }\n      }\n    }\n  };\n\n  Dialog.prototype.adjustPosition = function adjustPosition() {\n    if (this.props.visible && this.overlay) {\n      var inner = this.getInner();\n\n      if (inner) {\n        var node = this.getInnerNode();\n        var top = getStyle(node, 'top');\n        var minMargin = this.props.minMargin;\n\n        if (top < minMargin) {\n          top = minMargin;\n          setStyle(node, 'top', minMargin + 'px');\n        }\n\n        var height = _getSize(node, 'height');\n\n        var viewportHeight = window.innerHeight || document.documentElement.clientHeight;\n\n        if (viewportHeight < height + top * 2 - 1 || // 分辨率和精确度的原因 高度计算的时候 可能会有1px内的偏差\n        this.props.height) {\n          this.adjustSize(inner, node, Math.min(height, viewportHeight - top * 2));\n        } else {\n          this.revertSize(inner.bodyNode);\n        }\n\n        this._lastDialogHeight = height;\n      }\n    }\n  };\n\n  Dialog.prototype.adjustSize = function adjustSize(inner, node, expectHeight) {\n    var headerNode = inner.headerNode,\n        bodyNode = inner.bodyNode,\n        footerNode = inner.footerNode;\n\n    var _map = [headerNode, footerNode].map(function (node) {\n      return node ? _getSize(node, 'height') : 0;\n    }),\n        headerHeight = _map[0],\n        footerHeight = _map[1];\n\n    var padding = ['padding-top', 'padding-bottom'].reduce(function (sum, attr) {\n      return sum + getStyle(node, attr);\n    }, 0);\n    var maxBodyHeight = expectHeight - headerHeight - footerHeight - padding;\n\n    if (maxBodyHeight < 0) {\n      maxBodyHeight = 1;\n    }\n\n    if (bodyNode) {\n      this.dialogBodyStyleMaxHeight = bodyNode.style.maxHeight;\n      this.dialogBodyStyleOverflowY = bodyNode.style.overflowY;\n      setStyle(bodyNode, {\n        'max-height': maxBodyHeight + 'px',\n        'overflow-y': 'auto'\n      });\n    }\n  };\n\n  Dialog.prototype.revertSize = function revertSize(bodyNode) {\n    setStyle(bodyNode, {\n      'max-height': this.dialogBodyStyleMaxHeight,\n      'overflow-y': this.dialogBodyStyleOverflowY\n    });\n  };\n\n  Dialog.prototype.mapcloseableToConfig = function mapcloseableToConfig(closeable) {\n    return ['esc', 'close', 'mask'].reduce(function (ret, option) {\n      var key = option.charAt(0).toUpperCase() + option.substr(1);\n      var value = typeof closeable === 'boolean' ? closeable : closeable.split(',').indexOf(option) > -1;\n\n      if (option === 'esc' || option === 'mask') {\n        ret['canCloseBy' + key] = value;\n      } else {\n        ret['canCloseBy' + key + 'Click'] = value;\n      }\n\n      return ret;\n    }, {});\n  };\n\n  Dialog.prototype.getOverlayRef = function getOverlayRef(ref) {\n    this.overlay = ref;\n  };\n\n  Dialog.prototype.getInner = function getInner() {\n    return this.overlay.getInstance().getContent();\n  };\n\n  Dialog.prototype.getInnerNode = function getInnerNode() {\n    return this.overlay.getInstance().getContentNode();\n  };\n\n  Dialog.prototype.renderInner = function renderInner(closeable) {\n    var _props2 = this.props,\n        prefix = _props2.prefix,\n        className = _props2.className,\n        title = _props2.title,\n        children = _props2.children,\n        footer = _props2.footer,\n        footerAlign = _props2.footerAlign,\n        footerActions = _props2.footerActions,\n        onOk = _props2.onOk,\n        onCancel = _props2.onCancel,\n        okProps = _props2.okProps,\n        cancelProps = _props2.cancelProps,\n        onClose = _props2.onClose,\n        locale = _props2.locale,\n        visible = _props2.visible,\n        rtl = _props2.rtl,\n        height = _props2.height;\n    var others = pickOthers(Object.keys(Dialog.propTypes), this.props);\n    return React.createElement(Inner, _extends({\n      prefix: prefix,\n      className: className,\n      title: title,\n      footer: footer,\n      footerAlign: footerAlign,\n      footerActions: footerActions,\n      onOk: visible ? onOk : noop,\n      onCancel: visible ? onCancel : noop,\n      okProps: okProps,\n      cancelProps: cancelProps,\n      locale: locale,\n      closeable: closeable,\n      rtl: rtl,\n      onClose: onClose.bind(this, 'closeClick'),\n      height: height\n    }, others), children);\n  };\n\n  Dialog.prototype.render = function render() {\n    var _props3 = this.props,\n        prefix = _props3.prefix,\n        visible = _props3.visible,\n        hasMask = _props3.hasMask,\n        animation = _props3.animation,\n        autoFocus = _props3.autoFocus,\n        closeable = _props3.closeable,\n        closeMode = _props3.closeMode,\n        onClose = _props3.onClose,\n        afterClose = _props3.afterClose,\n        shouldUpdatePosition = _props3.shouldUpdatePosition,\n        align = _props3.align,\n        popupContainer = _props3.popupContainer,\n        cache = _props3.cache,\n        overlayProps = _props3.overlayProps,\n        rtl = _props3.rtl;\n    var useCSS = this.useCSSToPosition();\n    var newCloseable = 'closeMode' in this.props ? Array.isArray(closeMode) ? closeMode.join(',') : closeMode : closeable;\n\n    var _mapcloseableToConfig = this.mapcloseableToConfig(newCloseable),\n        canCloseByCloseClick = _mapcloseableToConfig.canCloseByCloseClick,\n        closeConfig = _objectWithoutProperties(_mapcloseableToConfig, ['canCloseByCloseClick']);\n\n    var newOverlayProps = _extends({\n      disableScroll: true,\n      container: popupContainer,\n      cache: cache\n    }, overlayProps, {\n      prefix: prefix,\n      visible: visible,\n      animation: animation,\n      hasMask: hasMask,\n      autoFocus: autoFocus,\n      afterClose: afterClose\n    }, closeConfig, {\n      canCloseByOutSideClick: false,\n      align: useCSS ? false : align,\n      onRequestClose: onClose,\n      needAdjust: false,\n      ref: this.getOverlayRef,\n      rtl: rtl,\n      maskClass: useCSS ? prefix + 'dialog-container' : '',\n      isChildrenInMask: useCSS && hasMask\n    });\n\n    if (!useCSS) {\n      newOverlayProps.beforePosition = this.beforePosition;\n      newOverlayProps.onPosition = this.adjustPosition;\n      newOverlayProps.shouldUpdatePosition = shouldUpdatePosition;\n    }\n\n    var inner = this.renderInner(canCloseByCloseClick); // useCSS && hasMask : isFullScreen 并且 有mask的模式下，为了解决 next-overlay-backdrop 覆盖mask，使得点击mask关闭页面的功能不生效的问题，需要开启 Overlay 的 isChildrenInMask 功能，并且把 next-dialog-container 放到 next-overlay-backdrop上\n    // useCSS && !hasMask : isFullScreen 并且 没有mask的情况下，需要关闭 isChildrenInMask 功能，以防止children不渲染\n    // 其他模式下维持 mask 与 children 同级的关系\n\n    return React.createElement(Overlay, newOverlayProps, useCSS && !hasMask ? React.createElement('div', {\n      className: prefix + 'dialog-container',\n      dir: rtl ? 'rtl' : undefined\n    }, inner) : inner);\n  };\n\n  return Dialog;\n}(Component), _class.propTypes = {\n  prefix: PropTypes.string,\n  pure: PropTypes.bool,\n  rtl: PropTypes.bool,\n  className: PropTypes.string,\n\n  /**\n   * 是否显示\n   */\n  visible: PropTypes.bool,\n\n  /**\n   * 标题\n   */\n  title: PropTypes.node,\n\n  /**\n   * 内容\n   */\n  children: PropTypes.node,\n\n  /**\n   * 底部内容，设置为 false，则不进行显示\n   * @default [<Button type=\"primary\">确定</Button>, <Button>取消</Button>]\n   */\n  footer: PropTypes.oneOfType([PropTypes.bool, PropTypes.node]),\n\n  /**\n   * 底部按钮的对齐方式\n   */\n  footerAlign: PropTypes.oneOf(['left', 'center', 'right']),\n\n  /**\n   * 指定确定按钮和取消按钮是否存在以及如何排列,<br><br>**可选值**：\n   * ['ok', 'cancel']（确认取消按钮同时存在，确认按钮在左）\n   * ['cancel', 'ok']（确认取消按钮同时存在，确认按钮在右）\n   * ['ok']（只存在确认按钮）\n   * ['cancel']（只存在取消按钮）\n   */\n  footerActions: PropTypes.array,\n\n  /**\n   * 在点击确定按钮时触发的回调函数\n   * @param {Object} event 点击事件对象\n   */\n  onOk: PropTypes.func,\n\n  /**\n   * 在点击取消按钮时触发的回调函数\n   * @param {Object} event 点击事件对象\n   */\n  onCancel: PropTypes.func,\n\n  /**\n   * 应用于确定按钮的属性对象\n   */\n  okProps: PropTypes.object,\n\n  /**\n   * 应用于取消按钮的属性对象\n   */\n  cancelProps: PropTypes.object,\n\n  /**\n   * [废弃]同closeMode, 控制对话框关闭的方式，值可以为字符串或者布尔值，其中字符串是由以下值组成：\n   * **close** 表示点击关闭按钮可以关闭对话框\n   * **mask** 表示点击遮罩区域可以关闭对话框\n   * **esc** 表示按下 esc 键可以关闭对话框\n   * 如 'close' 或 'close,esc,mask'\n   * 如果设置为 true，则以上关闭方式全部生效\n   * 如果设置为 false，则以上关闭方式全部失效\n   */\n  closeable: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n\n  /**\n   * [推荐]1.21.x 支持控制对话框关闭的方式，值可以为字符串或者数组，其中字符串、数组均为以下值的枚举：\n   * **close** 表示点击关闭按钮可以关闭对话框\n   * **mask** 表示点击遮罩区域可以关闭对话框\n   * **esc** 表示按下 esc 键可以关闭对话框\n   * 如 'close' 或 ['close','esc','mask'], []\n   * @version 1.21\n   */\n  closeMode: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOf(['close', 'mask', 'esc'])), PropTypes.oneOf(['close', 'mask', 'esc'])]),\n\n  /**\n   * 隐藏时是否保留子节点，不销毁 （低版本通过 overlayProps 实现）\n   * @version 1.23\n   */\n  cache: PropTypes.bool,\n\n  /**\n   * 对话框关闭时触发的回调函数\n   * @param {String} trigger 关闭触发行为的描述字符串\n   * @param {Object} event 关闭时事件对象\n   */\n  onClose: PropTypes.func,\n\n  /**\n   * 对话框关闭后触发的回调函数, 如果有动画，则在动画结束后触发\n   */\n  afterClose: PropTypes.func,\n\n  /**\n   * 是否显示遮罩\n   */\n  hasMask: PropTypes.bool,\n\n  /**\n   * 显示隐藏时动画的播放方式，支持 { in: 'enter-class', out: 'leave-class' } 的对象参数，如果设置为 false，则不播放动画。 请参考 Animate 组件的文档获取可用的动画名\n   * @default { in: 'expandInDown', out: 'expandOutUp' }\n   */\n  animation: PropTypes.oneOfType([PropTypes.object, PropTypes.bool]),\n\n  /**\n   * 对话框弹出时是否自动获得焦点\n   */\n  autoFocus: PropTypes.bool,\n\n  /**\n   * 对话框对齐方式, 具体见Overlay文档\n   */\n  align: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n\n  /**\n   * 当对话框高度超过浏览器视口高度时，是否显示所有内容而不是出现滚动条以保证对话框完整显示在浏览器视口内，该属性仅在对话框垂直水平居中时生效，即 align 被设置为 'cc cc' 时\n   */\n  isFullScreen: PropTypes.bool,\n\n  /**\n   * 是否在对话框重新渲染时及时更新对话框位置，一般用于对话框高度变化后依然能保证原来的对齐方式\n   */\n  shouldUpdatePosition: PropTypes.bool,\n\n  /**\n   * 对话框距离浏览器顶部和底部的最小间距，align 被设置为 'cc cc' 并且 isFullScreen 被设置为 true 时不生效\n   */\n  minMargin: PropTypes.number,\n\n  /**\n   * 透传到弹层组件的属性对象\n   */\n  overlayProps: PropTypes.object,\n\n  /**\n   * 自定义国际化文案对象\n   * @property {String} ok 确认按钮文案\n   * @property {String} cancel 取消按钮文案\n   */\n  locale: PropTypes.object,\n\n  /**\n   * 对话框的高度样式属性\n   */\n  height: PropTypes.string,\n  // Do not remove this, it's for <ConfigProvider popupContainer={} />\n  // see https://github.com/alibaba-fusion/next/issues/1508\n  popupContainer: PropTypes.any\n}, _class.defaultProps = {\n  prefix: 'next-',\n  pure: false,\n  visible: false,\n  footerAlign: 'right',\n  footerActions: ['ok', 'cancel'],\n  onOk: noop,\n  onCancel: noop,\n  cache: false,\n  okProps: {},\n  cancelProps: {},\n  closeable: 'esc,close',\n  onClose: noop,\n  afterClose: noop,\n  hasMask: true,\n  animation: {\n    in: 'fadeInUp',\n    out: 'fadeOutUp'\n  },\n  autoFocus: false,\n  align: 'cc cc',\n  isFullScreen: false,\n  shouldUpdatePosition: false,\n  minMargin: 40,\n  overlayProps: {},\n  locale: zhCN.Dialog\n}, _temp);\nDialog.displayName = 'Dialog';\nexport { Dialog as default };","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/node_modules/@alifd/next/es/dialog/dialog.js"],"names":["_objectWithoutProperties","_extends","_classCallCheck","_possibleConstructorReturn","_inherits","_class","_temp","React","Component","PropTypes","Overlay","zhCN","focus","obj","func","events","dom","env","Inner","noop","limitTabRange","bindCtx","pickOthers","getStyle","setStyle","_getSize","name","boxSizing","ieVersion","indexOf","parseFloat","getBoundingClientRect","toFixed","Dialog","_Component","props","context","_this","call","prototype","componentDidMount","on","document","onKeyDown","useCSSToPosition","adjustPosition","componentWillUnmount","off","_props","align","isFullScreen","e","node","getInnerNode","beforePosition","visible","overlay","inner","getInner","_lastDialogHeight","revertSize","bodyNode","top","minMargin","height","viewportHeight","window","innerHeight","documentElement","clientHeight","adjustSize","Math","min","expectHeight","headerNode","footerNode","_map","map","headerHeight","footerHeight","padding","reduce","sum","attr","maxBodyHeight","dialogBodyStyleMaxHeight","style","maxHeight","dialogBodyStyleOverflowY","overflowY","mapcloseableToConfig","closeable","ret","option","key","charAt","toUpperCase","substr","value","split","getOverlayRef","ref","getInstance","getContent","getContentNode","renderInner","_props2","prefix","className","title","children","footer","footerAlign","footerActions","onOk","onCancel","okProps","cancelProps","onClose","locale","rtl","others","Object","keys","propTypes","createElement","bind","render","_props3","hasMask","animation","autoFocus","closeMode","afterClose","shouldUpdatePosition","popupContainer","cache","overlayProps","useCSS","newCloseable","Array","isArray","join","_mapcloseableToConfig","canCloseByCloseClick","closeConfig","newOverlayProps","disableScroll","container","canCloseByOutSideClick","onRequestClose","needAdjust","maskClass","isChildrenInMask","onPosition","dir","undefined","string","pure","bool","oneOfType","oneOf","array","object","arrayOf","number","any","defaultProps","in","out","displayName","default"],"mappings":"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","sourcesContent":["import _objectWithoutProperties from 'babel-runtime/helpers/objectWithoutProperties';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport Overlay from '../overlay';\nimport zhCN from '../locale/zh-cn';\nimport { focus, obj, func, events, dom, env } from '../util';\nimport Inner from './inner';\n\nvar noop = function noop() {};\nvar limitTabRange = focus.limitTabRange;\nvar bindCtx = func.bindCtx;\nvar pickOthers = obj.pickOthers;\nvar getStyle = dom.getStyle,\n    setStyle = dom.setStyle;\n\n// [fix issue #1609](https://github.com/alibaba-fusion/next/issues/1609)\n// https://stackoverflow.com/questions/19717907/getcomputedstyle-reporting-different-heights-between-chrome-safari-firefox-and-i\n\nfunction _getSize(dom, name) {\n    var boxSizing = getStyle(dom, 'boxSizing');\n\n    if (env.ieVersion && ['width', 'height'].indexOf(name) !== -1 && boxSizing === 'border-box') {\n        return parseFloat(dom.getBoundingClientRect()[name].toFixed(1));\n    } else {\n        return getStyle(dom, name);\n    }\n}\n\n/**\n * Dialog\n */\nvar Dialog = (_temp = _class = function (_Component) {\n    _inherits(Dialog, _Component);\n\n    function Dialog(props, context) {\n        _classCallCheck(this, Dialog);\n\n        var _this = _possibleConstructorReturn(this, _Component.call(this, props, context));\n\n        bindCtx(_this, ['onKeyDown', 'beforePosition', 'adjustPosition', 'getOverlayRef']);\n        return _this;\n    }\n\n    Dialog.prototype.componentDidMount = function componentDidMount() {\n        events.on(document, 'keydown', this.onKeyDown);\n        if (!this.useCSSToPosition()) {\n            this.adjustPosition();\n        }\n    };\n\n    Dialog.prototype.componentWillUnmount = function componentWillUnmount() {\n        events.off(document, 'keydown', this.onKeyDown);\n    };\n\n    Dialog.prototype.useCSSToPosition = function useCSSToPosition() {\n        var _props = this.props,\n            align = _props.align,\n            isFullScreen = _props.isFullScreen;\n\n        return align === 'cc cc' && isFullScreen;\n    };\n\n    Dialog.prototype.onKeyDown = function onKeyDown(e) {\n        var node = this.getInnerNode();\n        if (node) {\n            limitTabRange(node, e);\n        }\n    };\n\n    Dialog.prototype.beforePosition = function beforePosition() {\n        if (this.props.visible && this.overlay) {\n            var inner = this.getInner();\n            if (inner) {\n                var node = this.getInnerNode();\n                if (this._lastDialogHeight !== _getSize(node, 'height')) {\n                    this.revertSize(inner.bodyNode);\n                }\n            }\n        }\n    };\n\n    Dialog.prototype.adjustPosition = function adjustPosition() {\n        if (this.props.visible && this.overlay) {\n            var inner = this.getInner();\n            if (inner) {\n                var node = this.getInnerNode();\n\n                var top = getStyle(node, 'top');\n                var minMargin = this.props.minMargin;\n                if (top < minMargin) {\n                    top = minMargin;\n                    setStyle(node, 'top', minMargin + 'px');\n                }\n\n                var height = _getSize(node, 'height');\n                var viewportHeight = window.innerHeight || document.documentElement.clientHeight;\n\n                if (viewportHeight < height + top * 2 - 1 || // 分辨率和精确度的原因 高度计算的时候 可能会有1px内的偏差\n                this.props.height) {\n                    this.adjustSize(inner, node, Math.min(height, viewportHeight - top * 2));\n                } else {\n                    this.revertSize(inner.bodyNode);\n                }\n\n                this._lastDialogHeight = height;\n            }\n        }\n    };\n\n    Dialog.prototype.adjustSize = function adjustSize(inner, node, expectHeight) {\n        var headerNode = inner.headerNode,\n            bodyNode = inner.bodyNode,\n            footerNode = inner.footerNode;\n\n        var _map = [headerNode, footerNode].map(function (node) {\n            return node ? _getSize(node, 'height') : 0;\n        }),\n            headerHeight = _map[0],\n            footerHeight = _map[1];\n\n        var padding = ['padding-top', 'padding-bottom'].reduce(function (sum, attr) {\n            return sum + getStyle(node, attr);\n        }, 0);\n\n        var maxBodyHeight = expectHeight - headerHeight - footerHeight - padding;\n\n        if (maxBodyHeight < 0) {\n            maxBodyHeight = 1;\n        }\n\n        if (bodyNode) {\n            this.dialogBodyStyleMaxHeight = bodyNode.style.maxHeight;\n            this.dialogBodyStyleOverflowY = bodyNode.style.overflowY;\n\n            setStyle(bodyNode, {\n                'max-height': maxBodyHeight + 'px',\n                'overflow-y': 'auto'\n            });\n        }\n    };\n\n    Dialog.prototype.revertSize = function revertSize(bodyNode) {\n        setStyle(bodyNode, {\n            'max-height': this.dialogBodyStyleMaxHeight,\n            'overflow-y': this.dialogBodyStyleOverflowY\n        });\n    };\n\n    Dialog.prototype.mapcloseableToConfig = function mapcloseableToConfig(closeable) {\n        return ['esc', 'close', 'mask'].reduce(function (ret, option) {\n            var key = option.charAt(0).toUpperCase() + option.substr(1);\n            var value = typeof closeable === 'boolean' ? closeable : closeable.split(',').indexOf(option) > -1;\n\n            if (option === 'esc' || option === 'mask') {\n                ret['canCloseBy' + key] = value;\n            } else {\n                ret['canCloseBy' + key + 'Click'] = value;\n            }\n\n            return ret;\n        }, {});\n    };\n\n    Dialog.prototype.getOverlayRef = function getOverlayRef(ref) {\n        this.overlay = ref;\n    };\n\n    Dialog.prototype.getInner = function getInner() {\n        return this.overlay.getInstance().getContent();\n    };\n\n    Dialog.prototype.getInnerNode = function getInnerNode() {\n        return this.overlay.getInstance().getContentNode();\n    };\n\n    Dialog.prototype.renderInner = function renderInner(closeable) {\n        var _props2 = this.props,\n            prefix = _props2.prefix,\n            className = _props2.className,\n            title = _props2.title,\n            children = _props2.children,\n            footer = _props2.footer,\n            footerAlign = _props2.footerAlign,\n            footerActions = _props2.footerActions,\n            onOk = _props2.onOk,\n            onCancel = _props2.onCancel,\n            okProps = _props2.okProps,\n            cancelProps = _props2.cancelProps,\n            onClose = _props2.onClose,\n            locale = _props2.locale,\n            visible = _props2.visible,\n            rtl = _props2.rtl,\n            height = _props2.height;\n\n        var others = pickOthers(Object.keys(Dialog.propTypes), this.props);\n\n        return React.createElement(\n            Inner,\n            _extends({\n                prefix: prefix,\n                className: className,\n                title: title,\n                footer: footer,\n                footerAlign: footerAlign,\n                footerActions: footerActions,\n                onOk: visible ? onOk : noop,\n                onCancel: visible ? onCancel : noop,\n                okProps: okProps,\n                cancelProps: cancelProps,\n                locale: locale,\n                closeable: closeable,\n                rtl: rtl,\n                onClose: onClose.bind(this, 'closeClick'),\n                height: height\n            }, others),\n            children\n        );\n    };\n\n    Dialog.prototype.render = function render() {\n        var _props3 = this.props,\n            prefix = _props3.prefix,\n            visible = _props3.visible,\n            hasMask = _props3.hasMask,\n            animation = _props3.animation,\n            autoFocus = _props3.autoFocus,\n            closeable = _props3.closeable,\n            closeMode = _props3.closeMode,\n            onClose = _props3.onClose,\n            afterClose = _props3.afterClose,\n            shouldUpdatePosition = _props3.shouldUpdatePosition,\n            align = _props3.align,\n            popupContainer = _props3.popupContainer,\n            cache = _props3.cache,\n            overlayProps = _props3.overlayProps,\n            rtl = _props3.rtl;\n\n\n        var useCSS = this.useCSSToPosition();\n        var newCloseable = 'closeMode' in this.props ? Array.isArray(closeMode) ? closeMode.join(',') : closeMode : closeable;\n\n        var _mapcloseableToConfig = this.mapcloseableToConfig(newCloseable),\n            canCloseByCloseClick = _mapcloseableToConfig.canCloseByCloseClick,\n            closeConfig = _objectWithoutProperties(_mapcloseableToConfig, ['canCloseByCloseClick']);\n\n        var newOverlayProps = _extends({\n            disableScroll: true,\n            container: popupContainer,\n            cache: cache\n        }, overlayProps, {\n            prefix: prefix,\n            visible: visible,\n            animation: animation,\n            hasMask: hasMask,\n            autoFocus: autoFocus,\n            afterClose: afterClose\n        }, closeConfig, {\n            canCloseByOutSideClick: false,\n            align: useCSS ? false : align,\n            onRequestClose: onClose,\n            needAdjust: false,\n            ref: this.getOverlayRef,\n            rtl: rtl,\n            maskClass: useCSS ? prefix + 'dialog-container' : '',\n            isChildrenInMask: useCSS && hasMask\n        });\n        if (!useCSS) {\n            newOverlayProps.beforePosition = this.beforePosition;\n            newOverlayProps.onPosition = this.adjustPosition;\n            newOverlayProps.shouldUpdatePosition = shouldUpdatePosition;\n        }\n\n        var inner = this.renderInner(canCloseByCloseClick);\n\n        // useCSS && hasMask : isFullScreen 并且 有mask的模式下，为了解决 next-overlay-backdrop 覆盖mask，使得点击mask关闭页面的功能不生效的问题，需要开启 Overlay 的 isChildrenInMask 功能，并且把 next-dialog-container 放到 next-overlay-backdrop上\n        // useCSS && !hasMask : isFullScreen 并且 没有mask的情况下，需要关闭 isChildrenInMask 功能，以防止children不渲染\n        // 其他模式下维持 mask 与 children 同级的关系\n        return React.createElement(\n            Overlay,\n            newOverlayProps,\n            useCSS && !hasMask ? React.createElement(\n                'div',\n                { className: prefix + 'dialog-container', dir: rtl ? 'rtl' : undefined },\n                inner\n            ) : inner\n        );\n    };\n\n    return Dialog;\n}(Component), _class.propTypes = {\n    prefix: PropTypes.string,\n    pure: PropTypes.bool,\n    rtl: PropTypes.bool,\n    className: PropTypes.string,\n    /**\n     * 是否显示\n     */\n    visible: PropTypes.bool,\n    /**\n     * 标题\n     */\n    title: PropTypes.node,\n    /**\n     * 内容\n     */\n    children: PropTypes.node,\n    /**\n     * 底部内容，设置为 false，则不进行显示\n     * @default [<Button type=\"primary\">确定</Button>, <Button>取消</Button>]\n     */\n    footer: PropTypes.oneOfType([PropTypes.bool, PropTypes.node]),\n    /**\n     * 底部按钮的对齐方式\n     */\n    footerAlign: PropTypes.oneOf(['left', 'center', 'right']),\n    /**\n     * 指定确定按钮和取消按钮是否存在以及如何排列,<br><br>**可选值**：\n     * ['ok', 'cancel']（确认取消按钮同时存在，确认按钮在左）\n     * ['cancel', 'ok']（确认取消按钮同时存在，确认按钮在右）\n     * ['ok']（只存在确认按钮）\n     * ['cancel']（只存在取消按钮）\n     */\n    footerActions: PropTypes.array,\n    /**\n     * 在点击确定按钮时触发的回调函数\n     * @param {Object} event 点击事件对象\n     */\n    onOk: PropTypes.func,\n    /**\n     * 在点击取消按钮时触发的回调函数\n     * @param {Object} event 点击事件对象\n     */\n    onCancel: PropTypes.func,\n    /**\n     * 应用于确定按钮的属性对象\n     */\n    okProps: PropTypes.object,\n    /**\n     * 应用于取消按钮的属性对象\n     */\n    cancelProps: PropTypes.object,\n    /**\n     * [废弃]同closeMode, 控制对话框关闭的方式，值可以为字符串或者布尔值，其中字符串是由以下值组成：\n     * **close** 表示点击关闭按钮可以关闭对话框\n     * **mask** 表示点击遮罩区域可以关闭对话框\n     * **esc** 表示按下 esc 键可以关闭对话框\n     * 如 'close' 或 'close,esc,mask'\n     * 如果设置为 true，则以上关闭方式全部生效\n     * 如果设置为 false，则以上关闭方式全部失效\n     */\n    closeable: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n    /**\n     * [推荐]1.21.x 支持控制对话框关闭的方式，值可以为字符串或者数组，其中字符串、数组均为以下值的枚举：\n     * **close** 表示点击关闭按钮可以关闭对话框\n     * **mask** 表示点击遮罩区域可以关闭对话框\n     * **esc** 表示按下 esc 键可以关闭对话框\n     * 如 'close' 或 ['close','esc','mask'], []\n     * @version 1.21\n     */\n    closeMode: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOf(['close', 'mask', 'esc'])), PropTypes.oneOf(['close', 'mask', 'esc'])]),\n    /**\n     * 隐藏时是否保留子节点，不销毁 （低版本通过 overlayProps 实现）\n     * @version 1.23\n     */\n    cache: PropTypes.bool,\n    /**\n     * 对话框关闭时触发的回调函数\n     * @param {String} trigger 关闭触发行为的描述字符串\n     * @param {Object} event 关闭时事件对象\n     */\n    onClose: PropTypes.func,\n    /**\n     * 对话框关闭后触发的回调函数, 如果有动画，则在动画结束后触发\n     */\n    afterClose: PropTypes.func,\n    /**\n     * 是否显示遮罩\n     */\n    hasMask: PropTypes.bool,\n    /**\n     * 显示隐藏时动画的播放方式，支持 { in: 'enter-class', out: 'leave-class' } 的对象参数，如果设置为 false，则不播放动画。 请参考 Animate 组件的文档获取可用的动画名\n     * @default { in: 'expandInDown', out: 'expandOutUp' }\n     */\n    animation: PropTypes.oneOfType([PropTypes.object, PropTypes.bool]),\n    /**\n     * 对话框弹出时是否自动获得焦点\n     */\n    autoFocus: PropTypes.bool,\n    /**\n     * 对话框对齐方式, 具体见Overlay文档\n     */\n    align: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n    /**\n     * 当对话框高度超过浏览器视口高度时，是否显示所有内容而不是出现滚动条以保证对话框完整显示在浏览器视口内，该属性仅在对话框垂直水平居中时生效，即 align 被设置为 'cc cc' 时\n     */\n    isFullScreen: PropTypes.bool,\n    /**\n     * 是否在对话框重新渲染时及时更新对话框位置，一般用于对话框高度变化后依然能保证原来的对齐方式\n     */\n    shouldUpdatePosition: PropTypes.bool,\n    /**\n     * 对话框距离浏览器顶部和底部的最小间距，align 被设置为 'cc cc' 并且 isFullScreen 被设置为 true 时不生效\n     */\n    minMargin: PropTypes.number,\n    /**\n     * 透传到弹层组件的属性对象\n     */\n    overlayProps: PropTypes.object,\n    /**\n     * 自定义国际化文案对象\n     * @property {String} ok 确认按钮文案\n     * @property {String} cancel 取消按钮文案\n     */\n    locale: PropTypes.object,\n    /**\n     * 对话框的高度样式属性\n     */\n    height: PropTypes.string,\n    // Do not remove this, it's for <ConfigProvider popupContainer={} />\n    // see https://github.com/alibaba-fusion/next/issues/1508\n    popupContainer: PropTypes.any\n}, _class.defaultProps = {\n    prefix: 'next-',\n    pure: false,\n    visible: false,\n    footerAlign: 'right',\n    footerActions: ['ok', 'cancel'],\n    onOk: noop,\n    onCancel: noop,\n    cache: false,\n    okProps: {},\n    cancelProps: {},\n    closeable: 'esc,close',\n    onClose: noop,\n    afterClose: noop,\n    hasMask: true,\n    animation: {\n        in: 'fadeInUp',\n        out: 'fadeOutUp'\n    },\n    autoFocus: false,\n    align: 'cc cc',\n    isFullScreen: false,\n    shouldUpdatePosition: false,\n    minMargin: 40,\n    overlayProps: {},\n    locale: zhCN.Dialog\n}, _temp);\nDialog.displayName = 'Dialog';\nexport { Dialog as default };"]},"metadata":{},"sourceType":"module"}