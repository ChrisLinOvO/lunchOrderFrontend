{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport { filter, parseDataSourceFromChildren, normalizeDataSource, flattingDataSource, filterDataSource } from './util';\n/**\n * manage dataSource for menu list\n */\n\nvar DataStore = function () {\n  function DataStore(options) {\n    _classCallCheck(this, DataStore);\n\n    this.options = _extends({\n      filter: filter,\n      key: undefined,\n      addonKey: false,\n      filterLocal: true,\n      showDataSourceChildren: true\n    }, options); // origin data\n\n    this.dataSource = []; // current data for menu display\n\n    this.menuDataSource = []; // key=>value map for menuDataSource\n\n    this.mapDataSource = {}; // current data can be select (not disabled) on menu\n\n    this.enabledDataSource = [];\n    this.flattenDataSource = [];\n  }\n\n  DataStore.prototype.setOptions = function setOptions(options) {\n    _extends(this.options, options);\n  };\n\n  DataStore.prototype.updateByDS = function updateByDS(dataSource) {\n    var isChildren = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    this.dataSource = isChildren ? parseDataSourceFromChildren(dataSource) : normalizeDataSource(dataSource, 0, this.options.showDataSourceChildren);\n    return this.updateAll();\n  };\n\n  DataStore.prototype.updateByKey = function updateByKey(key) {\n    if (key === this.options.key) {\n      return this.getMenuDS();\n    }\n\n    this.options.key = key;\n    return this.updateAll();\n  };\n\n  DataStore.prototype.getOriginDS = function getOriginDS() {\n    return this.dataSource;\n  };\n\n  DataStore.prototype.getMenuDS = function getMenuDS() {\n    return this.menuDataSource;\n  };\n\n  DataStore.prototype.getFlattenDS = function getFlattenDS() {\n    return this.flattenDataSource;\n  };\n\n  DataStore.prototype.getEnableDS = function getEnableDS() {\n    return this.enabledDataSource;\n  };\n\n  DataStore.prototype.getMapDS = function getMapDS() {\n    return this.mapDataSource;\n  };\n\n  DataStore.prototype.updateAll = function updateAll() {\n    var _this = this;\n\n    var _options = this.options,\n        key = _options.key,\n        filter = _options.filter,\n        filterLocal = _options.filterLocal,\n        showDataSourceChildren = _options.showDataSourceChildren;\n    this.menuDataSource = filterDataSource(this.dataSource, filterLocal ? key : '', filter, this.options.addonKey);\n    this.flattenDataSource = showDataSourceChildren ? flattingDataSource(this.menuDataSource) : this.menuDataSource;\n    this.mapDataSource = {};\n    this.flattenDataSource.forEach(function (item) {\n      _this.mapDataSource['' + item.value] = item;\n    });\n    this.enabledDataSource = this.flattenDataSource.filter(function (item) {\n      return !item.disabled;\n    });\n    return this.menuDataSource;\n  };\n\n  return DataStore;\n}();\n\nexport default DataStore;","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/node_modules/@alifd/next/es/select/data-store.js"],"names":["_extends","_classCallCheck","filter","parseDataSourceFromChildren","normalizeDataSource","flattingDataSource","filterDataSource","DataStore","options","key","undefined","addonKey","filterLocal","showDataSourceChildren","dataSource","menuDataSource","mapDataSource","enabledDataSource","flattenDataSource","prototype","setOptions","updateByDS","isChildren","arguments","length","updateAll","updateByKey","getMenuDS","getOriginDS","getFlattenDS","getEnableDS","getMapDS","_this","_options","forEach","item","value","disabled"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport { filter, parseDataSourceFromChildren, normalizeDataSource, flattingDataSource, filterDataSource } from './util';\n\n/**\n * manage dataSource for menu list\n */\n\nvar DataStore = function () {\n    function DataStore(options) {\n        _classCallCheck(this, DataStore);\n\n        this.options = _extends({\n            filter: filter,\n            key: undefined,\n            addonKey: false,\n            filterLocal: true,\n            showDataSourceChildren: true\n        }, options);\n\n        // origin data\n        this.dataSource = [];\n        // current data for menu display\n        this.menuDataSource = [];\n        // key=>value map for menuDataSource\n        this.mapDataSource = {};\n        // current data can be select (not disabled) on menu\n        this.enabledDataSource = [];\n        this.flattenDataSource = [];\n    }\n\n    DataStore.prototype.setOptions = function setOptions(options) {\n        _extends(this.options, options);\n    };\n\n    DataStore.prototype.updateByDS = function updateByDS(dataSource) {\n        var isChildren = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n        this.dataSource = isChildren ? parseDataSourceFromChildren(dataSource) : normalizeDataSource(dataSource, 0, this.options.showDataSourceChildren);\n        return this.updateAll();\n    };\n\n    DataStore.prototype.updateByKey = function updateByKey(key) {\n        if (key === this.options.key) {\n            return this.getMenuDS();\n        }\n\n        this.options.key = key;\n        return this.updateAll();\n    };\n\n    DataStore.prototype.getOriginDS = function getOriginDS() {\n        return this.dataSource;\n    };\n\n    DataStore.prototype.getMenuDS = function getMenuDS() {\n        return this.menuDataSource;\n    };\n\n    DataStore.prototype.getFlattenDS = function getFlattenDS() {\n        return this.flattenDataSource;\n    };\n\n    DataStore.prototype.getEnableDS = function getEnableDS() {\n        return this.enabledDataSource;\n    };\n\n    DataStore.prototype.getMapDS = function getMapDS() {\n        return this.mapDataSource;\n    };\n\n    DataStore.prototype.updateAll = function updateAll() {\n        var _this = this;\n\n        var _options = this.options,\n            key = _options.key,\n            filter = _options.filter,\n            filterLocal = _options.filterLocal,\n            showDataSourceChildren = _options.showDataSourceChildren;\n\n        this.menuDataSource = filterDataSource(this.dataSource, filterLocal ? key : '', filter, this.options.addonKey);\n\n        this.flattenDataSource = showDataSourceChildren ? flattingDataSource(this.menuDataSource) : this.menuDataSource;\n\n        this.mapDataSource = {};\n        this.flattenDataSource.forEach(function (item) {\n            _this.mapDataSource['' + item.value] = item;\n        });\n\n        this.enabledDataSource = this.flattenDataSource.filter(function (item) {\n            return !item.disabled;\n        });\n\n        return this.menuDataSource;\n    };\n\n    return DataStore;\n}();\n\nexport default DataStore;"]},"metadata":{},"sourceType":"module"}