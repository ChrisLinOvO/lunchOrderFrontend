{"ast":null,"code":"import _Pagination from \"@alifd/next/es/pagination\";\nimport _Table from \"@alifd/next/es/table\";\nimport _Button from \"@alifd/next/es/button\";\nimport _Dialog from \"@alifd/next/es/dialog\";\nimport _DatePicker from \"@alifd/next/es/date-picker\";\nimport _Input from \"@alifd/next/es/input\";\nimport _Message from \"@alifd/next/es/message\";\nimport _Form from \"@alifd/next/es/form\";\nimport _Select from \"@alifd/next/es/select\";\n\nvar _jsxFileName = \"/Users/Chris/Project/lunch-order-backstage/src/components/OrderTable/OrderTable.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef, Fragment } from 'react';\nimport Swal from 'sweetalert2';\nimport client from '../../lib/feathers';\nimport axios from 'axios';\nimport moment from 'moment';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Option = _Select.Option;\nconst {\n  Item\n} = _Form;\n\nconst OrderTable = props => {\n  _s();\n\n  const {\n    dbName,\n    keys,\n    text\n  } = props.tarProps;\n  const dbService = client.service(`${dbName}`); // const [listData, setListData] = useState([]);\n  // const [listDataAll, setListDataAll] = useState([]);\n\n  const [writeData, setWriteData] = useState({});\n  const [popupState, setPopupState] = useState(false);\n  const [editKey, setEditKey] = useState(false);\n  const [editIndex, setEditIndex] = useState(\"\"); //uploads files\n\n  const [parsed, setParsed] = useState([]);\n  const [parsed64, setParsed64] = useState([]); //Base64\n\n  const [file, setFile] = useState(\"\");\n  const uploadFile = useRef(null);\n  const uploadExcelFile = useRef(null); // sort\n\n  const [curdataIndex, setcurDataIndex] = useState('money');\n  const [curorder, setcurOrder] = useState('asc'); // change page\n\n  const [currentPage, setCurrentPage] = useState(1);\n  const [postsPerPage] = useState(10);\n  const indexOfLastPost = currentPage * postsPerPage;\n  const indexOfFirstPost = indexOfLastPost - postsPerPage;\n  const currentPosts = props.listData.slice(indexOfFirstPost, indexOfLastPost); // dbService\n\n  async function funFind(para) {\n    const result = await dbService.find({\n      query: para\n    }); // console.log(result);\n\n    return result && result.data ? result.data : [];\n  }\n\n  async function funCreate(obj) {\n    return await dbService.create(obj);\n  }\n\n  async function funUpdate(id, obj) {\n    return await dbService.patch(id, obj);\n  }\n\n  async function funRemove(id) {\n    return await dbService.remove(id);\n  }\n\n  const serverDataUpdate = (dataIndex, order) => {\n    const rdataIndex = dataIndex || curdataIndex;\n    const rorder = order || curorder;\n    funFind({}).then(result => {\n      const sortedArr = result.sort((a, b) => {\n        const result = (typeof a[rdataIndex] === 'number' ? a[rdataIndex].toString() : a[rdataIndex]).localeCompare(typeof b[rdataIndex] === 'number' ? b[rdataIndex].toString() : b[rdataIndex]);\n        return rorder === 'asc' ? result > 0 ? 1 : -1 : result > 0 ? -1 : 1;\n      });\n      props.listDataProps(sortedArr);\n      props.listDataAllProps(sortedArr);\n    });\n  };\n\n  const onTableSort = (dataIndex, order) => {\n    console.log('==dataIndex:', dataIndex, 'order:', order);\n    setcurDataIndex(dataIndex);\n    setcurOrder(order);\n    serverDataUpdate(dataIndex, order);\n  };\n\n  useEffect(() => {\n    serverDataUpdate();\n  }, []);\n\n  function beforeUpload() {\n    return new Promise(async (resolve, reject) => {\n      if (uploadFile.current.files.length > 0) {\n        const isLt20M = (await uploadFile.current.files[0].size) / 1024 / 1024 < 20;\n\n        if (!isLt20M) {\n          _Message.error('Image must smaller than 20MB!');\n\n          return reject();\n        }\n\n        resolve(isLt20M);\n      } else {\n        setParsed64('');\n      }\n    });\n  }\n\n  const handleFiles = async () => {\n    try {\n      await beforeUpload();\n      const files = [...parsed];\n      const data = await uploadFile.current.files[0]; // console.log(data)\n\n      files.push(data);\n      setParsed(files); //轉Base64 上傳檔案後呈現沒有寫到DB\n\n      const reader = new FileReader();\n\n      reader.onload = function () {\n        let dataURL = reader.result;\n        setParsed64(dataURL);\n      };\n\n      reader.readAsDataURL(data);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const addCreateData = (key, value) => {\n    //-------Input OnChange Event\n    let obj = {};\n    obj[key] = value;\n    setWriteData({ ...writeData,\n      ...obj\n    });\n  };\n\n  const createSend = () => {\n    //-------Create Data 送出\n    if (editKey == true) {\n      //Check is edit state\n      Swal.fire({\n        title: `確定修改此資料?`,\n        text: '請確認修改資料!!',\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#BEBEBE',\n        confirmButtonText: '確定',\n        cancelButtonText: '取消'\n      }).then(result => {\n        if (result.isConfirmed) {\n          const data = currentPosts[editIndex];\n          let newObj = { ...data,\n            ...writeData\n          };\n          patchOrders(newObj);\n        }\n      });\n    } else {\n      Swal.fire({\n        title: `確定新增此資料?`,\n        text: '請確認資料填寫完整!!',\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#BEBEBE',\n        confirmButtonText: '確定',\n        cancelButtonText: '取消'\n      }).then(result => {\n        if (result.isConfirmed) {\n          createOrders();\n        }\n      });\n    }\n  };\n\n  const typeComponents = (e, type) => {\n    // Render Type Components\n    let element;\n\n    switch (type) {\n      case \"input\":\n        element = /*#__PURE__*/_jsxDEV(_Input, {\n          value: writeData[e],\n          onChange: value => {\n            addCreateData(e, value);\n          },\n          placeholder: e\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }, this);\n        break;\n\n      case \"datePicker\":\n        element = /*#__PURE__*/_jsxDEV(_DatePicker, {\n          value: writeData[e],\n          placeholder: e,\n          onChange: value => {\n            addCreateData(e, moment(value).format(\"YYYY-MM-DD\"));\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this);\n        break;\n\n      case \"textArea\":\n        element = /*#__PURE__*/_jsxDEV(_Input.TextArea, {\n          value: writeData[e],\n          placeholder: e,\n          maxLength: 500,\n          rows: 6,\n          hasLimitHint: true,\n          \"aria-label\": \"input max length 500\",\n          onChange: value => {\n            addCreateData(e, value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this);\n        break;\n\n      case \"select\":\n        element = /*#__PURE__*/_jsxDEV(_Select, {\n          value: writeData[e],\n          hasClear: true,\n          style: {\n            width: '100%'\n          },\n          placeholder: e,\n          dataSource: props.categoryProps,\n          onChange: value => {\n            addCreateData(e, value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 11\n        }, this);\n        break;\n\n      case \"uploads\":\n        element = /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            accept: \"image/png, image/jpeg, image/jpg\",\n            ref: uploadFile,\n            onChange: handleFiles,\n            type: \"file\",\n            id: \"file\",\n            name: \"files\" // multiple\n\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this), editKey == true ? /*#__PURE__*/_jsxDEV(\"img\", {\n            style: {\n              width: '50px',\n              height: '50px'\n            },\n            src: `${parsed64.length > 0 ? parsed64 : currentPosts[editIndex].files}`,\n            alt: \"\\u5716\\u7247\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 15\n          }, this) : null]\n        }, void 0, true);\n        break;\n\n      case \"multiSelect\":\n        element = /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(_Select, {\n            mode: \"multiple\",\n            value: writeData[e],\n            showSearch: true,\n            onChange: value => {\n              addCreateData(e, value);\n            },\n            dataSource: props.venderNameProps,\n            style: {\n              width: '100%'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 13\n          }, this)\n        }, void 0, false);\n        break;\n    }\n\n    return element;\n  };\n\n  function createOrders() {\n    //Use orders create\n    funCreate({ ...writeData,\n      stage: \"完成\"\n    }).then(res => {\n      Swal.fire('成功!', `此資料已新增`, 'success');\n      console.log('==create success:', res);\n      serverDataUpdate();\n      setWriteData({});\n      setParsed64('');\n      setEditKey(false);\n      setPopupState(false);\n    }).catch(error => {\n      console.log('==create fail:', error); // Message.error(`${err}`);\n    });\n  }\n\n  function patchPayOrders(data) {\n    //Use pay money patch\n    Swal.fire({\n      title: `確設午餐錢繳交?`,\n      text: '麻煩再次確認金額哦～～',\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#BEBEBE',\n      confirmButtonText: '確定',\n      cancelButtonText: '取消'\n    }).then(result => {\n      if (result.isConfirmed) {\n        funUpdate(data._id, {\n          pay: true\n        }).then(res => {\n          console.log('==update success:', res);\n          Swal.fire({\n            position: 'center',\n            icon: 'success',\n            title: '付錢成功',\n            showConfirmButton: false,\n            timer: 1500\n          });\n          serverDataUpdate();\n          setWriteData({});\n          setParsed64('');\n          setEditKey(false);\n          setPopupState(false);\n        }).catch(error => {\n          console.log('==update fail:', error);\n\n          _Message.success('付錢失敗');\n        });\n      }\n    });\n  }\n\n  function patchOrders(data) {\n    //Use orders patch\n    funUpdate(data._id, { ...data\n    }).then(res => {\n      console.log('==update success:', res);\n      Swal.fire({\n        position: 'center',\n        icon: 'success',\n        title: '編輯成功',\n        showConfirmButton: false,\n        timer: 1500\n      });\n      serverDataUpdate();\n      setWriteData({});\n      setParsed64('');\n      setEditKey(false);\n      setPopupState(false);\n    }).catch(error => {\n      console.log('==update fail:', error);\n\n      _Message.success('更新失敗');\n    });\n  }\n\n  function createUploads() {\n    //Use uploads create\n    return new Promise(async (resolve, reject) => {\n      try {\n        const formData = new FormData();\n        Object.keys(writeData).forEach(eKey => {\n          if (eKey == \"vendorName\") {\n            formData.append(\"vendorName\", JSON.stringify(writeData[eKey]));\n          } else {\n            formData.append(eKey, writeData[eKey]);\n          }\n        }); // formData.append('createdTime', new Date().toLocaleString());\n        // formData.append('updatedTime', new Date().toLocaleString());\n\n        if (uploadFile.current !== null && uploadFile.current.files && uploadFile.current.files.length > 0) {\n          formData.append('files', uploadFile.current.files[0]);\n        }\n\n        const Res = await axios(`http://localhost:3030/uploads`, {\n          method: 'POST',\n          headers: {\n            authorization: window.localStorage['feathers-jwt']\n          },\n          data: formData\n        });\n        resolve(Res);\n      } catch (error) {\n        reject(error);\n      }\n    });\n  }\n\n  function patchUploads(data) {\n    //Use uploads patch\n    return new Promise(async (resolve, reject) => {\n      try {\n        let patchUrl = `/uploads?type=${dbName}&id=${data._id}`;\n        const formData = new FormData();\n        const passKeys = ['files', '_id']; //禁止FormData Patch add Key\n\n        Object.keys(data).forEach(eKey => {\n          if (!passKeys.includes(eKey)) {\n            if (eKey == \"vendorName\") {\n              formData.append(\"vendorName\", JSON.stringify(writeData[eKey]));\n            } else {\n              formData.append(eKey, writeData[eKey]);\n            }\n          }\n        });\n\n        if (uploadFile.current.files.length > 0) {\n          formData.append('files', uploadFile.current.files[0]);\n        }\n\n        if (!uploadFile.current.files.length) {\n          patchUrl = `/uploads?type=${dbName}&id=${data._id}&img=keep`;\n        }\n\n        console.log('rdy to PP:', formData);\n        const Res = await axios(patchUrl, {\n          method: 'PATCH',\n          headers: {\n            authorization: window.localStorage['feathers-jwt']\n          },\n          data: formData\n        });\n        resolve(Res);\n      } catch (error) {\n        console.log('PP err:', error);\n        reject();\n      }\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(_Dialog, {\n      hasMask: false,\n      visible: popupState,\n      onOk: () => {\n        createSend();\n      },\n      onCancel: () => {\n        setPopupState(false);\n        setEditKey(false);\n        setWriteData({});\n      },\n      onClose: () => {\n        setPopupState(false);\n        setEditKey(false);\n        setWriteData({});\n      },\n      children: [...Object.keys(keys)].map((e, nb) => {\n        //-------Render Create Element\n        const type = keys[e].type;\n        if (keys[e].text == \"建立時間\" || keys[e].text == \"修改時間\" || keys[e].text == \"證照\") return \"\";\n        return /*#__PURE__*/_jsxDEV(Fragment, {\n          children: /*#__PURE__*/_jsxDEV(_Form, {\n            children: /*#__PURE__*/_jsxDEV(Item, {\n              label: keys[e].text,\n              children: typeComponents(e, type)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 478,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 13\n          }, this)\n        }, keys[e].text, false, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 18\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 453,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(_Button, {\n        type: \"primary\",\n        onClick: () => {\n          setPopupState(true);\n        },\n        children: \"\\u65B0\\u589E\\u8A02\\u55AE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 488,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 487,\n      columnNumber: 7\n    }, this), currentPosts && currentPosts.length > 0 ? /*#__PURE__*/_jsxDEV(_Table, {\n      dataSource: currentPosts,\n      onSort: onTableSort,\n      children: [[...Object.keys(keys)].map(list => {\n        //  -------Render Table Data\n        if (list == \"files\") {\n          return /*#__PURE__*/_jsxDEV(_Table.Column, {\n            width: 200,\n            title: keys[list].text,\n            cell: (record, index) => {\n              return /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: currentPosts[index].files.length > 0 ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  alt: \"No Data\",\n                  src: currentPosts[index].files\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 511,\n                  columnNumber: 21\n                }, this) : null\n              }, void 0, false);\n            }\n          }, keys[list].text, false, {\n            fileName: _jsxFileName,\n            lineNumber: 507,\n            columnNumber: 22\n          }, this);\n        } else if (list == \"createTime\") {\n          return /*#__PURE__*/_jsxDEV(_Table.Column, {\n            sortable: true,\n            width: 200,\n            title: keys[list].text,\n            dataIndex: list,\n            cell: (record, index) => {\n              return /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: new Date(currentPosts[index].createTime).toLocaleString()\n              }, void 0, false);\n            }\n          }, keys[list].text, false, {\n            fileName: _jsxFileName,\n            lineNumber: 517,\n            columnNumber: 22\n          }, this);\n        } else if (list == \"updateTime\") {\n          return /*#__PURE__*/_jsxDEV(_Table.Column, {\n            sortable: true,\n            width: 200,\n            title: keys[list].text,\n            dataIndex: list,\n            cell: (record, index) => {\n              return /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: new Date(currentPosts[index].updateTime).toLocaleString()\n              }, void 0, false);\n            }\n          }, keys[list].text, false, {\n            fileName: _jsxFileName,\n            lineNumber: 526,\n            columnNumber: 22\n          }, this);\n        } else if (list == \"vendorName\") {\n          return /*#__PURE__*/_jsxDEV(_Table.Column, {\n            width: 200,\n            title: keys[list].text,\n            cell: (record, index) => {\n              return /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: currentPosts[index].vendorName.length > 0 ? currentPosts[index].vendorName.map((list, index) => {\n                  return /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: list\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 542,\n                    columnNumber: 25\n                  }, this);\n                }) : null\n              }, void 0, false);\n            }\n          }, keys[list].text, false, {\n            fileName: _jsxFileName,\n            lineNumber: 535,\n            columnNumber: 22\n          }, this);\n        } else if (list == \"vendorLicense\") {\n          return /*#__PURE__*/_jsxDEV(_Table.Column, {\n            sortable: true,\n            width: 200,\n            title: keys[list].text,\n            cell: (record, index) => {\n              return /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: currentPosts[index].vendorLicense.length > 0 ? currentPosts[index].vendorLicense.map((list, index) => {\n                  return /*#__PURE__*/_jsxDEV(\"p\", {\n                    children: list.name\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 560,\n                    columnNumber: 25\n                  }, this);\n                }) : null\n              }, void 0, false);\n            }\n          }, keys[list].text, false, {\n            fileName: _jsxFileName,\n            lineNumber: 553,\n            columnNumber: 22\n          }, this);\n        } else {\n          return /*#__PURE__*/_jsxDEV(_Table.Column, {\n            sortable: true,\n            title: keys[list].text,\n            dataIndex: list,\n            width: 200\n          }, keys[list].text, false, {\n            fileName: _jsxFileName,\n            lineNumber: 571,\n            columnNumber: 22\n          }, this);\n        }\n      }), /*#__PURE__*/_jsxDEV(_Table.Column, {\n        width: 200,\n        title: \"\\u64CD\\u4F5C\",\n        cell: (value, index, record) => {\n          // console.log(value, index, record)\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(_Button, {\n              type: \"secondary\",\n              onClick: () => {\n                patchPayOrders(record);\n              },\n              children: \"\\u4ED8\\u9322\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 582,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(_Button, {\n              type: \"normal\",\n              onClick: () => {\n                setPopupState(true);\n                setEditKey(true);\n                setEditIndex(index);\n                setWriteData({ ...currentPosts[index]\n                });\n              },\n              children: \"\\u7DE8\\u8F2F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 591,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(_Button, {\n              type: \"primary\",\n              warning: true,\n              onClick: () => {\n                const item = currentPosts[index];\n                Swal.fire({\n                  title: `確定刪除此資料?`,\n                  text: '刪除後將無法復原!!',\n                  icon: 'warning',\n                  showCancelButton: true,\n                  confirmButtonColor: '#3085d6',\n                  cancelButtonColor: '#BEBEBE',\n                  confirmButtonText: '確定',\n                  cancelButtonText: '取消'\n                }).then(result => {\n                  if (result.isConfirmed) {\n                    Swal.fire('刪除!', `此資料已刪除`, 'success');\n                    funRemove(item._id).then(() => {\n                      const prePages = currentPage - 1 >= 0 ? currentPage - 1 : 0;\n\n                      if (props.listData.length - 1 <= prePages * postsPerPage) {\n                        setCurrentPage(currentPage - 1 < 1 ? 1 : currentPage - 1);\n                      }\n\n                      serverDataUpdate();\n                    });\n                  }\n                });\n              },\n              children: \"\\u522A\\u9664\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 603,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 17\n          }, this);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 502,\n      columnNumber: 9\n    }, this) : null, /*#__PURE__*/_jsxDEV(_Pagination, {\n      total: props.listData.length,\n      pageSize: postsPerPage,\n      totalRender: total => `Total: ${total}`,\n      onChange: pageNumber => {\n        setCurrentPage(pageNumber);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 650,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s(OrderTable, \"0j6Ja0ePZ+npSHqrLd6ikTECqzY=\");\n\n_c = OrderTable;\nexport default OrderTable;\n\nvar _c;\n\n$RefreshReg$(_c, \"OrderTable\");","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/src/components/OrderTable/OrderTable.jsx"],"names":["React","useState","useEffect","useRef","Fragment","Swal","client","axios","moment","Option","Item","OrderTable","props","dbName","keys","text","tarProps","dbService","service","writeData","setWriteData","popupState","setPopupState","editKey","setEditKey","editIndex","setEditIndex","parsed","setParsed","parsed64","setParsed64","file","setFile","uploadFile","uploadExcelFile","curdataIndex","setcurDataIndex","curorder","setcurOrder","currentPage","setCurrentPage","postsPerPage","indexOfLastPost","indexOfFirstPost","currentPosts","listData","slice","funFind","para","result","find","query","data","funCreate","obj","create","funUpdate","id","patch","funRemove","remove","serverDataUpdate","dataIndex","order","rdataIndex","rorder","then","sortedArr","sort","a","b","toString","localeCompare","listDataProps","listDataAllProps","onTableSort","console","log","beforeUpload","Promise","resolve","reject","current","files","length","isLt20M","size","error","handleFiles","push","reader","FileReader","onload","dataURL","readAsDataURL","err","addCreateData","key","value","createSend","fire","title","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","isConfirmed","newObj","patchOrders","createOrders","typeComponents","e","type","element","format","width","categoryProps","height","venderNameProps","stage","res","catch","patchPayOrders","_id","pay","position","showConfirmButton","timer","success","createUploads","formData","FormData","Object","forEach","eKey","append","JSON","stringify","Res","method","headers","authorization","window","localStorage","patchUploads","patchUrl","passKeys","includes","map","nb","list","record","index","Date","createTime","toLocaleString","updateTime","vendorName","vendorLicense","name","item","prePages","total","pageNumber"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, Fragment } from 'react';\nimport {\n  Button,\n  Dialog,\n  Input,\n  Form,\n  Select,\n  DatePicker,\n  Message,\n  Card,\n  Table,\n  Pagination\n} from \"@alifd/next\";\nimport Swal from 'sweetalert2';\nimport client from '../../lib/feathers';\nimport axios from 'axios';\nimport moment from 'moment';\nconst Option = Select.Option;\nconst { Item } = Form;\nconst OrderTable = (props) => {\n  const { dbName, keys, text } = props.tarProps;\n  const dbService = client.service(`${dbName}`);\n  // const [listData, setListData] = useState([]);\n  // const [listDataAll, setListDataAll] = useState([]);\n  const [writeData, setWriteData] = useState({});\n  const [popupState, setPopupState] = useState(false);\n  const [editKey, setEditKey] = useState(false);\n  const [editIndex, setEditIndex] = useState(\"\");\n  //uploads files\n  const [parsed, setParsed] = useState([]);\n  const [parsed64, setParsed64] = useState([]); //Base64\n  const [file, setFile] = useState(\"\");\n  const uploadFile = useRef(null);\n  const uploadExcelFile = useRef(null);\n  // sort\n  const [curdataIndex, setcurDataIndex] = useState('money');\n  const [curorder, setcurOrder] = useState('asc');\n  // change page\n  const [currentPage, setCurrentPage] = useState(1);\n  const [postsPerPage] = useState(10);\n  const indexOfLastPost = currentPage * postsPerPage;\n  const indexOfFirstPost = indexOfLastPost - postsPerPage;\n  const currentPosts = props.listData.slice(indexOfFirstPost, indexOfLastPost);\n  // dbService\n  async function funFind(para) {\n    const result = await dbService.find({ query: para });\n    // console.log(result);\n    return result && result.data ? result.data : [];\n  }\n\n  async function funCreate(obj) {\n    return (await dbService.create(obj))\n  }\n  async function funUpdate(id, obj) {\n    return (await dbService.patch(id, obj))\n  }\n  async function funRemove(id) {\n    return (await dbService.remove(id))\n  }\n  const serverDataUpdate = (dataIndex, order) => {\n    const rdataIndex = dataIndex || curdataIndex;\n    const rorder = order || curorder;\n\n    funFind({}).then((result) => {\n      const sortedArr = result.sort((a, b) => {\n        const result = (typeof a[rdataIndex] === 'number'\n          ? a[rdataIndex].toString()\n          : a[rdataIndex]\n        ).localeCompare(\n          typeof b[rdataIndex] === 'number'\n            ? b[rdataIndex].toString()\n            : b[rdataIndex]\n        );\n        return rorder === 'asc' ? (result > 0 ? 1 : -1) : result > 0 ? -1 : 1;\n      })\n      props.listDataProps(sortedArr);\n      props.listDataAllProps(sortedArr)\n    });\n\n\n  };\n  const onTableSort = (dataIndex, order) => {\n    console.log('==dataIndex:', dataIndex, 'order:', order);\n    setcurDataIndex(dataIndex);\n    setcurOrder(order);\n    serverDataUpdate(dataIndex, order);\n  };\n\n  useEffect(() => {\n    serverDataUpdate();\n  }, []);\n\n\n\n  function beforeUpload() {\n    return new Promise(async (resolve, reject) => {\n      if (uploadFile.current.files.length > 0) {\n        const isLt20M =\n          (await uploadFile.current.files[0].size) / 1024 / 1024 < 20;\n\n        if (!isLt20M) {\n          Message.error('Image must smaller than 20MB!');\n          return reject();\n        }\n        resolve(isLt20M);\n      } else {\n        setParsed64('')\n      }\n    });\n  }\n\n  const handleFiles = async () => {\n    try {\n      await beforeUpload();\n      const files = [...parsed];\n      const data = await uploadFile.current.files[0];\n      // console.log(data)\n      files.push(data);\n      setParsed(files);\n\n      //轉Base64 上傳檔案後呈現沒有寫到DB\n      const reader = new FileReader();\n      reader.onload = function () {\n        let dataURL = reader.result;\n        setParsed64(dataURL);\n      };\n      reader.readAsDataURL(data);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n  const addCreateData = (key, value) => {\n    //-------Input OnChange Event\n    let obj = {};\n    obj[key] = value;\n\n    setWriteData({ ...writeData, ...obj });\n  };\n  const createSend = () => {\n    //-------Create Data 送出\n    if (editKey == true) { //Check is edit state\n\n\n      Swal.fire({\n        title: `確定修改此資料?`,\n        text: '請確認修改資料!!',\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#BEBEBE',\n        confirmButtonText: '確定',\n        cancelButtonText: '取消',\n      }).then((result) => {\n        if (result.isConfirmed) {\n\n          const data = currentPosts[editIndex];\n\n          let newObj = { ...data, ...writeData }\n\n          patchOrders(newObj)\n\n\n        }\n      });\n    } else {\n\n      Swal.fire({\n        title: `確定新增此資料?`,\n        text: '請確認資料填寫完整!!',\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#3085d6',\n        cancelButtonColor: '#BEBEBE',\n        confirmButtonText: '確定',\n        cancelButtonText: '取消',\n      }).then((result) => {\n        if (result.isConfirmed) {\n          createOrders();\n\n        }\n      });\n\n    }\n  };\n\n\n\n  const typeComponents = (e, type) => {\n    // Render Type Components\n    let element;\n    switch (type) {\n      case \"input\":\n        element = (\n          <Input\n            value={writeData[e]}\n            onChange={(value) => {\n              addCreateData(e, value);\n            }}\n            placeholder={e}\n          />\n        );\n        break;\n      case \"datePicker\":\n        element = (\n          <DatePicker\n            value={writeData[e]}\n            placeholder={e}\n            onChange={(value) => {\n              addCreateData(e, moment(value).format(\"YYYY-MM-DD\"));\n            }}\n          />\n        );\n        break;\n      case \"textArea\":\n        element = (\n          <Input.TextArea\n            value={writeData[e]}\n            placeholder={e}\n            maxLength={500}\n            rows={6}\n            hasLimitHint\n            aria-label=\"input max length 500\"\n            onChange={(value) => {\n              addCreateData(e, value);\n            }}\n          />\n        );\n        break;\n      case \"select\":\n        element = (\n          <Select\n            value={writeData[e]}\n            hasClear\n            style={{ width: '100%' }}\n            placeholder={e}\n            dataSource={props.categoryProps}\n            onChange={(value) => {\n              addCreateData(e, value);\n            }}\n          />\n        );\n        break;\n      case \"uploads\":\n        element = (\n          <>\n            <input\n              accept=\"image/png, image/jpeg, image/jpg\"\n              ref={uploadFile}\n              onChange={handleFiles}\n              type=\"file\"\n              id=\"file\"\n              name=\"files\"\n            // multiple\n            />\n            {editKey == true ?\n              <img\n                style={{ width: '50px', height: '50px' }}\n                src={`${parsed64.length > 0 ? parsed64 : currentPosts[editIndex].files}`}\n                alt=\"圖片\"\n              />\n\n              : null\n\n            }\n\n            {/* <img  src={`${parsed64.length > 0 ? parsed64 : ezconImg}`} alt=\"圖片\"></img> */}\n          </>);\n        break;\n      case \"multiSelect\":\n        element = (\n          <>\n            <Select\n              mode=\"multiple\"\n              value={writeData[e]}\n              showSearch\n              onChange={(value) => {\n                addCreateData(e, value);\n              }}\n              dataSource={props.venderNameProps}\n              style={{ width: '100%' }}\n            />\n\n          </>);\n        break;\n    }\n    return element;\n  };\n\n\n\n\n\n  function createOrders() {//Use orders create\n    funCreate({ ...writeData, stage: \"完成\" }).then((res) => {\n      Swal.fire('成功!', `此資料已新增`, 'success');\n      console.log('==create success:', res);\n      serverDataUpdate();\n      setWriteData({});\n      setParsed64('');\n      setEditKey(false);\n      setPopupState(false);\n    }).catch((error) => {\n      console.log('==create fail:', error);\n      // Message.error(`${err}`);\n    })\n\n  }\n\n  function patchPayOrders(data) {//Use pay money patch\n\n    Swal.fire({\n      title: `確設午餐錢繳交?`,\n      text: '麻煩再次確認金額哦～～',\n      icon: 'warning',\n      showCancelButton: true,\n      confirmButtonColor: '#3085d6',\n      cancelButtonColor: '#BEBEBE',\n      confirmButtonText: '確定',\n      cancelButtonText: '取消',\n    }).then((result) => {\n      if (result.isConfirmed) {\n        funUpdate(data._id, { pay:true }).then((res) => {\n          console.log('==update success:', res);\n          Swal.fire({\n            position: 'center',\n            icon: 'success',\n            title: '付錢成功',\n            showConfirmButton: false,\n            timer: 1500,\n          });\n          serverDataUpdate();\n          setWriteData({});\n          setParsed64('');\n          setEditKey(false);\n          setPopupState(false);\n        })\n          .catch((error) => {\n            console.log('==update fail:', error);\n            Message.success('付錢失敗');\n          });\n      }\n    });\n   \n\n  }\n\n  function patchOrders(data) {//Use orders patch\n    funUpdate(data._id, { ...data }).then((res) => {\n      console.log('==update success:', res);\n      Swal.fire({\n        position: 'center',\n        icon: 'success',\n        title: '編輯成功',\n        showConfirmButton: false,\n        timer: 1500,\n      });\n      serverDataUpdate();\n      setWriteData({});\n      setParsed64('');\n      setEditKey(false);\n      setPopupState(false);\n    })\n      .catch((error) => {\n        console.log('==update fail:', error);\n        Message.success('更新失敗');\n      });\n\n  }\n\n\n  function createUploads() {//Use uploads create\n    return new Promise(async (resolve, reject) => {\n      try {\n\n        const formData = new FormData();\n        Object.keys(writeData).forEach((eKey) => {\n\n          if (eKey == \"vendorName\") {\n            formData.append(\"vendorName\", JSON.stringify(writeData[eKey]));\n          } else {\n            formData.append(eKey, writeData[eKey]);\n          }\n        });\n        // formData.append('createdTime', new Date().toLocaleString());\n        // formData.append('updatedTime', new Date().toLocaleString());\n\n        if (uploadFile.current !== null && uploadFile.current.files && uploadFile.current.files.length > 0) {\n          formData.append('files', uploadFile.current.files[0]);\n        }\n\n        const Res = await axios(`http://localhost:3030/uploads`, {\n          method: 'POST',\n          headers: { authorization: window.localStorage['feathers-jwt'] },\n          data: formData\n        });\n\n        resolve(Res);\n      } catch (error) {\n        reject(error);\n      }\n    })\n\n  }\n\n  function patchUploads(data) {//Use uploads patch\n    return new Promise(async (resolve, reject) => {\n      try {\n        let patchUrl = `/uploads?type=${dbName}&id=${data._id}`\n        const formData = new FormData();\n\n        const passKeys = ['files', '_id'];//禁止FormData Patch add Key\n\n        Object.keys(data).forEach((eKey) => {\n\n          if (!passKeys.includes(eKey)) {\n            if (eKey == \"vendorName\") {\n              formData.append(\"vendorName\", JSON.stringify(writeData[eKey]));\n            } else {\n              formData.append(eKey, writeData[eKey]);\n            }\n          }\n        });\n\n        if (uploadFile.current.files.length > 0) {\n          formData.append('files', uploadFile.current.files[0]);\n        }\n        if (!uploadFile.current.files.length) {\n          patchUrl = `/uploads?type=${dbName}&id=${data._id}&img=keep`\n        }\n        console.log('rdy to PP:', formData);\n        const Res = await axios(patchUrl, {\n          method: 'PATCH',\n          headers: { authorization: window.localStorage['feathers-jwt'] },\n          data: formData\n        });\n\n        resolve(Res);\n      } catch (error) {\n        console.log('PP err:', error);\n        reject();\n      }\n    })\n  }\n\n\n\n\n\n\n  return (\n    <>\n      <Dialog\n\n        hasMask={false}\n        visible={popupState}\n        onOk={() => {\n          createSend();\n        }}\n        onCancel={() => {\n          setPopupState(false);\n          setEditKey(false);\n          setWriteData({});\n        }}\n        onClose={() => {\n          setPopupState(false);\n          setEditKey(false);\n          setWriteData({});\n        }}\n      >\n        {[...Object.keys(keys)].map((e, nb) => {\n          //-------Render Create Element\n          const type = keys[e].type;\n          if (keys[e].text == \"建立時間\" || keys[e].text == \"修改時間\" || keys[e].text == \"證照\") return \"\";\n          return <Fragment key={keys[e].text}>\n            <Form>\n\n              <Item label={keys[e].text} >\n                {typeComponents(e, type)}\n              </Item>\n\n            </Form>\n          </Fragment>;\n        })}\n      </Dialog>\n\n      <div >\n        <Button\n          type=\"primary\"\n          onClick={() => {\n            setPopupState(true);\n          }}\n        >\n          新增訂單\n                </Button>\n\n\n      </div>\n\n      {currentPosts && currentPosts.length > 0 ?\n\n        <Table dataSource={currentPosts} onSort={onTableSort}>\n          {[...Object.keys(keys)].map((list) => {\n            //  -------Render Table Data\n\n            if (list == \"files\") {\n              return <Table.Column width={200} key={keys[list].text} title={keys[list].text} cell={(record, index) => {\n\n                return (<>\n                  {currentPosts[index].files.length > 0 ?\n                    <img alt=\"No Data\" src={currentPosts[index].files} /> : null}\n\n                </>)\n              }\n              } />\n            } else if (list == \"createTime\") {\n              return <Table.Column sortable width={200} key={keys[list].text} title={keys[list].text} dataIndex={list} cell={(record, index) => {\n\n                return (<>\n                  {new Date(currentPosts[index].createTime).toLocaleString()}\n\n                </>)\n              }\n              } />\n            } else if (list == \"updateTime\") {\n              return <Table.Column sortable width={200} key={keys[list].text} title={keys[list].text} dataIndex={list} cell={(record, index) => {\n\n                return (<>\n                  {new Date(currentPosts[index].updateTime).toLocaleString()}\n\n                </>)\n              }\n              } />\n            } else if (list == \"vendorName\") {\n              return <Table.Column width={200} key={keys[list].text} title={keys[list].text} cell={(record, index) => {\n\n                return (<>\n                  {currentPosts[index].vendorName.length > 0 ?\n                    currentPosts[index].vendorName.map((list, index) => {\n\n                      return (\n                        <p key={index}>{list}</p>\n                      )\n\n                    })\n\n                    : null}\n\n                </>)\n              }\n              } />\n            } else if (list == \"vendorLicense\") {\n              return <Table.Column sortable width={200} key={keys[list].text} title={keys[list].text} cell={(record, index) => {\n\n                return (<>\n                  {currentPosts[index].vendorLicense.length > 0 ?\n                    currentPosts[index].vendorLicense.map((list, index) => {\n\n                      return (\n                        <p key={index}>{list.name}</p>\n                      )\n\n                    })\n\n                    : null}\n\n                </>)\n              }\n              } />\n            } else {\n              return <Table.Column sortable key={keys[list].text} title={keys[list].text} dataIndex={list} width={200} />\n            }\n\n          })}\n          <Table.Column\n            width={200}\n            title=\"操作\"\n            cell={(value, index, record) => {\n              // console.log(value, index, record)\n              return (\n                <div >\n                  <Button\n                    type=\"secondary\"\n                    onClick={() => {\n          \n                      patchPayOrders(record)\n                    }}\n                  >\n                    付錢\n                  </Button>\n                  <Button\n                    type=\"normal\"\n                    onClick={() => {\n                      setPopupState(true);\n                      setEditKey(true);\n                      setEditIndex(index);\n                      setWriteData({ ...currentPosts[index] });\n                    }}\n                  >\n                    編輯\n                                            </Button>\n\n                  <Button\n                    type=\"primary\"\n                    warning\n                    onClick={() => {\n                      const item = currentPosts[index];\n                      Swal.fire({\n                        title: `確定刪除此資料?`,\n                        text: '刪除後將無法復原!!',\n                        icon: 'warning',\n                        showCancelButton: true,\n                        confirmButtonColor: '#3085d6',\n                        cancelButtonColor: '#BEBEBE',\n                        confirmButtonText: '確定',\n                        cancelButtonText: '取消',\n                      }).then((result) => {\n                        if (result.isConfirmed) {\n                          Swal.fire('刪除!', `此資料已刪除`, 'success');\n                          funRemove(item._id).then(() => {\n                            const prePages =\n                              currentPage - 1 >= 0 ? currentPage - 1 : 0;\n                            if (\n                              props.listData.length - 1 <=\n                              prePages * postsPerPage\n                            ) {\n                              setCurrentPage(\n                                currentPage - 1 < 1 ? 1 : currentPage - 1\n                              );\n                            }\n\n                            serverDataUpdate();\n                          });\n                        }\n                      });\n                    }}\n                  >\n                    刪除\n                                     </Button>\n                </div>\n              );\n            }}\n          />\n        </Table>\n        : null}\n\n\n\n\n      <Pagination\n\n        total={props.listData.length}\n        pageSize={postsPerPage}\n        totalRender={(total) => `Total: ${total}`}\n        onChange={(pageNumber) => {\n          setCurrentPage(pageNumber);\n        }}\n      />\n\n\n    </>\n  );\n}\n\nexport default OrderTable;\n"]},"metadata":{},"sourceType":"module"}