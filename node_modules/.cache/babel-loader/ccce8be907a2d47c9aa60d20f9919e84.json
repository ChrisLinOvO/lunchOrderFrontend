{"ast":null,"code":"import _typeof from 'babel-runtime/helpers/typeof';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n/* eslint-disable valid-jsdoc */\n\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { polyfill } from 'react-lifecycles-compat';\nimport { func, obj, KEYCODE, env, str } from '../util';\nimport Tag from '../tag';\nimport Input from '../input';\nimport Icon from '../icon';\nimport zhCN from '../locale/zh-cn';\nimport Base from './base';\nimport { isNull, getValueDataSource, valueToSelectKey } from './util';\nvar bindCtx = func.bindCtx,\n    noop = func.noop;\nvar isIE9 = env.ieVersion === 9;\n/**\n * 无障碍化注意事项:\n * 1. Select 无搜索情况下，不应该让 Input 可focus，此时外层wrap必须可focus，并且需要相应focus事件让外边框发生变化\n *\n * TODO: hightLight 后续改造注意点\n * 1. hightLight 跟随点击变化(fixed) 2. 弹窗打开时根据 是否高亮第一个选项的 api开关设置是否hightLight 第一项\n */\n// 自定义弹层：1. 不需要关心Menu的点击事件 2. 不需要关心dataSource变化\n\n/**\n * Select\n */\n\nvar Select = (_temp = _class = function (_Base) {\n  _inherits(Select, _Base);\n\n  function Select(props) {\n    _classCallCheck(this, Select); // because dataSource maybe updated while select a item, so we should cache choosen value's item\n\n\n    var _this = _possibleConstructorReturn(this, _Base.call(this, props));\n\n    _this.handleWrapClick = function (e) {\n      // ignore click on input to choose text\n      if (e.target.nodeName !== 'INPUT') {\n        e.preventDefault();\n      }\n\n      _this.focusInput();\n    };\n\n    _this.handleArrowClick = function (e) {\n      e.preventDefault();\n\n      _this.focusInput(); // because of can not close Popup by click Input while hasSearch.\n      // so when Popup open and hasSearch, we should close Popup intentionally\n\n\n      _this.state.visible && _this.hasSearch() && _this.setVisible(false);\n    };\n\n    _this.handleClear = function (e) {\n      e.stopPropagation();\n\n      _this.handleChange(undefined, 'clear');\n    };\n\n    _this.valueDataSource = {\n      valueDS: [],\n      // [{value,label}]\n      mapValueDS: {} // {value: {value,label}}\n\n    };\n    var searchValue = 'searchValue' in props ? props.searchValue : '';\n\n    _this.dataStore.setOptions({\n      key: searchValue,\n      addonKey: props.mode === 'tag' // tag 模式手动输入的数据\n\n    });\n\n    _extends(_this.state, {\n      searchValue: searchValue,\n      dataSource: _this.setDataSource(props)\n    }); // 根据value和计算后的dataSource，更新value对应的详细数据valueDataSource\n\n\n    if (typeof _this.state.value !== 'undefined') {\n      _this.valueDataSource = getValueDataSource(_this.state.value, _this.valueDataSource.mapValueDS, _this.dataStore.getMapDS());\n    }\n\n    bindCtx(_this, ['handleMenuSelect', 'handleItemClick', 'handleSearch', 'handleSearchKeyDown', 'handleSelectAll', 'maxTagPlaceholder']);\n    return _this;\n  }\n\n  Select.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var state = {};\n\n    if ('value' in nextProps && nextProps.value !== prevState.value) {\n      _extends(state, {\n        value: nextProps.value\n      });\n    }\n\n    if ('highlightKey' in nextProps && nextProps.highlightKey !== prevState.highlightKey) {\n      _extends(state, {\n        highlightKey: nextProps.highlightKey\n      });\n    }\n\n    if ('searchValue' in nextProps && nextProps.searchValue !== prevState.searchValue) {\n      var searchValue = nextProps.searchValue;\n\n      _extends(state, {\n        searchValue: searchValue === undefined || searchValue === null ? '' : searchValue\n      });\n    }\n\n    if ('visible' in nextProps && nextProps.visible !== prevState.visible) {\n      _extends(state, {\n        visible: nextProps.visible\n      });\n    }\n\n    if (Object.keys(state).length) {\n      return state;\n    }\n\n    return null;\n  };\n\n  Select.prototype.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n    var props = this.props;\n\n    if ('searchValue' in props && this.state.searchValue !== prevState.searchValue) {\n      this.dataStore.setOptions({\n        key: this.state.searchValue\n      });\n    }\n\n    if (props.mode !== prevProps.mode) {\n      this.dataStore.setOptions({\n        addonKey: props.mode === 'tag'\n      });\n    }\n\n    if (props.mode !== prevProps.mode) {\n      this.dataStore.setOptions({\n        addonKey: props.mode === 'tag'\n      });\n    }\n\n    if (props.filter !== prevProps.filter) {\n      this.dataStore.setOptions({\n        filter: props.filter\n      });\n    }\n\n    if (props.filterLocal !== prevProps.filterLocal) {\n      this.dataStore.setOptions({\n        filterLocal: props.filterLocal\n      });\n    }\n\n    if (prevProps.children !== props.children || prevProps.dataSource !== props.dataSource) {\n      /* eslint-disable react/no-did-update-set-state */\n      this.setState({\n        dataSource: this.setDataSource(props)\n      });\n\n      if (!props.popupContent) {\n        this.setFirstHightLightKeyForMenu();\n      }\n    }\n\n    if ('value' in props) {\n      this.valueDataSource = getValueDataSource(props.value, this.valueDataSource.mapValueDS, this.dataStore.getMapDS());\n      this.updateSelectAllYet(this.valueDataSource.value);\n    } else if ('defaultValue' in props && props.defaultValue === this.valueDataSource.value && (props.children !== prevProps.children || props.dataSource !== prevProps.dataSource)) {\n      // has defaultValue and value not changed and dataSource changed\n      // fix: set defaultValue first, then update dataSource.\n      this.valueDataSource = getValueDataSource(props.defaultValue, this.valueDataSource.mapValueDS, this.dataStore.getMapDS());\n    }\n\n    if (prevProps.label !== this.props.label || prevState.value !== this.state.value || props.searchValue !== this.state.searchValue) {\n      this.syncWidth();\n    }\n  };\n\n  Select.prototype.componentDidMount = function componentDidMount() {\n    if (isIE9) {\n      this.ie9Hack();\n    }\n\n    _Base.prototype.componentDidMount.call(this);\n  }; // ie9 下 table-cell 布局不支持宽度超出隐藏\n\n\n  Select.prototype.ie9Hack = function ie9Hack() {\n    try {\n      var width = this.selectDOM.currentStyle.width;\n      this.setState({\n        fixWidth: width !== 'auto'\n      });\n    } catch (e) {//\n    }\n  };\n\n  Select.prototype.useDetailValue = function useDetailValue() {\n    var _props = this.props,\n        popupContent = _props.popupContent,\n        useDetailValue = _props.useDetailValue,\n        dataSource = _props.dataSource;\n    return useDetailValue || popupContent && !dataSource;\n  };\n\n  Select.prototype.hasSearch = function hasSearch() {\n    var _props2 = this.props,\n        showSearch = _props2.showSearch,\n        mode = _props2.mode;\n    return showSearch || mode === 'tag';\n  };\n\n  Select.prototype.getTagSize = function getTagSize() {\n    var _props3 = this.props,\n        size = _props3.size,\n        adjustTagSize = _props3.adjustTagSize;\n\n    if (adjustTagSize) {\n      return size;\n    }\n\n    return size === 'large' ? 'medium' : 'small';\n  };\n  /**\n   * Menu.Item onSelect\n   * @private\n   * @param  {Array<string>} keys\n   * @\n   */\n\n\n  Select.prototype.handleMenuSelect = function handleMenuSelect(keys, item) {\n    var _props4 = this.props,\n        mode = _props4.mode,\n        readOnly = _props4.readOnly,\n        disabled = _props4.disabled;\n\n    if (readOnly || disabled) {\n      return false;\n    }\n\n    var isSingle = mode === 'single';\n\n    if (isSingle) {\n      // 单选\n      return this.handleSingleSelect(keys[0], 'itemClick');\n    } else {\n      // 正常多选\n      return this.handleMultipleSelect(keys, 'itemClick', item.props && item.props._key);\n    }\n  };\n\n  Select.prototype.handleItemClick = function handleItemClick() {\n    if (!this.props.popupAutoFocus) {\n      this.focusInput();\n    }\n  };\n  /**\n   * 单选模式\n   */\n\n\n  Select.prototype.handleSingleSelect = function handleSingleSelect(key, triggerType) {\n    // TODO: 这里 cacheValue=false 有问题，dataSource 更新的时候就应该处理\n    var cacheValue = this.props.cacheValue; // get data only from dataStore while cacheValue=false\n\n    var itemObj = getValueDataSource(key, cacheValue ? this.valueDataSource.mapValueDS : {}, this.dataStore.getMapDS());\n    this.valueDataSource = itemObj;\n    this.setVisible(false, triggerType);\n\n    if (this.useDetailValue()) {\n      return this.handleChange(itemObj.valueDS, triggerType);\n    } else {\n      this.handleChange(itemObj.value, triggerType, itemObj.valueDS);\n    }\n\n    this.setState({\n      highlightKey: key\n    }); // 清空搜索\n\n    if (!('searchValue' in this.props) && this.state.searchValue) {\n      this.handleSearchClear(triggerType);\n    }\n  };\n  /**\n   * 多选模式 multiple/tag\n   */\n\n\n  Select.prototype.handleMultipleSelect = function handleMultipleSelect(keys, triggerType, key, keepSearchValue) {\n    var _this2 = this;\n\n    var itemObj = getValueDataSource(keys, this.valueDataSource.mapValueDS, this.dataStore.getMapDS());\n    var _props5 = this.props,\n        cacheValue = _props5.cacheValue,\n        mode = _props5.mode,\n        hiddenSelected = _props5.hiddenSelected; // cache those value maybe not exists in dataSource\n\n    if (cacheValue || mode === 'tag') {\n      this.valueDataSource = itemObj;\n    }\n\n    if (hiddenSelected) {\n      this.setVisible(false, triggerType);\n    } // 因为搜索后会设置 hightLight 为第一个item，menu渲染会自动滚动到 hightLight 的元素上面。\n    // 所以设置 hightLight 为当前选中项避免滚动\n\n\n    key && this.state.visible && this.setState({\n      highlightKey: key\n    });\n\n    if (this.useDetailValue()) {\n      this.handleChange(itemObj.valueDS, triggerType);\n    } else {\n      this.handleChange(itemObj.value, triggerType, itemObj.valueDS);\n    }\n\n    this.updateSelectAllYet(itemObj.value); // 清空搜索\n\n    if (!('searchValue' in this.props) && this.state.searchValue && !keepSearchValue) {\n      // 因为 SearchValue 被 clear 后会重新渲染 Menu，所以在 Overlay 检测 safeNode 的时候 e.target 可能会找不到导致弹窗关闭\n      setTimeout(function () {\n        _this2.handleSearchClear(triggerType);\n      });\n    }\n  };\n\n  Select.prototype.updateSelectAllYet = function updateSelectAllYet(value) {\n    var _this3 = this; // multiple mode\n    // is current state select all or not\n\n\n    this.selectAllYet = false;\n\n    if (this.props.hasSelectAll && Array.isArray(value)) {\n      var selectAllValues = this.dataStore.getEnableDS().map(function (item) {\n        return item.value;\n      });\n\n      if (selectAllValues.length <= value.length) {\n        this.selectAllYet = true;\n        selectAllValues.forEach(function (val) {\n          if (value.indexOf(val) === -1) {\n            _this3.selectAllYet = false;\n            return;\n          }\n        });\n      }\n    }\n  };\n\n  Select.prototype.handleSearchValue = function handleSearchValue(value) {\n    if (this.state.searchValue === value) {\n      return;\n    }\n\n    var filterLocal = this.props.filterLocal;\n\n    if (filterLocal) {\n      if (!('searchValue' in this.props)) {\n        this.setState({\n          searchValue: value,\n          dataSource: this.dataStore.updateByKey(value)\n        });\n        this.setFirstHightLightKeyForMenu();\n      }\n    } else if (!('searchValue' in this.props)) {\n      this.setState({\n        searchValue: value\n      });\n    }\n  };\n  /**\n   * Handle search input change event\n   * @param {String} value search text\n   * @param {Event} e change Event\n   */\n\n\n  Select.prototype.handleSearch = function handleSearch(value, e) {\n    this.handleSearchValue(value); // inputing should trigger popup open\n\n    if (!this.state.visible && value) {\n      this.setVisible(true);\n    }\n\n    this.props.onSearch(value, e);\n  };\n\n  Select.prototype.handleSearchClear = function handleSearchClear(triggerType) {\n    this.handleSearchValue('');\n    this.props.onSearchClear(triggerType);\n  }; // 搜索框 keyDown 事件\n\n\n  Select.prototype.handleSearchKeyDown = function handleSearchKeyDown(e) {\n    var _props6 = this.props,\n        popupContent = _props6.popupContent,\n        onKeyDown = _props6.onKeyDown,\n        showSearch = _props6.showSearch,\n        mode = _props6.mode,\n        hasClear = _props6.hasClear,\n        onToggleHighlightItem = _props6.onToggleHighlightItem,\n        readOnly = _props6.readOnly,\n        disabled = _props6.disabled;\n    var hasSearch = this.hasSearch();\n\n    if (popupContent) {\n      // 搜索的时候不阻止冒泡会无法输入\n      if (hasSearch && e.keyCode === KEYCODE.SPACE) {\n        e.stopPropagation();\n      }\n\n      return onKeyDown(e);\n    }\n\n    var proxy = 'search';\n\n    switch (e.keyCode) {\n      case KEYCODE.UP:\n        e.preventDefault();\n        onToggleHighlightItem(this.toggleHighlightItem(-1, e), 'up');\n        break;\n\n      case KEYCODE.DOWN:\n        e.preventDefault();\n        onToggleHighlightItem(this.toggleHighlightItem(1, e), 'down');\n        break;\n\n      case KEYCODE.ENTER:\n        e.preventDefault();\n\n        if (readOnly || disabled) {\n          break;\n        }\n\n        this.chooseHighlightItem(proxy, e);\n        break;\n\n      case KEYCODE.ESC:\n        e.preventDefault();\n        this.state.visible && this.setVisible(false, 'keyDown');\n        break;\n\n      case KEYCODE.SPACE:\n        e.stopPropagation();\n        !hasSearch && e.preventDefault();\n        break;\n\n      case KEYCODE.BACKSPACE:\n        if (readOnly || disabled) {\n          break;\n        }\n\n        if (mode === 'multiple' && showSearch || mode === 'tag') {\n          // 在多选并且有搜索的情况下，删除最后一个 tag\n          var valueDS = this.valueDataSource.valueDS;\n\n          if (valueDS && valueDS.length && !valueDS[valueDS.length - 1].disabled) {\n            this.handleDeleteTag(e);\n          }\n        } else if (mode === 'single' && hasClear && !this.state.visible) {\n          // 单选、非展开、并且可清除的情况，允许按删除键清除\n          this.handleClear(e);\n        }\n\n        break;\n\n      default:\n        break;\n    }\n\n    onKeyDown(e);\n  };\n\n  Select.prototype.chooseMultipleItem = function chooseMultipleItem(key) {\n    var value = this.state.value || [];\n    var keys = value.map(function (v) {\n      return valueToSelectKey(v);\n    });\n    var keepSearchValue = false;\n    var index = keys.map(function (v) {\n      return '' + v;\n    }).indexOf(key);\n\n    if (index > -1) {\n      // unselect\n      keys.splice(index, 1);\n      keepSearchValue = true; // 回车反选保留搜索值\n    } else {\n      // select\n      keys.push(key);\n    }\n\n    this.handleMultipleSelect(keys, 'enter', null, keepSearchValue);\n  }; // 回车 选择高亮的 item\n\n\n  Select.prototype.chooseHighlightItem = function chooseHighlightItem(proxy, e) {\n    var mode = this.props.mode;\n\n    if (!this.state.visible) {\n      // input tag by itself\n      if (mode === 'tag' && this.state.searchValue) {\n        this.chooseMultipleItem(this.state.searchValue);\n      }\n\n      return false;\n    }\n\n    var highlightKey = this.state.highlightKey; // 没有高亮选项 或者 没有可选菜单\n\n    if (highlightKey === null || !this.dataStore.getMenuDS().length) {\n      return;\n    }\n\n    if (mode === 'single') {\n      this.handleSingleSelect(highlightKey, 'enter');\n    } else {\n      this.chooseMultipleItem(highlightKey); // 阻止事件冒泡到最外层，让Popup 监听到触发弹层关闭\n\n      e && e.stopPropagation();\n    }\n  };\n  /**\n   * Handle Tag close event\n   * @param  {Object} item\n   * @return {Boolean} false  return false to prevent auto close\n   * ----\n   * It MUST be multiple mode, needn't additional judgement\n   */\n\n\n  Select.prototype.handleTagClose = function handleTagClose(item) {\n    var readOnly = this.props.readOnly;\n    if (readOnly) return false;\n\n    if (this.useDetailValue()) {\n      var value = this.state.value.filter(function (v) {\n        return item.value !== v.value;\n      });\n      this.handleChange(value, 'tag');\n    } else {\n      // filter out current item, and then call handleMenuSelect\n      var _value = this.state.value.filter(function (v) {\n        return item.value !== v;\n      });\n\n      this.handleMultipleSelect(_value, 'tag');\n    }\n\n    this.props.onRemove(item); // prevent tag close\n\n    return false;\n  }; // eslint-disable-next-line valid-jsdoc\n\n  /**\n   * Handle BACKSPACE key event\n   * @param {Event} e keyDown event\n   * ---\n   * It MUST be multiple mode\n   */\n\n\n  Select.prototype.handleDeleteTag = function handleDeleteTag(e) {\n    var value = this.state.value;\n    var searchValue = this.state.searchValue;\n\n    if (searchValue || !value || !value.length) {\n      return false;\n    }\n\n    e.preventDefault();\n    var nextValues = value.slice(0, value.length - 1); // 手动调用 handleMenuSelect 时直接传入原生的 value，可以减少 toString 的操作\n\n    if (this.useDetailValue()) {\n      this.handleChange(nextValues, 'tag');\n    } else {\n      this.handleMultipleSelect(nextValues, 'tag');\n    }\n  };\n  /**\n   * Handle SelectAll span click event\n   * @param {Event} e click event\n   */\n\n\n  Select.prototype.handleSelectAll = function handleSelectAll(e) {\n    e && e.preventDefault();\n    var nextValues = void 0;\n\n    if (this.selectAllYet) {\n      nextValues = [];\n    } else {\n      nextValues = this.dataStore.getEnableDS().map(function (item) {\n        return item.value;\n      });\n    } // 直接传 values，减少 toString 操作\n\n\n    this.handleMultipleSelect(nextValues, 'selectAll');\n  };\n\n  Select.prototype.handleVisibleChange = function handleVisibleChange(visible, type) {\n    this.setVisible(visible, type);\n  };\n\n  Select.prototype.afterClose = function afterClose() {\n    // 关闭的时候清空搜索值\n    if (this.hasSearch()) {\n      this.handleSearchClear('popupClose');\n    }\n  };\n\n  Select.prototype.maxTagPlaceholder = function maxTagPlaceholder(selectedValues, totalValues) {\n    var locale = this.props.locale;\n    return '' + str.template(locale.maxTagPlaceholder, {\n      selected: selectedValues.length,\n      total: totalValues.length\n    });\n  };\n  /**\n   * 如果用户是自定义的弹层，则直接以 value 为准，不再校验 dataSource\n   * TODO: 2.0 中 value 接受 string/object{value,label} 两种类型的数据，自动做识别，可以避免用户去转换，也和 date-picker 对齐\n   * 此外 onChange 第一个参数根据 api 来控制类型是 [string] 还是 [object{value,label}]\n   * @param {object} props\n   */\n\n\n  Select.prototype.renderValues = function renderValues() {\n    var _this4 = this;\n\n    var _props7 = this.props,\n        prefix = _props7.prefix,\n        mode = _props7.mode,\n        valueRender = _props7.valueRender,\n        fillProps = _props7.fillProps,\n        disabled = _props7.disabled,\n        maxTagCount = _props7.maxTagCount,\n        maxTagPlaceholder = _props7.maxTagPlaceholder,\n        tagInline = _props7.tagInline,\n        tagClosable = _props7.tagClosable;\n    var tagSize = this.getTagSize();\n    var value = this.state.value;\n\n    if (isNull(value)) {\n      return null;\n    } // get detail value\n\n\n    if (!this.useDetailValue()) {\n      if (value === this.valueDataSource.value) {\n        value = this.valueDataSource.valueDS;\n      } else {\n        value = getValueDataSource(value, this.valueDataSource.mapValueDS, this.dataStore.getMapDS()).valueDS;\n      }\n    }\n\n    if (mode === 'single') {\n      if (!value) {\n        return null;\n      }\n\n      var retvalue = fillProps && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && fillProps in value ? value[fillProps] : valueRender(value); // 0 => '0'\n\n      return typeof retvalue === 'number' ? retvalue.toString() : retvalue;\n    } else if (value) {\n      var limitedCountValue = value;\n      var maxTagPlaceholderEl = void 0;\n      var totalValue = this.dataStore.getFlattenDS();\n      var holder = 'maxTagPlaceholder' in this.props ? maxTagPlaceholder : this.maxTagPlaceholder;\n\n      if (maxTagCount !== undefined && value.length > maxTagCount && !tagInline) {\n        limitedCountValue = limitedCountValue.slice(0, maxTagCount);\n        maxTagPlaceholderEl = React.createElement(Tag, {\n          key: '_count',\n          type: 'primary',\n          size: tagSize,\n          animation: false\n        }, holder(value, totalValue));\n      }\n\n      if (value.length > 0 && tagInline) {\n        maxTagPlaceholderEl = React.createElement('div', {\n          className: prefix + 'select-tag-compact',\n          key: '_count'\n        }, holder(value, totalValue));\n      }\n\n      value = limitedCountValue;\n\n      if (!Array.isArray(value)) {\n        value = [value];\n      }\n\n      var selectedValueNodes = value.map(function (v) {\n        if (!v) {\n          return null;\n        }\n\n        var labelNode = fillProps ? v[fillProps] : valueRender(v);\n        return React.createElement(Tag, {\n          key: v.value,\n          disabled: disabled || v.disabled,\n          type: 'primary',\n          size: tagSize,\n          animation: false,\n          onClose: _this4.handleTagClose.bind(_this4, v),\n          closable: tagClosable\n        }, labelNode);\n      });\n\n      if (maxTagPlaceholderEl) {\n        if (tagInline) {\n          selectedValueNodes.unshift(maxTagPlaceholderEl);\n        } else {\n          selectedValueNodes.push(maxTagPlaceholderEl);\n        }\n      }\n\n      return selectedValueNodes;\n    }\n\n    return null;\n  };\n  /**\n   * 1. fix flash while click <label/>\n   * 2. fix onBlur while has clear\n   * @returns\n   */\n\n\n  Select.prototype.hasClear = function hasClear() {\n    var _props8 = this.props,\n        hasClear = _props8.hasClear,\n        readOnly = _props8.readOnly,\n        disabled = _props8.disabled,\n        showSearch = _props8.showSearch;\n    var _state = this.state,\n        value = _state.value,\n        visible = _state.visible;\n    return typeof value !== 'undefined' && value !== null && hasClear && !readOnly && !disabled && !(showSearch && visible);\n  };\n  /**\n   * render arrow\n   * @param {object} props\n   * @param {function} [clickHandler]\n   */\n\n\n  Select.prototype.renderExtraNode = function renderExtraNode() {\n    var _props9 = this.props,\n        hasArrow = _props9.hasArrow,\n        hasClear = _props9.hasClear,\n        prefix = _props9.prefix;\n    var ret = [];\n\n    if (hasArrow) {\n      ret.push(React.createElement('span', {\n        key: 'arrow',\n        'aria-hidden': true,\n        onClick: this.handleArrowClick,\n        className: prefix + 'select-arrow'\n      }, React.createElement(Icon, {\n        type: 'arrow-down',\n        className: prefix + 'select-symbol-fold'\n      })));\n    } // do not use this.hasClear() here, to make sure clear btn always exists, can not influenced by apis like `disabled` `readOnly`\n\n\n    if (hasClear) {\n      ret.push(React.createElement('span', {\n        key: 'clear',\n        'aria-hidden': true,\n        onClick: this.handleClear,\n        className: prefix + 'select-clear'\n      }, React.createElement(Icon, {\n        type: 'delete-filling'\n      })));\n    }\n\n    return ret;\n  };\n  /**\n   * 选择器\n   * @override\n   * @param {object} props\n   */\n\n\n  Select.prototype.renderSelect = function renderSelect() {\n    var _classNames,\n        _this5 = this;\n\n    var _props10 = this.props,\n        prefix = _props10.prefix,\n        showSearch = _props10.showSearch,\n        placeholder = _props10.placeholder,\n        mode = _props10.mode,\n        size = _props10.size,\n        className = _props10.className,\n        style = _props10.style,\n        readOnly = _props10.readOnly,\n        disabled = _props10.disabled,\n        hasBorder = _props10.hasBorder,\n        label = _props10.label,\n        locale = _props10.locale,\n        state = _props10.state,\n        onBlur = _props10.onBlur,\n        onFocus = _props10.onFocus,\n        onMouseEnter = _props10.onMouseEnter,\n        onMouseLeave = _props10.onMouseLeave,\n        rtl = _props10.rtl;\n    var others = obj.pickOthers(Select.propTypes, this.props);\n    var othersData = obj.pickAttrsWith(others, 'data-');\n    var visible = this.state.visible;\n    var isSingle = mode === 'single';\n    var hasSearch = this.hasSearch();\n    var valueNodes = this.renderValues(); // compatible with selectPlaceHolder. TODO: removed in 2.0 version\n\n    var _placeholder = placeholder || locale.selectPlaceholder || locale.selectPlaceHolder;\n\n    if (valueNodes && valueNodes.length) {\n      _placeholder = null;\n    } // 弹窗展开时将当前的值作为 placeholder，这个功能的前提是 valueNode 必须是一个字符串\n\n\n    if (showSearch && visible && isSingle && typeof valueNodes === 'string') {\n      _placeholder = valueNodes;\n    } // 下拉箭头\n\n\n    var extra = this.renderExtraNode();\n    var triggerClazz = classNames([prefix + 'select', prefix + 'select-trigger', prefix + 'select-' + mode, '' + prefix + size, className], (_classNames = {}, _classNames[prefix + 'active'] = visible, _classNames[prefix + 'inactive'] = !visible, _classNames[prefix + 'no-search'] = !hasSearch, _classNames[prefix + 'has-search'] = hasSearch, _classNames[prefix + 'select-in-ie'] = isIE9, _classNames[prefix + 'select-in-ie-fixwidth'] = this.state.fixWidth, _classNames[prefix + 'has-clear'] = this.hasClear(), _classNames));\n    var valuetext = this.valueDataSource.valueDS ? this.valueDataSource.valueDS.label : '';\n    return React.createElement('span', _extends({}, othersData, {\n      className: triggerClazz,\n      style: style,\n      dir: rtl ? 'rtl' : undefined,\n      ref: this.saveSelectRef,\n      onClick: this.handleWrapClick,\n      onMouseEnter: onMouseEnter,\n      onMouseLeave: onMouseLeave,\n      onMouseDown: this.handleWrapClick\n    }), React.createElement(Input, _extends({\n      'aria-valuetext': valuetext\n    }, obj.pickOthers(othersData, others), {\n      role: 'combobox',\n      tabIndex: 0,\n      'aria-expanded': this.state.visible,\n      'aria-disabled': disabled,\n      state: state,\n      label: label,\n      extra: extra,\n      value: this.state.searchValue,\n      size: size,\n      readOnly: !this.hasSearch() || readOnly,\n      disabled: disabled,\n      placeholder: _placeholder,\n      hasBorder: hasBorder,\n      hasClear: false,\n      htmlSize: '1',\n      inputRender: function inputRender(inputEl) {\n        return _this5.renderSearchInput(valueNodes, _placeholder, inputEl);\n      },\n      onChange: this.handleSearch,\n      onKeyDown: this.handleSearchKeyDown,\n      onFocus: onFocus,\n      onBlur: onBlur,\n      className: prefix + 'select-inner',\n      ref: this.saveInputRef\n    })), React.createElement('span', {\n      className: prefix + 'sr-only',\n      'aria-live': 'polite'\n    }, this.state.srReader));\n  };\n\n  Select.prototype.renderSearchInput = function renderSearchInput(valueNodes, placeholder, inputEl) {\n    var _classNames2;\n\n    var _props11 = this.props,\n        prefix = _props11.prefix,\n        mode = _props11.mode,\n        tagInline = _props11.tagInline;\n    var isSingle = mode === 'single';\n    var mirrorText = this.state.searchValue;\n    var cls = classNames((_classNames2 = {}, _classNames2[prefix + 'select-values'] = true, _classNames2[prefix + 'input-text-field'] = true, _classNames2[prefix + 'select-compact'] = !isSingle && tagInline, _classNames2));\n    var title = typeof valueNodes === 'string' ? valueNodes : '';\n    var searchInput = [isSingle && valueNodes ? React.createElement('em', {\n      title: title,\n      key: 'select-value'\n    }, valueNodes) : valueNodes];\n    var triggerSearch = React.createElement('span', {\n      key: 'trigger-search',\n      className: prefix + 'select-trigger-search'\n    }, inputEl, React.createElement('span', {\n      'aria-hidden': true\n    }, React.createElement('span', null, mirrorText || placeholder), React.createElement('span', null, '\\xA0')));\n\n    if (!isSingle && tagInline) {\n      searchInput.unshift(triggerSearch);\n    } else {\n      searchInput.push(triggerSearch);\n    }\n\n    return React.createElement('span', {\n      className: cls\n    }, searchInput);\n  };\n  /**\n   * 渲染弹层的 header 内容\n   * @override\n   * @param {object} props\n   */\n\n\n  Select.prototype.renderMenuHeader = function renderMenuHeader() {\n    var _classNames3, _classNames4;\n\n    var _props12 = this.props,\n        prefix = _props12.prefix,\n        hasSelectAll = _props12.hasSelectAll,\n        mode = _props12.mode,\n        locale = _props12.locale,\n        menuProps = _props12.menuProps;\n\n    if (menuProps && 'header' in menuProps) {\n      return menuProps.header;\n    }\n\n    var sourceCount = this.dataStore.getEnableDS().length; // 多选模式下才有全选\n\n    if (!hasSelectAll || mode === 'single' || !sourceCount) {\n      return null;\n    }\n\n    var text = typeof hasSelectAll === 'boolean' ? locale.selectAll : hasSelectAll;\n    var selectAllYet = this.selectAllYet;\n    var cls = classNames((_classNames3 = {}, _classNames3[prefix + 'select-all'] = true, _classNames3[prefix + 'selected'] = selectAllYet, _classNames3));\n    var clsInner = classNames((_classNames4 = {}, _classNames4[prefix + 'select-all-inner'] = true, _classNames4)); // remove style={{'lineHeight': 'unset'}} in next Y\n    // remove style={{'display': 'none'}} in next Y\n\n    return React.createElement('div', {\n      key: 'all',\n      onClick: this.handleSelectAll,\n      className: cls,\n      style: {\n        lineHeight: 'unset'\n      }\n    }, selectAllYet ? React.createElement(Icon, {\n      className: prefix + 'menu-icon-selected',\n      style: {\n        display: 'none'\n      },\n      type: 'select'\n    }) : null, React.createElement('span', {\n      className: clsInner\n    }, text));\n  };\n\n  Select.prototype.render = function render() {\n    var mode = this.props.mode;\n\n    var props = _extends({}, this.props); // forbid to close Popup by click Input while hasSearch\n\n\n    if (this.hasSearch()) {\n      props.canCloseByTrigger = false;\n    }\n\n    if (mode === 'single') {\n      props.cache = true;\n    }\n\n    return _Base.prototype.render.call(this, props);\n  };\n\n  return Select;\n}(Base), _class.propTypes = _extends({}, Base.propTypes, {\n  /**\n   * 选择器模式\n   */\n  mode: PropTypes.oneOf(['single', 'multiple', 'tag']),\n\n  /**\n   * 当前值，用于受控模式\n   */\n  value: PropTypes.any,\n\n  /**\n   * 初始的默认值\n   */\n  defaultValue: PropTypes.any,\n\n  /**\n   * Select发生改变时触发的回调\n   * @param {*} value 选中的值\n   * @param {String} actionType 触发的方式, 'itemClick', 'enter', 'tag'\n   * @param {*} item 选中的值的对象数据 (useDetailValue=false有效)\n   */\n  onChange: PropTypes.func,\n\n  /**\n   * 传入的数据源，可以动态渲染子项，详见 [dataSource的使用](#dataSource的使用)\n   */\n  dataSource: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.shape({\n    value: PropTypes.any,\n    label: PropTypes.any,\n    disabled: PropTypes.bool,\n    children: PropTypes.array\n  }), PropTypes.bool, PropTypes.number, PropTypes.string])),\n\n  /**\n   * 是否有边框\n   */\n  hasBorder: PropTypes.bool,\n\n  /**\n   * 是否有下拉箭头\n   */\n  hasArrow: PropTypes.bool,\n\n  /**\n   * 展开后是否能搜索（tag 模式下固定为true）\n   */\n  showSearch: PropTypes.bool,\n\n  /**\n   * 当搜索框值变化时回调\n   * @param {String} value 数据\n   */\n  onSearch: PropTypes.func,\n\n  /**\n   * 当搜索框值被(选择、弹窗关闭)导致清空时候的回调\n   * @param {String} actionType 触发的方式, 'select'(选择清空), 'popupClose'(弹窗关闭清空)\n   */\n  onSearchClear: PropTypes.func,\n\n  /**\n   * 多选模式下是否有全选功能\n   */\n  hasSelectAll: PropTypes.oneOfType([PropTypes.bool, PropTypes.string]),\n\n  /**\n   * 填充到选择框里的值的 key\b\b\n   */\n  fillProps: PropTypes.string,\n\n  /**\n   * value 使用对象类型 `{value, label}`, 同时 onChange 第一个参数返回也修改为 dataSource 中的对象\n   */\n  useDetailValue: PropTypes.bool,\n\n  /**\n   * dataSource 变化的时是否保留已选的内容\n   */\n  cacheValue: PropTypes.bool,\n\n  /**\n   * 渲染 Select 展现内容的方法\n   * @param {Object} item 渲染节点的item\n   * @return {ReactNode} 展现内容\n   * @default item => `item.label || item.value`\n   */\n  valueRender: PropTypes.func,\n\n  /**\n   * 渲染 MenuItem 内容的方法\n   * @param {Object} item 渲染节点的item\n   * @param {String} searchValue 搜索关键字（如果开启搜索）\n   * @return {ReactNode} item node\n   */\n  itemRender: PropTypes.func,\n\n  /**\n   * 弹层内容为空的文案\n   */\n  notFoundContent: PropTypes.node,\n  style: PropTypes.object,\n\n  /**\n   * 受控搜索值，一般不需要设置\n   * @type {[type]}\n   */\n  searchValue: PropTypes.string,\n\n  /**\n   * 是否一行显示，仅在 mode 为 multiple 的时候生效\n   * @version 1.15\n   */\n  tagInline: PropTypes.bool,\n\n  /**\n   * tag 是否可关闭\n   * @version 1.20\n   */\n  tagClosable: PropTypes.bool,\n\n  /**\n   * tag 尺寸是否和 select 保持一致(mode=multiple/tag 模式生效），默认false\n   * @version 1.24\n   */\n  adjustTagSize: PropTypes.bool,\n\n  /**\n   * 最多显示多少个 tag\n   * @version 1.15\n   */\n  maxTagCount: PropTypes.number,\n\n  /**\n   * 隐藏多余 tag 时显示的内容，在 maxTagCount 生效时起作用\n   * @param {object} selectedValues 当前已选中的元素\n   * @param {object} totalValues 总待选元素\n   * @version 1.15\n   */\n  maxTagPlaceholder: PropTypes.func,\n\n  /**\n   * 选择后是否立即隐藏菜单 (mode=multiple/tag 模式生效)\n   */\n  hiddenSelected: PropTypes.bool,\n\n  /**\n   * tag 删除回调\n   * @param {object} item 渲染节点的item\n   */\n  onRemove: PropTypes.func,\n\n  /**\n   * 焦点事件\n   */\n  onFocus: PropTypes.func,\n\n  /**\n   * 是否自动高亮第一个选项\n   */\n  // highlightFirstItem: PropTypes.bool,\n\n  /**\n   * 失去焦点事件\n   */\n  onBlur: PropTypes.func,\n  onMouseEnter: PropTypes.func,\n  onMouseLeave: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  locale: PropTypes.object,\n\n  /**\n   * 展开下拉菜单时是否自动焦点到弹层\n   */\n  popupAutoFocus: PropTypes.bool,\n\n  /**\n   * 是否展示 dataSource 中 children\n   */\n  showDataSourceChildren: PropTypes.bool\n}), _class.defaultProps = _extends({}, Base.defaultProps, {\n  locale: zhCN.Select,\n  mode: 'single',\n  showSearch: false,\n  cacheValue: true,\n  tagInline: false,\n  adjustTagSize: false,\n  onSearch: noop,\n  onSearchClear: noop,\n  hasArrow: true,\n  onRemove: noop,\n  // highlightFirstItem: true,\n  valueRender: function valueRender(item) {\n    return item.label || item.value;\n  },\n  onKeyDown: noop,\n  onFocus: noop,\n  onBlur: noop,\n  onMouseEnter: noop,\n  onMouseLeave: noop,\n  popupAutoFocus: false,\n  tagClosable: true\n}), _class.displayName = 'Select', _temp);\nexport default polyfill(Select);","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/node_modules/@alifd/next/es/select/select.js"],"names":["_typeof","_extends","_classCallCheck","_possibleConstructorReturn","_inherits","_class","_temp","React","PropTypes","classNames","polyfill","func","obj","KEYCODE","env","str","Tag","Input","Icon","zhCN","Base","isNull","getValueDataSource","valueToSelectKey","bindCtx","noop","isIE9","ieVersion","Select","_Base","props","_this","call","handleWrapClick","e","target","nodeName","preventDefault","focusInput","handleArrowClick","state","visible","hasSearch","setVisible","handleClear","stopPropagation","handleChange","undefined","valueDataSource","valueDS","mapValueDS","searchValue","dataStore","setOptions","key","addonKey","mode","dataSource","setDataSource","value","getMapDS","getDerivedStateFromProps","nextProps","prevState","highlightKey","Object","keys","length","prototype","componentDidUpdate","prevProps","filter","filterLocal","children","setState","popupContent","setFirstHightLightKeyForMenu","updateSelectAllYet","defaultValue","label","syncWidth","componentDidMount","ie9Hack","width","selectDOM","currentStyle","fixWidth","useDetailValue","_props","_props2","showSearch","getTagSize","_props3","size","adjustTagSize","handleMenuSelect","item","_props4","readOnly","disabled","isSingle","handleSingleSelect","handleMultipleSelect","_key","handleItemClick","popupAutoFocus","triggerType","cacheValue","itemObj","handleSearchClear","keepSearchValue","_this2","_props5","hiddenSelected","setTimeout","_this3","selectAllYet","hasSelectAll","Array","isArray","selectAllValues","getEnableDS","map","forEach","val","indexOf","handleSearchValue","updateByKey","handleSearch","onSearch","onSearchClear","handleSearchKeyDown","_props6","onKeyDown","hasClear","onToggleHighlightItem","keyCode","SPACE","proxy","UP","toggleHighlightItem","DOWN","ENTER","chooseHighlightItem","ESC","BACKSPACE","handleDeleteTag","chooseMultipleItem","v","index","splice","push","getMenuDS","handleTagClose","_value","onRemove","nextValues","slice","handleSelectAll","handleVisibleChange","type","afterClose","maxTagPlaceholder","selectedValues","totalValues","locale","template","selected","total","renderValues","_this4","_props7","prefix","valueRender","fillProps","maxTagCount","tagInline","tagClosable","tagSize","retvalue","toString","limitedCountValue","maxTagPlaceholderEl","totalValue","getFlattenDS","holder","createElement","animation","className","selectedValueNodes","labelNode","onClose","bind","closable","unshift","_props8","_state","renderExtraNode","_props9","hasArrow","ret","onClick","renderSelect","_classNames","_this5","_props10","placeholder","style","hasBorder","onBlur","onFocus","onMouseEnter","onMouseLeave","rtl","others","pickOthers","propTypes","othersData","pickAttrsWith","valueNodes","_placeholder","selectPlaceholder","selectPlaceHolder","extra","triggerClazz","valuetext","dir","ref","saveSelectRef","onMouseDown","role","tabIndex","htmlSize","inputRender","inputEl","renderSearchInput","onChange","saveInputRef","srReader","_classNames2","_props11","mirrorText","cls","title","searchInput","triggerSearch","renderMenuHeader","_classNames3","_classNames4","_props12","menuProps","header","sourceCount","text","selectAll","clsInner","lineHeight","display","render","canCloseByTrigger","cache","oneOf","any","arrayOf","oneOfType","shape","bool","array","number","string","itemRender","notFoundContent","node","object","showDataSourceChildren","defaultProps","displayName"],"mappings":"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","sourcesContent":["import _typeof from 'babel-runtime/helpers/typeof';\nimport _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp;\n\n/* eslint-disable valid-jsdoc */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { polyfill } from 'react-lifecycles-compat';\n\nimport { func, obj, KEYCODE, env, str } from '../util';\nimport Tag from '../tag';\nimport Input from '../input';\nimport Icon from '../icon';\nimport zhCN from '../locale/zh-cn';\nimport Base from './base';\nimport { isNull, getValueDataSource, valueToSelectKey } from './util';\n\nvar bindCtx = func.bindCtx,\n    noop = func.noop;\n\nvar isIE9 = env.ieVersion === 9;\n\n/**\n * 无障碍化注意事项:\n * 1. Select 无搜索情况下，不应该让 Input 可focus，此时外层wrap必须可focus，并且需要相应focus事件让外边框发生变化\n *\n * TODO: hightLight 后续改造注意点\n * 1. hightLight 跟随点击变化(fixed) 2. 弹窗打开时根据 是否高亮第一个选项的 api开关设置是否hightLight 第一项\n */\n\n// 自定义弹层：1. 不需要关心Menu的点击事件 2. 不需要关心dataSource变化\n\n/**\n * Select\n */\nvar Select = (_temp = _class = function (_Base) {\n    _inherits(Select, _Base);\n\n    function Select(props) {\n        _classCallCheck(this, Select);\n\n        // because dataSource maybe updated while select a item, so we should cache choosen value's item\n        var _this = _possibleConstructorReturn(this, _Base.call(this, props));\n\n        _this.handleWrapClick = function (e) {\n            // ignore click on input to choose text\n            if (e.target.nodeName !== 'INPUT') {\n                e.preventDefault();\n            }\n            _this.focusInput();\n        };\n\n        _this.handleArrowClick = function (e) {\n            e.preventDefault();\n            _this.focusInput();\n\n            // because of can not close Popup by click Input while hasSearch.\n            // so when Popup open and hasSearch, we should close Popup intentionally\n            _this.state.visible && _this.hasSearch() && _this.setVisible(false);\n        };\n\n        _this.handleClear = function (e) {\n            e.stopPropagation();\n            _this.handleChange(undefined, 'clear');\n        };\n\n        _this.valueDataSource = {\n            valueDS: [], // [{value,label}]\n            mapValueDS: {} // {value: {value,label}}\n        };\n\n        var searchValue = 'searchValue' in props ? props.searchValue : '';\n\n        _this.dataStore.setOptions({\n            key: searchValue,\n            addonKey: props.mode === 'tag' // tag 模式手动输入的数据\n        });\n\n        _extends(_this.state, {\n            searchValue: searchValue,\n            dataSource: _this.setDataSource(props)\n        });\n\n        // 根据value和计算后的dataSource，更新value对应的详细数据valueDataSource\n        if (typeof _this.state.value !== 'undefined') {\n            _this.valueDataSource = getValueDataSource(_this.state.value, _this.valueDataSource.mapValueDS, _this.dataStore.getMapDS());\n        }\n\n        bindCtx(_this, ['handleMenuSelect', 'handleItemClick', 'handleSearch', 'handleSearchKeyDown', 'handleSelectAll', 'maxTagPlaceholder']);\n        return _this;\n    }\n\n    Select.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n        var state = {};\n\n        if ('value' in nextProps && nextProps.value !== prevState.value) {\n            _extends(state, {\n                value: nextProps.value\n            });\n        }\n\n        if ('highlightKey' in nextProps && nextProps.highlightKey !== prevState.highlightKey) {\n            _extends(state, {\n                highlightKey: nextProps.highlightKey\n            });\n        }\n\n        if ('searchValue' in nextProps && nextProps.searchValue !== prevState.searchValue) {\n            var searchValue = nextProps.searchValue;\n            _extends(state, {\n                searchValue: searchValue === undefined || searchValue === null ? '' : searchValue\n            });\n        }\n\n        if ('visible' in nextProps && nextProps.visible !== prevState.visible) {\n            _extends(state, {\n                visible: nextProps.visible\n            });\n        }\n\n        if (Object.keys(state).length) {\n            return state;\n        }\n\n        return null;\n    };\n\n    Select.prototype.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n        var props = this.props;\n        if ('searchValue' in props && this.state.searchValue !== prevState.searchValue) {\n            this.dataStore.setOptions({ key: this.state.searchValue });\n        }\n\n        if (props.mode !== prevProps.mode) {\n            this.dataStore.setOptions({\n                addonKey: props.mode === 'tag'\n            });\n        }\n        if (props.mode !== prevProps.mode) {\n            this.dataStore.setOptions({\n                addonKey: props.mode === 'tag'\n            });\n        }\n        if (props.filter !== prevProps.filter) {\n            this.dataStore.setOptions({\n                filter: props.filter\n            });\n        }\n        if (props.filterLocal !== prevProps.filterLocal) {\n            this.dataStore.setOptions({\n                filterLocal: props.filterLocal\n            });\n        }\n\n        if (prevProps.children !== props.children || prevProps.dataSource !== props.dataSource) {\n            /* eslint-disable react/no-did-update-set-state */\n            this.setState({\n                dataSource: this.setDataSource(props)\n            });\n\n            if (!props.popupContent) {\n                this.setFirstHightLightKeyForMenu();\n            }\n        }\n\n        if ('value' in props) {\n            this.valueDataSource = getValueDataSource(props.value, this.valueDataSource.mapValueDS, this.dataStore.getMapDS());\n            this.updateSelectAllYet(this.valueDataSource.value);\n        } else if ('defaultValue' in props && props.defaultValue === this.valueDataSource.value && (props.children !== prevProps.children || props.dataSource !== prevProps.dataSource)) {\n            // has defaultValue and value not changed and dataSource changed\n            // fix: set defaultValue first, then update dataSource.\n            this.valueDataSource = getValueDataSource(props.defaultValue, this.valueDataSource.mapValueDS, this.dataStore.getMapDS());\n        }\n\n        if (prevProps.label !== this.props.label || prevState.value !== this.state.value || props.searchValue !== this.state.searchValue) {\n            this.syncWidth();\n        }\n    };\n\n    Select.prototype.componentDidMount = function componentDidMount() {\n        if (isIE9) {\n            this.ie9Hack();\n        }\n        _Base.prototype.componentDidMount.call(this);\n    };\n\n    // ie9 下 table-cell 布局不支持宽度超出隐藏\n\n\n    Select.prototype.ie9Hack = function ie9Hack() {\n        try {\n            var width = this.selectDOM.currentStyle.width;\n            this.setState({\n                fixWidth: width !== 'auto'\n            });\n        } catch (e) {\n            //\n        }\n    };\n\n    Select.prototype.useDetailValue = function useDetailValue() {\n        var _props = this.props,\n            popupContent = _props.popupContent,\n            useDetailValue = _props.useDetailValue,\n            dataSource = _props.dataSource;\n\n        return useDetailValue || popupContent && !dataSource;\n    };\n\n    Select.prototype.hasSearch = function hasSearch() {\n        var _props2 = this.props,\n            showSearch = _props2.showSearch,\n            mode = _props2.mode;\n\n        return showSearch || mode === 'tag';\n    };\n\n    Select.prototype.getTagSize = function getTagSize() {\n        var _props3 = this.props,\n            size = _props3.size,\n            adjustTagSize = _props3.adjustTagSize;\n\n        if (adjustTagSize) {\n            return size;\n        }\n        return size === 'large' ? 'medium' : 'small';\n    };\n\n    /**\n     * Menu.Item onSelect\n     * @private\n     * @param  {Array<string>} keys\n     * @\n     */\n\n\n    Select.prototype.handleMenuSelect = function handleMenuSelect(keys, item) {\n        var _props4 = this.props,\n            mode = _props4.mode,\n            readOnly = _props4.readOnly,\n            disabled = _props4.disabled;\n\n\n        if (readOnly || disabled) {\n            return false;\n        }\n\n        var isSingle = mode === 'single';\n\n        if (isSingle) {\n            // 单选\n            return this.handleSingleSelect(keys[0], 'itemClick');\n        } else {\n            // 正常多选\n            return this.handleMultipleSelect(keys, 'itemClick', item.props && item.props._key);\n        }\n    };\n\n    Select.prototype.handleItemClick = function handleItemClick() {\n        if (!this.props.popupAutoFocus) {\n            this.focusInput();\n        }\n    };\n\n    /**\n     * 单选模式\n     */\n\n\n    Select.prototype.handleSingleSelect = function handleSingleSelect(key, triggerType) {\n        // TODO: 这里 cacheValue=false 有问题，dataSource 更新的时候就应该处理\n        var cacheValue = this.props.cacheValue;\n        // get data only from dataStore while cacheValue=false\n\n        var itemObj = getValueDataSource(key, cacheValue ? this.valueDataSource.mapValueDS : {}, this.dataStore.getMapDS());\n        this.valueDataSource = itemObj;\n\n        this.setVisible(false, triggerType);\n\n        if (this.useDetailValue()) {\n            return this.handleChange(itemObj.valueDS, triggerType);\n        } else {\n            this.handleChange(itemObj.value, triggerType, itemObj.valueDS);\n        }\n\n        this.setState({\n            highlightKey: key\n        });\n\n        // 清空搜索\n        if (!('searchValue' in this.props) && this.state.searchValue) {\n            this.handleSearchClear(triggerType);\n        }\n    };\n\n    /**\n     * 多选模式 multiple/tag\n     */\n\n\n    Select.prototype.handleMultipleSelect = function handleMultipleSelect(keys, triggerType, key, keepSearchValue) {\n        var _this2 = this;\n\n        var itemObj = getValueDataSource(keys, this.valueDataSource.mapValueDS, this.dataStore.getMapDS());\n\n        var _props5 = this.props,\n            cacheValue = _props5.cacheValue,\n            mode = _props5.mode,\n            hiddenSelected = _props5.hiddenSelected;\n\n        // cache those value maybe not exists in dataSource\n\n        if (cacheValue || mode === 'tag') {\n            this.valueDataSource = itemObj;\n        }\n\n        if (hiddenSelected) {\n            this.setVisible(false, triggerType);\n        }\n\n        // 因为搜索后会设置 hightLight 为第一个item，menu渲染会自动滚动到 hightLight 的元素上面。\n        // 所以设置 hightLight 为当前选中项避免滚动\n        key && this.state.visible && this.setState({\n            highlightKey: key\n        });\n\n        if (this.useDetailValue()) {\n            this.handleChange(itemObj.valueDS, triggerType);\n        } else {\n            this.handleChange(itemObj.value, triggerType, itemObj.valueDS);\n        }\n\n        this.updateSelectAllYet(itemObj.value);\n\n        // 清空搜索\n        if (!('searchValue' in this.props) && this.state.searchValue && !keepSearchValue) {\n            // 因为 SearchValue 被 clear 后会重新渲染 Menu，所以在 Overlay 检测 safeNode 的时候 e.target 可能会找不到导致弹窗关闭\n            setTimeout(function () {\n                _this2.handleSearchClear(triggerType);\n            });\n        }\n    };\n\n    Select.prototype.updateSelectAllYet = function updateSelectAllYet(value) {\n        var _this3 = this;\n\n        // multiple mode\n        // is current state select all or not\n        this.selectAllYet = false;\n        if (this.props.hasSelectAll && Array.isArray(value)) {\n            var selectAllValues = this.dataStore.getEnableDS().map(function (item) {\n                return item.value;\n            });\n\n            if (selectAllValues.length <= value.length) {\n                this.selectAllYet = true;\n\n                selectAllValues.forEach(function (val) {\n                    if (value.indexOf(val) === -1) {\n                        _this3.selectAllYet = false;\n                        return;\n                    }\n                });\n            }\n        }\n    };\n\n    Select.prototype.handleSearchValue = function handleSearchValue(value) {\n        if (this.state.searchValue === value) {\n            return;\n        }\n\n        var filterLocal = this.props.filterLocal;\n\n\n        if (filterLocal) {\n            if (!('searchValue' in this.props)) {\n                this.setState({\n                    searchValue: value,\n                    dataSource: this.dataStore.updateByKey(value)\n                });\n                this.setFirstHightLightKeyForMenu();\n            }\n        } else if (!('searchValue' in this.props)) {\n            this.setState({\n                searchValue: value\n            });\n        }\n    };\n\n    /**\n     * Handle search input change event\n     * @param {String} value search text\n     * @param {Event} e change Event\n     */\n\n\n    Select.prototype.handleSearch = function handleSearch(value, e) {\n        this.handleSearchValue(value);\n\n        // inputing should trigger popup open\n        if (!this.state.visible && value) {\n            this.setVisible(true);\n        }\n\n        this.props.onSearch(value, e);\n    };\n\n    Select.prototype.handleSearchClear = function handleSearchClear(triggerType) {\n        this.handleSearchValue('');\n        this.props.onSearchClear(triggerType);\n    };\n\n    // 搜索框 keyDown 事件\n\n\n    Select.prototype.handleSearchKeyDown = function handleSearchKeyDown(e) {\n        var _props6 = this.props,\n            popupContent = _props6.popupContent,\n            onKeyDown = _props6.onKeyDown,\n            showSearch = _props6.showSearch,\n            mode = _props6.mode,\n            hasClear = _props6.hasClear,\n            onToggleHighlightItem = _props6.onToggleHighlightItem,\n            readOnly = _props6.readOnly,\n            disabled = _props6.disabled;\n\n\n        var hasSearch = this.hasSearch();\n\n        if (popupContent) {\n            // 搜索的时候不阻止冒泡会无法输入\n            if (hasSearch && e.keyCode === KEYCODE.SPACE) {\n                e.stopPropagation();\n            }\n            return onKeyDown(e);\n        }\n\n        var proxy = 'search';\n\n        switch (e.keyCode) {\n            case KEYCODE.UP:\n                e.preventDefault();\n                onToggleHighlightItem(this.toggleHighlightItem(-1, e), 'up');\n                break;\n            case KEYCODE.DOWN:\n                e.preventDefault();\n                onToggleHighlightItem(this.toggleHighlightItem(1, e), 'down');\n                break;\n            case KEYCODE.ENTER:\n                e.preventDefault();\n                if (readOnly || disabled) {\n                    break;\n                }\n                this.chooseHighlightItem(proxy, e);\n                break;\n            case KEYCODE.ESC:\n                e.preventDefault();\n                this.state.visible && this.setVisible(false, 'keyDown');\n                break;\n            case KEYCODE.SPACE:\n                e.stopPropagation();\n                !hasSearch && e.preventDefault();\n                break;\n            case KEYCODE.BACKSPACE:\n                if (readOnly || disabled) {\n                    break;\n                }\n                if (mode === 'multiple' && showSearch || mode === 'tag') {\n                    // 在多选并且有搜索的情况下，删除最后一个 tag\n                    var valueDS = this.valueDataSource.valueDS;\n                    if (valueDS && valueDS.length && !valueDS[valueDS.length - 1].disabled) {\n                        this.handleDeleteTag(e);\n                    }\n                } else if (mode === 'single' && hasClear && !this.state.visible) {\n                    // 单选、非展开、并且可清除的情况，允许按删除键清除\n                    this.handleClear(e);\n                }\n                break;\n            default:\n                break;\n        }\n\n        onKeyDown(e);\n    };\n\n    Select.prototype.chooseMultipleItem = function chooseMultipleItem(key) {\n        var value = this.state.value || [];\n        var keys = value.map(function (v) {\n            return valueToSelectKey(v);\n        });\n\n        var keepSearchValue = false;\n\n        var index = keys.map(function (v) {\n            return '' + v;\n        }).indexOf(key);\n\n        if (index > -1) {\n            // unselect\n            keys.splice(index, 1);\n            keepSearchValue = true; // 回车反选保留搜索值\n        } else {\n            // select\n            keys.push(key);\n        }\n\n        this.handleMultipleSelect(keys, 'enter', null, keepSearchValue);\n    };\n\n    // 回车 选择高亮的 item\n\n\n    Select.prototype.chooseHighlightItem = function chooseHighlightItem(proxy, e) {\n        var mode = this.props.mode;\n\n\n        if (!this.state.visible) {\n            // input tag by itself\n            if (mode === 'tag' && this.state.searchValue) {\n                this.chooseMultipleItem(this.state.searchValue);\n            }\n            return false;\n        }\n\n        var highlightKey = this.state.highlightKey;\n\n        // 没有高亮选项 或者 没有可选菜单\n\n        if (highlightKey === null || !this.dataStore.getMenuDS().length) {\n            return;\n        }\n\n        if (mode === 'single') {\n            this.handleSingleSelect(highlightKey, 'enter');\n        } else {\n            this.chooseMultipleItem(highlightKey);\n            // 阻止事件冒泡到最外层，让Popup 监听到触发弹层关闭\n            e && e.stopPropagation();\n        }\n    };\n\n    /**\n     * Handle Tag close event\n     * @param  {Object} item\n     * @return {Boolean} false  return false to prevent auto close\n     * ----\n     * It MUST be multiple mode, needn't additional judgement\n     */\n\n\n    Select.prototype.handleTagClose = function handleTagClose(item) {\n        var readOnly = this.props.readOnly;\n\n        if (readOnly) return false;\n        if (this.useDetailValue()) {\n            var value = this.state.value.filter(function (v) {\n                return item.value !== v.value;\n            });\n\n            this.handleChange(value, 'tag');\n        } else {\n            // filter out current item, and then call handleMenuSelect\n            var _value = this.state.value.filter(function (v) {\n                return item.value !== v;\n            });\n\n            this.handleMultipleSelect(_value, 'tag');\n        }\n\n        this.props.onRemove(item);\n\n        // prevent tag close\n        return false;\n    };\n\n    // eslint-disable-next-line valid-jsdoc\n    /**\n     * Handle BACKSPACE key event\n     * @param {Event} e keyDown event\n     * ---\n     * It MUST be multiple mode\n     */\n\n\n    Select.prototype.handleDeleteTag = function handleDeleteTag(e) {\n        var value = this.state.value;\n        var searchValue = this.state.searchValue;\n\n        if (searchValue || !value || !value.length) {\n            return false;\n        }\n\n        e.preventDefault();\n\n        var nextValues = value.slice(0, value.length - 1);\n        // 手动调用 handleMenuSelect 时直接传入原生的 value，可以减少 toString 的操作\n\n        if (this.useDetailValue()) {\n            this.handleChange(nextValues, 'tag');\n        } else {\n            this.handleMultipleSelect(nextValues, 'tag');\n        }\n    };\n\n    /**\n     * Handle SelectAll span click event\n     * @param {Event} e click event\n     */\n\n\n    Select.prototype.handleSelectAll = function handleSelectAll(e) {\n        e && e.preventDefault();\n        var nextValues = void 0;\n\n        if (this.selectAllYet) {\n            nextValues = [];\n        } else {\n            nextValues = this.dataStore.getEnableDS().map(function (item) {\n                return item.value;\n            });\n        }\n\n        // 直接传 values，减少 toString 操作\n        this.handleMultipleSelect(nextValues, 'selectAll');\n    };\n\n    Select.prototype.handleVisibleChange = function handleVisibleChange(visible, type) {\n        this.setVisible(visible, type);\n    };\n\n    Select.prototype.afterClose = function afterClose() {\n        // 关闭的时候清空搜索值\n        if (this.hasSearch()) {\n            this.handleSearchClear('popupClose');\n        }\n    };\n\n    Select.prototype.maxTagPlaceholder = function maxTagPlaceholder(selectedValues, totalValues) {\n        var locale = this.props.locale;\n\n\n        return '' + str.template(locale.maxTagPlaceholder, {\n            selected: selectedValues.length,\n            total: totalValues.length\n        });\n    };\n\n    /**\n     * 如果用户是自定义的弹层，则直接以 value 为准，不再校验 dataSource\n     * TODO: 2.0 中 value 接受 string/object{value,label} 两种类型的数据，自动做识别，可以避免用户去转换，也和 date-picker 对齐\n     * 此外 onChange 第一个参数根据 api 来控制类型是 [string] 还是 [object{value,label}]\n     * @param {object} props\n     */\n\n\n    Select.prototype.renderValues = function renderValues() {\n        var _this4 = this;\n\n        var _props7 = this.props,\n            prefix = _props7.prefix,\n            mode = _props7.mode,\n            valueRender = _props7.valueRender,\n            fillProps = _props7.fillProps,\n            disabled = _props7.disabled,\n            maxTagCount = _props7.maxTagCount,\n            maxTagPlaceholder = _props7.maxTagPlaceholder,\n            tagInline = _props7.tagInline,\n            tagClosable = _props7.tagClosable;\n\n        var tagSize = this.getTagSize();\n        var value = this.state.value;\n\n        if (isNull(value)) {\n            return null;\n        }\n\n        // get detail value\n        if (!this.useDetailValue()) {\n            if (value === this.valueDataSource.value) {\n                value = this.valueDataSource.valueDS;\n            } else {\n                value = getValueDataSource(value, this.valueDataSource.mapValueDS, this.dataStore.getMapDS()).valueDS;\n            }\n        }\n\n        if (mode === 'single') {\n            if (!value) {\n                return null;\n            }\n\n            var retvalue = fillProps && (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && fillProps in value ? value[fillProps] : valueRender(value);\n            // 0 => '0'\n            return typeof retvalue === 'number' ? retvalue.toString() : retvalue;\n        } else if (value) {\n            var limitedCountValue = value;\n            var maxTagPlaceholderEl = void 0;\n            var totalValue = this.dataStore.getFlattenDS();\n            var holder = 'maxTagPlaceholder' in this.props ? maxTagPlaceholder : this.maxTagPlaceholder;\n\n            if (maxTagCount !== undefined && value.length > maxTagCount && !tagInline) {\n                limitedCountValue = limitedCountValue.slice(0, maxTagCount);\n                maxTagPlaceholderEl = React.createElement(\n                    Tag,\n                    { key: '_count', type: 'primary', size: tagSize, animation: false },\n                    holder(value, totalValue)\n                );\n            }\n\n            if (value.length > 0 && tagInline) {\n                maxTagPlaceholderEl = React.createElement(\n                    'div',\n                    { className: prefix + 'select-tag-compact', key: '_count' },\n                    holder(value, totalValue)\n                );\n            }\n\n            value = limitedCountValue;\n            if (!Array.isArray(value)) {\n                value = [value];\n            }\n\n            var selectedValueNodes = value.map(function (v) {\n                if (!v) {\n                    return null;\n                }\n                var labelNode = fillProps ? v[fillProps] : valueRender(v);\n\n                return React.createElement(\n                    Tag,\n                    {\n                        key: v.value,\n                        disabled: disabled || v.disabled,\n                        type: 'primary',\n                        size: tagSize,\n                        animation: false,\n                        onClose: _this4.handleTagClose.bind(_this4, v),\n                        closable: tagClosable\n                    },\n                    labelNode\n                );\n            });\n\n            if (maxTagPlaceholderEl) {\n                if (tagInline) {\n                    selectedValueNodes.unshift(maxTagPlaceholderEl);\n                } else {\n                    selectedValueNodes.push(maxTagPlaceholderEl);\n                }\n            }\n            return selectedValueNodes;\n        }\n\n        return null;\n    };\n    /**\n     * 1. fix flash while click <label/>\n     * 2. fix onBlur while has clear\n     * @returns\n     */\n\n\n    Select.prototype.hasClear = function hasClear() {\n        var _props8 = this.props,\n            hasClear = _props8.hasClear,\n            readOnly = _props8.readOnly,\n            disabled = _props8.disabled,\n            showSearch = _props8.showSearch;\n        var _state = this.state,\n            value = _state.value,\n            visible = _state.visible;\n\n\n        return typeof value !== 'undefined' && value !== null && hasClear && !readOnly && !disabled && !(showSearch && visible);\n    };\n\n    /**\n     * render arrow\n     * @param {object} props\n     * @param {function} [clickHandler]\n     */\n\n\n    Select.prototype.renderExtraNode = function renderExtraNode() {\n        var _props9 = this.props,\n            hasArrow = _props9.hasArrow,\n            hasClear = _props9.hasClear,\n            prefix = _props9.prefix;\n\n\n        var ret = [];\n\n        if (hasArrow) {\n            ret.push(React.createElement(\n                'span',\n                { key: 'arrow', 'aria-hidden': true, onClick: this.handleArrowClick, className: prefix + 'select-arrow' },\n                React.createElement(Icon, { type: 'arrow-down', className: prefix + 'select-symbol-fold' })\n            ));\n        }\n\n        // do not use this.hasClear() here, to make sure clear btn always exists, can not influenced by apis like `disabled` `readOnly`\n        if (hasClear) {\n            ret.push(React.createElement(\n                'span',\n                { key: 'clear', 'aria-hidden': true, onClick: this.handleClear, className: prefix + 'select-clear' },\n                React.createElement(Icon, { type: 'delete-filling' })\n            ));\n        }\n\n        return ret;\n    };\n\n    /**\n     * 选择器\n     * @override\n     * @param {object} props\n     */\n\n\n    Select.prototype.renderSelect = function renderSelect() {\n        var _classNames,\n            _this5 = this;\n\n        var _props10 = this.props,\n            prefix = _props10.prefix,\n            showSearch = _props10.showSearch,\n            placeholder = _props10.placeholder,\n            mode = _props10.mode,\n            size = _props10.size,\n            className = _props10.className,\n            style = _props10.style,\n            readOnly = _props10.readOnly,\n            disabled = _props10.disabled,\n            hasBorder = _props10.hasBorder,\n            label = _props10.label,\n            locale = _props10.locale,\n            state = _props10.state,\n            onBlur = _props10.onBlur,\n            onFocus = _props10.onFocus,\n            onMouseEnter = _props10.onMouseEnter,\n            onMouseLeave = _props10.onMouseLeave,\n            rtl = _props10.rtl;\n\n        var others = obj.pickOthers(Select.propTypes, this.props);\n        var othersData = obj.pickAttrsWith(others, 'data-');\n\n        var visible = this.state.visible;\n        var isSingle = mode === 'single';\n        var hasSearch = this.hasSearch();\n        var valueNodes = this.renderValues();\n\n        // compatible with selectPlaceHolder. TODO: removed in 2.0 version\n        var _placeholder = placeholder || locale.selectPlaceholder || locale.selectPlaceHolder;\n        if (valueNodes && valueNodes.length) {\n            _placeholder = null;\n        }\n\n        // 弹窗展开时将当前的值作为 placeholder，这个功能的前提是 valueNode 必须是一个字符串\n        if (showSearch && visible && isSingle && typeof valueNodes === 'string') {\n            _placeholder = valueNodes;\n        }\n\n        // 下拉箭头\n        var extra = this.renderExtraNode();\n\n        var triggerClazz = classNames([prefix + 'select', prefix + 'select-trigger', prefix + 'select-' + mode, '' + prefix + size, className], (_classNames = {}, _classNames[prefix + 'active'] = visible, _classNames[prefix + 'inactive'] = !visible, _classNames[prefix + 'no-search'] = !hasSearch, _classNames[prefix + 'has-search'] = hasSearch, _classNames[prefix + 'select-in-ie'] = isIE9, _classNames[prefix + 'select-in-ie-fixwidth'] = this.state.fixWidth, _classNames[prefix + 'has-clear'] = this.hasClear(), _classNames));\n\n        var valuetext = this.valueDataSource.valueDS ? this.valueDataSource.valueDS.label : '';\n        return React.createElement(\n            'span',\n            _extends({}, othersData, {\n                className: triggerClazz,\n                style: style,\n                dir: rtl ? 'rtl' : undefined,\n                ref: this.saveSelectRef,\n                onClick: this.handleWrapClick,\n                onMouseEnter: onMouseEnter,\n                onMouseLeave: onMouseLeave,\n                onMouseDown: this.handleWrapClick\n            }),\n            React.createElement(Input, _extends({\n                'aria-valuetext': valuetext\n            }, obj.pickOthers(othersData, others), {\n                role: 'combobox',\n                tabIndex: 0,\n                'aria-expanded': this.state.visible,\n                'aria-disabled': disabled,\n                state: state,\n                label: label,\n                extra: extra,\n                value: this.state.searchValue,\n                size: size,\n                readOnly: !this.hasSearch() || readOnly,\n                disabled: disabled,\n                placeholder: _placeholder,\n                hasBorder: hasBorder,\n                hasClear: false,\n                htmlSize: '1',\n                inputRender: function inputRender(inputEl) {\n                    return _this5.renderSearchInput(valueNodes, _placeholder, inputEl);\n                },\n                onChange: this.handleSearch,\n                onKeyDown: this.handleSearchKeyDown,\n                onFocus: onFocus,\n                onBlur: onBlur,\n                className: prefix + 'select-inner',\n                ref: this.saveInputRef\n            })),\n            React.createElement(\n                'span',\n                { className: prefix + 'sr-only', 'aria-live': 'polite' },\n                this.state.srReader\n            )\n        );\n    };\n\n    Select.prototype.renderSearchInput = function renderSearchInput(valueNodes, placeholder, inputEl) {\n        var _classNames2;\n\n        var _props11 = this.props,\n            prefix = _props11.prefix,\n            mode = _props11.mode,\n            tagInline = _props11.tagInline;\n\n        var isSingle = mode === 'single';\n\n        var mirrorText = this.state.searchValue;\n\n        var cls = classNames((_classNames2 = {}, _classNames2[prefix + 'select-values'] = true, _classNames2[prefix + 'input-text-field'] = true, _classNames2[prefix + 'select-compact'] = !isSingle && tagInline, _classNames2));\n        var title = typeof valueNodes === 'string' ? valueNodes : '';\n        var searchInput = [isSingle && valueNodes ? React.createElement(\n            'em',\n            { title: title, key: 'select-value' },\n            valueNodes\n        ) : valueNodes];\n        var triggerSearch = React.createElement(\n            'span',\n            { key: 'trigger-search', className: prefix + 'select-trigger-search' },\n            inputEl,\n            React.createElement(\n                'span',\n                { 'aria-hidden': true },\n                React.createElement(\n                    'span',\n                    null,\n                    mirrorText || placeholder\n                ),\n                React.createElement(\n                    'span',\n                    null,\n                    '\\xA0'\n                )\n            )\n        );\n\n        if (!isSingle && tagInline) {\n            searchInput.unshift(triggerSearch);\n        } else {\n            searchInput.push(triggerSearch);\n        }\n\n        return React.createElement(\n            'span',\n            { className: cls },\n            searchInput\n        );\n    };\n\n    /**\n     * 渲染弹层的 header 内容\n     * @override\n     * @param {object} props\n     */\n\n\n    Select.prototype.renderMenuHeader = function renderMenuHeader() {\n        var _classNames3, _classNames4;\n\n        var _props12 = this.props,\n            prefix = _props12.prefix,\n            hasSelectAll = _props12.hasSelectAll,\n            mode = _props12.mode,\n            locale = _props12.locale,\n            menuProps = _props12.menuProps;\n\n\n        if (menuProps && 'header' in menuProps) {\n            return menuProps.header;\n        }\n\n        var sourceCount = this.dataStore.getEnableDS().length;\n        // 多选模式下才有全选\n        if (!hasSelectAll || mode === 'single' || !sourceCount) {\n            return null;\n        }\n\n        var text = typeof hasSelectAll === 'boolean' ? locale.selectAll : hasSelectAll;\n\n        var selectAllYet = this.selectAllYet;\n\n        var cls = classNames((_classNames3 = {}, _classNames3[prefix + 'select-all'] = true, _classNames3[prefix + 'selected'] = selectAllYet, _classNames3));\n\n        var clsInner = classNames((_classNames4 = {}, _classNames4[prefix + 'select-all-inner'] = true, _classNames4));\n\n        // remove style={{'lineHeight': 'unset'}} in next Y\n        // remove style={{'display': 'none'}} in next Y\n        return React.createElement(\n            'div',\n            { key: 'all', onClick: this.handleSelectAll, className: cls, style: { lineHeight: 'unset' } },\n            selectAllYet ? React.createElement(Icon, { className: prefix + 'menu-icon-selected', style: { display: 'none' }, type: 'select' }) : null,\n            React.createElement(\n                'span',\n                { className: clsInner },\n                text\n            )\n        );\n    };\n\n    Select.prototype.render = function render() {\n        var mode = this.props.mode;\n\n        var props = _extends({}, this.props);\n\n        // forbid to close Popup by click Input while hasSearch\n        if (this.hasSearch()) {\n            props.canCloseByTrigger = false;\n        }\n        if (mode === 'single') {\n            props.cache = true;\n        }\n        return _Base.prototype.render.call(this, props);\n    };\n\n    return Select;\n}(Base), _class.propTypes = _extends({}, Base.propTypes, {\n    /**\n     * 选择器模式\n     */\n    mode: PropTypes.oneOf(['single', 'multiple', 'tag']),\n    /**\n     * 当前值，用于受控模式\n     */\n    value: PropTypes.any,\n    /**\n     * 初始的默认值\n     */\n    defaultValue: PropTypes.any,\n    /**\n     * Select发生改变时触发的回调\n     * @param {*} value 选中的值\n     * @param {String} actionType 触发的方式, 'itemClick', 'enter', 'tag'\n     * @param {*} item 选中的值的对象数据 (useDetailValue=false有效)\n     */\n    onChange: PropTypes.func,\n    /**\n     * 传入的数据源，可以动态渲染子项，详见 [dataSource的使用](#dataSource的使用)\n     */\n    dataSource: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.shape({\n        value: PropTypes.any,\n        label: PropTypes.any,\n        disabled: PropTypes.bool,\n        children: PropTypes.array\n    }), PropTypes.bool, PropTypes.number, PropTypes.string])),\n    /**\n     * 是否有边框\n     */\n    hasBorder: PropTypes.bool,\n    /**\n     * 是否有下拉箭头\n     */\n    hasArrow: PropTypes.bool,\n    /**\n     * 展开后是否能搜索（tag 模式下固定为true）\n     */\n    showSearch: PropTypes.bool,\n    /**\n     * 当搜索框值变化时回调\n     * @param {String} value 数据\n     */\n    onSearch: PropTypes.func,\n    /**\n     * 当搜索框值被(选择、弹窗关闭)导致清空时候的回调\n     * @param {String} actionType 触发的方式, 'select'(选择清空), 'popupClose'(弹窗关闭清空)\n     */\n    onSearchClear: PropTypes.func,\n    /**\n     * 多选模式下是否有全选功能\n     */\n    hasSelectAll: PropTypes.oneOfType([PropTypes.bool, PropTypes.string]),\n    /**\n     * 填充到选择框里的值的 key\b\b\n     */\n    fillProps: PropTypes.string,\n    /**\n     * value 使用对象类型 `{value, label}`, 同时 onChange 第一个参数返回也修改为 dataSource 中的对象\n     */\n    useDetailValue: PropTypes.bool,\n    /**\n     * dataSource 变化的时是否保留已选的内容\n     */\n    cacheValue: PropTypes.bool,\n    /**\n     * 渲染 Select 展现内容的方法\n     * @param {Object} item 渲染节点的item\n     * @return {ReactNode} 展现内容\n     * @default item => `item.label || item.value`\n     */\n    valueRender: PropTypes.func,\n    /**\n     * 渲染 MenuItem 内容的方法\n     * @param {Object} item 渲染节点的item\n     * @param {String} searchValue 搜索关键字（如果开启搜索）\n     * @return {ReactNode} item node\n     */\n    itemRender: PropTypes.func,\n    /**\n     * 弹层内容为空的文案\n     */\n    notFoundContent: PropTypes.node,\n    style: PropTypes.object,\n    /**\n     * 受控搜索值，一般不需要设置\n     * @type {[type]}\n     */\n    searchValue: PropTypes.string,\n    /**\n     * 是否一行显示，仅在 mode 为 multiple 的时候生效\n     * @version 1.15\n     */\n    tagInline: PropTypes.bool,\n    /**\n     * tag 是否可关闭\n     * @version 1.20\n     */\n    tagClosable: PropTypes.bool,\n    /**\n     * tag 尺寸是否和 select 保持一致(mode=multiple/tag 模式生效），默认false\n     * @version 1.24\n     */\n    adjustTagSize: PropTypes.bool,\n    /**\n     * 最多显示多少个 tag\n     * @version 1.15\n     */\n    maxTagCount: PropTypes.number,\n    /**\n     * 隐藏多余 tag 时显示的内容，在 maxTagCount 生效时起作用\n     * @param {object} selectedValues 当前已选中的元素\n     * @param {object} totalValues 总待选元素\n     * @version 1.15\n     */\n    maxTagPlaceholder: PropTypes.func,\n    /**\n     * 选择后是否立即隐藏菜单 (mode=multiple/tag 模式生效)\n     */\n    hiddenSelected: PropTypes.bool,\n    /**\n     * tag 删除回调\n     * @param {object} item 渲染节点的item\n     */\n    onRemove: PropTypes.func,\n    /**\n     * 焦点事件\n     */\n    onFocus: PropTypes.func,\n    /**\n     * 是否自动高亮第一个选项\n     */\n    // highlightFirstItem: PropTypes.bool,\n    /**\n     * 失去焦点事件\n     */\n    onBlur: PropTypes.func,\n    onMouseEnter: PropTypes.func,\n    onMouseLeave: PropTypes.func,\n    onKeyDown: PropTypes.func,\n    locale: PropTypes.object,\n    /**\n     * 展开下拉菜单时是否自动焦点到弹层\n     */\n    popupAutoFocus: PropTypes.bool,\n    /**\n     * 是否展示 dataSource 中 children\n     */\n    showDataSourceChildren: PropTypes.bool\n}), _class.defaultProps = _extends({}, Base.defaultProps, {\n    locale: zhCN.Select,\n    mode: 'single',\n    showSearch: false,\n    cacheValue: true,\n    tagInline: false,\n    adjustTagSize: false,\n    onSearch: noop,\n    onSearchClear: noop,\n    hasArrow: true,\n    onRemove: noop,\n    // highlightFirstItem: true,\n    valueRender: function valueRender(item) {\n        return item.label || item.value;\n    },\n    onKeyDown: noop,\n    onFocus: noop,\n    onBlur: noop,\n    onMouseEnter: noop,\n    onMouseLeave: noop,\n    popupAutoFocus: false,\n    tagClosable: true\n}), _class.displayName = 'Select', _temp);\n\n\nexport default polyfill(Select);"]},"metadata":{},"sourceType":"module"}