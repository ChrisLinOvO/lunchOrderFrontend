{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _typeof from 'babel-runtime/helpers/typeof';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp, _initialiseProps;\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { obj, env } from '../util';\nimport Base from './base';\n\nfunction onNextFrame(cb) {\n  if (window.requestAnimationFrame) {\n    return window.requestAnimationFrame(cb);\n  }\n\n  return window.setTimeout(cb, 1);\n}\n\nfunction clearNextFrameAction(nextFrameId) {\n  if (window.cancelAnimationFrame) {\n    window.cancelAnimationFrame(nextFrameId);\n  } else {\n    window.clearTimeout(nextFrameId);\n  }\n} // safari in mac\n\n\nvar isMacSafari = typeof navigator !== 'undefined' && navigator && navigator.userAgent ? navigator.userAgent.match(/^((?!chrome|android|windows).)*safari/i) : false;\nvar hiddenStyle = {\n  visibility: 'hidden',\n  position: 'absolute',\n  zIndex: '-1000',\n  top: '-1000px',\n  overflowY: 'hidden',\n  left: 0,\n  right: 0\n};\n/**\n * Input.TextArea\n * @order 2\n */\n\nvar TextArea = (_temp = _class = function (_Base) {\n  _inherits(TextArea, _Base);\n\n  function TextArea(props) {\n    _classCallCheck(this, TextArea);\n\n    var _this = _possibleConstructorReturn(this, _Base.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var value = void 0;\n\n    if ('value' in props) {\n      value = props.value;\n    } else {\n      value = props.defaultValue;\n    }\n\n    _this.state = {\n      value: typeof value === 'undefined' ? '' : value\n    };\n    return _this;\n  }\n\n  TextArea.prototype.componentDidMount = function componentDidMount() {\n    var autoHeight = this.props.autoHeight;\n\n    if (autoHeight) {\n      if ((typeof autoHeight === 'undefined' ? 'undefined' : _typeof(autoHeight)) === 'object') {\n        /* eslint-disable react/no-did-mount-set-state */\n        this.setState(this._getMinMaxHeight(autoHeight, this.state.value));\n      } else {\n        this.setState({\n          height: this._getHeight(this.state.value),\n          overflowY: 'hidden'\n        });\n      }\n    }\n  };\n\n  TextArea.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (this.props.autoHeight && this.props.value !== prevProps.value) {\n      this._resizeTextArea(this.props.value);\n    }\n  };\n\n  TextArea.prototype._getMinMaxHeight = function _getMinMaxHeight(_ref, value) {\n    var minRows = _ref.minRows,\n        maxRows = _ref.maxRows;\n    var node = ReactDOM.findDOMNode(this.helpRef);\n\n    if (!node) {\n      return {};\n    }\n\n    node.setAttribute('rows', minRows);\n    var minHeight = node.clientHeight;\n    node.setAttribute('rows', maxRows);\n    var maxHeight = node.clientHeight;\n    node.setAttribute('rows', '1');\n\n    var height = this._getHeight(value);\n\n    return {\n      minHeight: minHeight,\n      maxHeight: maxHeight,\n      height: height,\n      overflowY: height <= maxHeight ? 'hidden' : undefined\n    };\n  };\n\n  TextArea.prototype._getHeight = function _getHeight(value) {\n    var node = ReactDOM.findDOMNode(this.helpRef);\n\n    if (!node) {\n      return 0;\n    }\n\n    node.value = value;\n    return node.scrollHeight;\n  };\n\n  TextArea.prototype.ieHack = function ieHack(value) {\n    // Fix: textarea dit not support maxLength in ie9\n\n    /* istanbul ignore if */\n    if (env.ieVersion === 9 && this.props.maxLength) {\n      var maxLength = parseInt(this.props.maxLength);\n      var len = this.getValueLength(value, true);\n\n      if (len > maxLength && this.props.cutString) {\n        value = value.replace(/\\n/g, '\\n\\n');\n        value = value.substr(0, maxLength);\n        value = value.replace(/\\n\\n/g, '\\n');\n      }\n    }\n\n    this.props.autoHeight && this._resizeTextArea(value);\n    return value;\n  };\n  /**\n   * value.length !== maxLength  in ie/safari(mac) while value has `Enter`\n   * about maxLength compute: `Enter` was considered to be one char(\\n) in chrome , but two chars(\\r\\n) in ie/safari(mac).\n   * so while value has `Enter`, we should let display length + 1\n   */\n\n\n  TextArea.prototype.getValueLength = function getValueLength(value) {\n    var _props = this.props,\n        maxLength = _props.maxLength,\n        cutString = _props.cutString;\n    var nv = '' + value;\n    var strLen = this.props.getValueLength(nv);\n\n    if (typeof strLen !== 'number') {\n      strLen = nv.length;\n    }\n    /* istanbul ignore if */\n\n\n    if (env.ieVersion || isMacSafari) {\n      strLen = strLen + nv.split('\\n').length - 1;\n\n      if (strLen > maxLength && cutString) {\n        strLen = maxLength;\n      }\n    }\n\n    return strLen;\n  };\n\n  TextArea.prototype.saveTextAreaRef = function saveTextAreaRef(textArea) {\n    this.inputRef = textArea;\n  };\n\n  TextArea.prototype.saveHelpRef = function saveHelpRef(ref) {\n    this.helpRef = ref;\n  };\n\n  TextArea.prototype.render = function render() {\n    var _classNames, _classNames2;\n\n    var _props2 = this.props,\n        rows = _props2.rows,\n        style = _props2.style,\n        className = _props2.className,\n        autoHeight = _props2.autoHeight,\n        isPreview = _props2.isPreview,\n        renderPreview = _props2.renderPreview,\n        prefix = _props2.prefix,\n        rtl = _props2.rtl,\n        hasBorder = _props2.hasBorder,\n        size = _props2.size,\n        composition = _props2.composition;\n    var cls = classNames(this.getClass(), (_classNames = {}, _classNames['' + prefix + size] = size === 'large' || 'size' === 'small', _classNames[prefix + 'input-textarea'] = true, _classNames[prefix + 'noborder'] = !hasBorder, _classNames[className] = !!className, _classNames));\n    var props = this.getProps(); // custom data attributes are assigned to the top parent node\n    // data-类自定义数据属性分配到顶层node节点\n\n    var dataProps = obj.pickAttrsWith(this.props, 'data-'); // Custom props are transparently transmitted to the core input node by default\n    // 自定义属性默认透传到核心node节点：input\n\n    var others = obj.pickOthers(_extends({}, dataProps, TextArea.propTypes), this.props);\n\n    var textareStyle = _extends({}, props.style, {\n      height: this.state.height,\n      minHeight: this.state.minHeight,\n      maxHeight: this.state.maxHeight,\n      overflowY: this.state.overflowY\n    });\n\n    var previewCls = classNames((_classNames2 = {}, _classNames2[prefix + 'input-textarea'] = true, _classNames2[prefix + 'form-preview'] = true, _classNames2[className] = !!className, _classNames2));\n    var wrapStyle = autoHeight ? _extends({}, style, {\n      position: 'relative'\n    }) : style;\n\n    if (isPreview) {\n      var value = props.value;\n\n      if ('renderPreview' in this.props) {\n        return React.createElement('div', _extends({}, others, {\n          className: previewCls\n        }), renderPreview(value, this.props));\n      }\n\n      return React.createElement('div', _extends({}, others, {\n        className: previewCls\n      }), value.split('\\n').map(function (data, i) {\n        return React.createElement('p', {\n          key: 'p-' + i\n        }, data);\n      }));\n    }\n\n    var compositionProps = {};\n\n    if (composition) {\n      compositionProps.onCompositionStart = this.handleCompositionStart;\n      compositionProps.onCompositionEnd = this.handleCompositionEnd;\n    }\n\n    return React.createElement('span', _extends({\n      className: cls,\n      style: wrapStyle,\n      dir: rtl ? 'rtl' : undefined\n    }, dataProps), React.createElement('textarea', _extends({}, others, props, compositionProps, {\n      'data-real': true,\n      rows: rows,\n      style: textareStyle,\n      ref: this.saveRef.bind(this),\n      onKeyDown: this.onKeyDown.bind(this)\n    })), autoHeight ? React.createElement('textarea', {\n      'data-fake': true,\n      ref: this.saveHelpRef.bind(this),\n      style: _extends({}, props.style, hiddenStyle),\n      rows: '1'\n    }) : null, this.renderControl());\n  };\n\n  return TextArea;\n}(Base), _class.getDerivedStateFromProps = Base.getDerivedStateFromProps, _class.propTypes = _extends({}, Base.propTypes, {\n  /**\n   * 是否有边框\n   */\n  hasBorder: PropTypes.bool,\n\n  /**\n   * 状态\n   * @enumdesc 错误\n   */\n  state: PropTypes.oneOf(['error', 'warning']),\n\n  /**\n   * 自动高度 true / {minRows: 2, maxRows: 4}\n   */\n  autoHeight: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n\n  /**\n   * 多行文本框高度 <br />(不要直接用height设置多行文本框的高度, ie9 10会有兼容性问题)\n   */\n  rows: PropTypes.number,\n\n  /**\n   * 是否为预览态\n   */\n  isPreview: PropTypes.bool,\n\n  /**\n   * 预览态模式下渲染的内容\n   * @param {number} value 评分值\n   */\n  renderPreview: PropTypes.func\n}), _class.defaultProps = _extends({}, Base.defaultProps, {\n  hasBorder: true,\n  isPreview: false,\n  rows: 4,\n  autoHeight: false\n}), _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this._resizeTextArea = function (value) {\n    if (_this2.nextFrameActionId) {\n      clearNextFrameAction(_this2.nextFrameActionId);\n    }\n\n    _this2.nextFrameActionId = onNextFrame(function () {\n      var height = _this2._getHeight(value);\n\n      var maxHeight = _this2.state.maxHeight ? _this2.state.maxHeight : Infinity;\n\n      _this2.setState({\n        height: _this2._getHeight(value),\n        overflowY: height <= maxHeight ? 'hidden' : undefined\n      });\n    });\n  };\n}, _temp);\nexport { TextArea as default };","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/node_modules/@alifd/next/es/input/textarea.js"],"names":["_extends","_typeof","_classCallCheck","_possibleConstructorReturn","_inherits","_class","_temp","_initialiseProps","React","ReactDOM","PropTypes","classNames","obj","env","Base","onNextFrame","cb","window","requestAnimationFrame","setTimeout","clearNextFrameAction","nextFrameId","cancelAnimationFrame","clearTimeout","isMacSafari","navigator","userAgent","match","hiddenStyle","visibility","position","zIndex","top","overflowY","left","right","TextArea","_Base","props","_this","call","value","defaultValue","state","prototype","componentDidMount","autoHeight","setState","_getMinMaxHeight","height","_getHeight","componentDidUpdate","prevProps","_resizeTextArea","_ref","minRows","maxRows","node","findDOMNode","helpRef","setAttribute","minHeight","clientHeight","maxHeight","undefined","scrollHeight","ieHack","ieVersion","maxLength","parseInt","len","getValueLength","cutString","replace","substr","_props","nv","strLen","length","split","saveTextAreaRef","textArea","inputRef","saveHelpRef","ref","render","_classNames","_classNames2","_props2","rows","style","className","isPreview","renderPreview","prefix","rtl","hasBorder","size","composition","cls","getClass","getProps","dataProps","pickAttrsWith","others","pickOthers","propTypes","textareStyle","previewCls","wrapStyle","createElement","map","data","i","key","compositionProps","onCompositionStart","handleCompositionStart","onCompositionEnd","handleCompositionEnd","dir","saveRef","bind","onKeyDown","renderControl","getDerivedStateFromProps","bool","oneOf","oneOfType","object","number","func","defaultProps","_this2","nextFrameActionId","Infinity","default"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _typeof from 'babel-runtime/helpers/typeof';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\n\nvar _class, _temp, _initialiseProps;\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport { obj, env } from '../util';\nimport Base from './base';\n\nfunction onNextFrame(cb) {\n    if (window.requestAnimationFrame) {\n        return window.requestAnimationFrame(cb);\n    }\n    return window.setTimeout(cb, 1);\n}\n\nfunction clearNextFrameAction(nextFrameId) {\n    if (window.cancelAnimationFrame) {\n        window.cancelAnimationFrame(nextFrameId);\n    } else {\n        window.clearTimeout(nextFrameId);\n    }\n}\n\n// safari in mac\nvar isMacSafari = typeof navigator !== 'undefined' && navigator && navigator.userAgent ? navigator.userAgent.match(/^((?!chrome|android|windows).)*safari/i) : false;\n\nvar hiddenStyle = {\n    visibility: 'hidden',\n    position: 'absolute',\n    zIndex: '-1000',\n    top: '-1000px',\n    overflowY: 'hidden',\n    left: 0,\n    right: 0\n};\n\n/**\n * Input.TextArea\n * @order 2\n */\nvar TextArea = (_temp = _class = function (_Base) {\n    _inherits(TextArea, _Base);\n\n    function TextArea(props) {\n        _classCallCheck(this, TextArea);\n\n        var _this = _possibleConstructorReturn(this, _Base.call(this, props));\n\n        _initialiseProps.call(_this);\n\n        var value = void 0;\n        if ('value' in props) {\n            value = props.value;\n        } else {\n            value = props.defaultValue;\n        }\n\n        _this.state = {\n            value: typeof value === 'undefined' ? '' : value\n        };\n        return _this;\n    }\n\n    TextArea.prototype.componentDidMount = function componentDidMount() {\n        var autoHeight = this.props.autoHeight;\n        if (autoHeight) {\n            if ((typeof autoHeight === 'undefined' ? 'undefined' : _typeof(autoHeight)) === 'object') {\n                /* eslint-disable react/no-did-mount-set-state */\n                this.setState(this._getMinMaxHeight(autoHeight, this.state.value));\n            } else {\n                this.setState({\n                    height: this._getHeight(this.state.value),\n                    overflowY: 'hidden'\n                });\n            }\n        }\n    };\n\n    TextArea.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {\n        if (this.props.autoHeight && this.props.value !== prevProps.value) {\n            this._resizeTextArea(this.props.value);\n        }\n    };\n\n    TextArea.prototype._getMinMaxHeight = function _getMinMaxHeight(_ref, value) {\n        var minRows = _ref.minRows,\n            maxRows = _ref.maxRows;\n\n        var node = ReactDOM.findDOMNode(this.helpRef);\n        if (!node) {\n            return {};\n        }\n        node.setAttribute('rows', minRows);\n        var minHeight = node.clientHeight;\n\n        node.setAttribute('rows', maxRows);\n        var maxHeight = node.clientHeight;\n\n        node.setAttribute('rows', '1');\n        var height = this._getHeight(value);\n\n        return {\n            minHeight: minHeight,\n            maxHeight: maxHeight,\n            height: height,\n            overflowY: height <= maxHeight ? 'hidden' : undefined\n        };\n    };\n\n    TextArea.prototype._getHeight = function _getHeight(value) {\n        var node = ReactDOM.findDOMNode(this.helpRef);\n        if (!node) {\n            return 0;\n        }\n        node.value = value;\n\n        return node.scrollHeight;\n    };\n\n    TextArea.prototype.ieHack = function ieHack(value) {\n        // Fix: textarea dit not support maxLength in ie9\n        /* istanbul ignore if */\n        if (env.ieVersion === 9 && this.props.maxLength) {\n            var maxLength = parseInt(this.props.maxLength);\n            var len = this.getValueLength(value, true);\n            if (len > maxLength && this.props.cutString) {\n                value = value.replace(/\\n/g, '\\n\\n');\n                value = value.substr(0, maxLength);\n                value = value.replace(/\\n\\n/g, '\\n');\n            }\n        }\n\n        this.props.autoHeight && this._resizeTextArea(value);\n\n        return value;\n    };\n\n    /**\n     * value.length !== maxLength  in ie/safari(mac) while value has `Enter`\n     * about maxLength compute: `Enter` was considered to be one char(\\n) in chrome , but two chars(\\r\\n) in ie/safari(mac).\n     * so while value has `Enter`, we should let display length + 1\n     */\n\n\n    TextArea.prototype.getValueLength = function getValueLength(value) {\n        var _props = this.props,\n            maxLength = _props.maxLength,\n            cutString = _props.cutString;\n\n\n        var nv = '' + value;\n        var strLen = this.props.getValueLength(nv);\n        if (typeof strLen !== 'number') {\n            strLen = nv.length;\n        }\n\n        /* istanbul ignore if */\n        if (env.ieVersion || isMacSafari) {\n            strLen = strLen + nv.split('\\n').length - 1;\n            if (strLen > maxLength && cutString) {\n                strLen = maxLength;\n            }\n        }\n\n        return strLen;\n    };\n\n    TextArea.prototype.saveTextAreaRef = function saveTextAreaRef(textArea) {\n        this.inputRef = textArea;\n    };\n\n    TextArea.prototype.saveHelpRef = function saveHelpRef(ref) {\n        this.helpRef = ref;\n    };\n\n    TextArea.prototype.render = function render() {\n        var _classNames, _classNames2;\n\n        var _props2 = this.props,\n            rows = _props2.rows,\n            style = _props2.style,\n            className = _props2.className,\n            autoHeight = _props2.autoHeight,\n            isPreview = _props2.isPreview,\n            renderPreview = _props2.renderPreview,\n            prefix = _props2.prefix,\n            rtl = _props2.rtl,\n            hasBorder = _props2.hasBorder,\n            size = _props2.size,\n            composition = _props2.composition;\n\n\n        var cls = classNames(this.getClass(), (_classNames = {}, _classNames['' + prefix + size] = size === 'large' || 'size' === 'small', _classNames[prefix + 'input-textarea'] = true, _classNames[prefix + 'noborder'] = !hasBorder, _classNames[className] = !!className, _classNames));\n\n        var props = this.getProps();\n        // custom data attributes are assigned to the top parent node\n        // data-类自定义数据属性分配到顶层node节点\n        var dataProps = obj.pickAttrsWith(this.props, 'data-');\n        // Custom props are transparently transmitted to the core input node by default\n        // 自定义属性默认透传到核心node节点：input\n        var others = obj.pickOthers(_extends({}, dataProps, TextArea.propTypes), this.props);\n\n        var textareStyle = _extends({}, props.style, {\n            height: this.state.height,\n            minHeight: this.state.minHeight,\n            maxHeight: this.state.maxHeight,\n            overflowY: this.state.overflowY\n        });\n\n        var previewCls = classNames((_classNames2 = {}, _classNames2[prefix + 'input-textarea'] = true, _classNames2[prefix + 'form-preview'] = true, _classNames2[className] = !!className, _classNames2));\n\n        var wrapStyle = autoHeight ? _extends({}, style, { position: 'relative' }) : style;\n\n        if (isPreview) {\n            var value = props.value;\n\n            if ('renderPreview' in this.props) {\n                return React.createElement(\n                    'div',\n                    _extends({}, others, { className: previewCls }),\n                    renderPreview(value, this.props)\n                );\n            }\n            return React.createElement(\n                'div',\n                _extends({}, others, { className: previewCls }),\n                value.split('\\n').map(function (data, i) {\n                    return React.createElement(\n                        'p',\n                        { key: 'p-' + i },\n                        data\n                    );\n                })\n            );\n        }\n\n        var compositionProps = {};\n        if (composition) {\n            compositionProps.onCompositionStart = this.handleCompositionStart;\n            compositionProps.onCompositionEnd = this.handleCompositionEnd;\n        }\n\n        return React.createElement(\n            'span',\n            _extends({ className: cls, style: wrapStyle, dir: rtl ? 'rtl' : undefined }, dataProps),\n            React.createElement('textarea', _extends({}, others, props, compositionProps, {\n                'data-real': true,\n                rows: rows,\n                style: textareStyle,\n                ref: this.saveRef.bind(this),\n                onKeyDown: this.onKeyDown.bind(this)\n            })),\n            autoHeight ? React.createElement('textarea', {\n                'data-fake': true,\n                ref: this.saveHelpRef.bind(this),\n                style: _extends({}, props.style, hiddenStyle),\n                rows: '1'\n            }) : null,\n            this.renderControl()\n        );\n    };\n\n    return TextArea;\n}(Base), _class.getDerivedStateFromProps = Base.getDerivedStateFromProps, _class.propTypes = _extends({}, Base.propTypes, {\n    /**\n     * 是否有边框\n     */\n    hasBorder: PropTypes.bool,\n    /**\n     * 状态\n     * @enumdesc 错误\n     */\n    state: PropTypes.oneOf(['error', 'warning']),\n    /**\n     * 自动高度 true / {minRows: 2, maxRows: 4}\n     */\n    autoHeight: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n    /**\n     * 多行文本框高度 <br />(不要直接用height设置多行文本框的高度, ie9 10会有兼容性问题)\n     */\n    rows: PropTypes.number,\n    /**\n     * 是否为预览态\n     */\n    isPreview: PropTypes.bool,\n    /**\n     * 预览态模式下渲染的内容\n     * @param {number} value 评分值\n     */\n    renderPreview: PropTypes.func\n}), _class.defaultProps = _extends({}, Base.defaultProps, {\n    hasBorder: true,\n    isPreview: false,\n    rows: 4,\n    autoHeight: false\n}), _initialiseProps = function _initialiseProps() {\n    var _this2 = this;\n\n    this._resizeTextArea = function (value) {\n        if (_this2.nextFrameActionId) {\n            clearNextFrameAction(_this2.nextFrameActionId);\n        }\n        _this2.nextFrameActionId = onNextFrame(function () {\n            var height = _this2._getHeight(value);\n            var maxHeight = _this2.state.maxHeight ? _this2.state.maxHeight : Infinity;\n\n            _this2.setState({\n                height: _this2._getHeight(value),\n                overflowY: height <= maxHeight ? 'hidden' : undefined\n            });\n        });\n    };\n}, _temp);\nexport { TextArea as default };"]},"metadata":{},"sourceType":"module"}