{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport _typeof from 'babel-runtime/helpers/typeof';\n\nvar _class, _temp;\n\nimport React, { Component, Children, cloneElement } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { polyfill } from 'react-lifecycles-compat';\nimport SubMenu from './sub-menu';\nimport ConfigProvider from '../../config-provider';\nimport { func, obj, dom, events, KEYCODE } from '../../util';\nimport { getWidth, normalizeToArray, isSibling, isAncestor, isAvailablePos, getFirstAvaliablelChildKey } from './util';\nvar bindCtx = func.bindCtx;\nvar pickOthers = obj.pickOthers,\n    isNil = obj.isNil;\n\nvar noop = function noop() {};\n\nvar MENUITEM_OVERFLOWED_CLASSNAME = 'menuitem-overflowed';\n\nvar getIndicatorsItem = function getIndicatorsItem(items, isPlaceholder) {\n  var _cx;\n\n  var prefix = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n  var renderMore = arguments[3];\n  var moreCls = cx((_cx = {}, _cx[prefix + 'menu-more'] = true, _cx));\n  var style = {}; // keep placehold to get width\n\n  if (isPlaceholder) {\n    style.visibility = 'hidden';\n    style.display = 'inline-block'; // indicators which not in use, just display: none\n  } else if (items && items.length === 0) {\n    style.display = 'none';\n    style.visibility = 'unset';\n  }\n\n  if (renderMore && typeof renderMore === 'function') {\n    var moreNode = renderMore(items);\n    var renderMoreCls = cx(moreCls, moreNode.props && moreNode.props.className);\n    return React.isValidElement(moreNode) ? React.cloneElement(moreNode, {\n      style: style,\n      className: renderMoreCls\n    }) : moreNode;\n  }\n\n  return React.createElement(SubMenu, {\n    label: '\\xB7\\xB7\\xB7',\n    noIcon: true,\n    className: moreCls,\n    style: style\n  }, items);\n};\n\nvar addIndicators = function addIndicators(_ref) {\n  var children = _ref.children,\n      lastVisibleIndex = _ref.lastVisibleIndex,\n      prefix = _ref.prefix,\n      renderMore = _ref.renderMore;\n  var arr = [];\n  children.forEach(function (child, index) {\n    if (!child) {\n      return;\n    }\n\n    var overflowedItems = [];\n\n    if (index > lastVisibleIndex) {\n      child = React.cloneElement(child, {\n        key: 'more-' + index,\n        style: {\n          display: 'none'\n        },\n        className: (child && child.className || '') + ' ' + MENUITEM_OVERFLOWED_CLASSNAME\n      });\n    }\n\n    if (index === lastVisibleIndex + 1) {\n      overflowedItems = children.slice(lastVisibleIndex + 1).map(function (c, i) {\n        return React.cloneElement(c, {\n          key: 'more-' + index + '-' + i\n        });\n      });\n      arr.push(getIndicatorsItem(overflowedItems, false, prefix, renderMore));\n    }\n\n    arr.push(child);\n  });\n  arr.push(getIndicatorsItem([], true, prefix, renderMore));\n  return arr;\n};\n\nvar getNewChildren = function getNewChildren(_ref2) {\n  var children = _ref2.children,\n      root = _ref2.root,\n      mode = _ref2.mode,\n      lastVisibleIndex = _ref2.lastVisibleIndex,\n      hozInLine = _ref2.hozInLine,\n      prefix = _ref2.prefix,\n      renderMore = _ref2.renderMore;\n  var k2n = {};\n  var p2n = {};\n  var arr = hozInLine ? addIndicators({\n    children: children,\n    lastVisibleIndex: lastVisibleIndex,\n    prefix: prefix,\n    renderMore: renderMore\n  }) : children;\n\n  var loop = function loop(children, posPrefix) {\n    var indexWrapper = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n      index: 0\n    };\n    var inlineLevel = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n    var keyArray = [];\n    return Children.map(children, function (child) {\n      if (child && (typeof child.type === 'function' || // `React.forwardRef(render)` returns a forwarding\n      // object that includes `render` method, and the specific\n      // `child.type` will be an object instead of a class or\n      // function.\n      _typeof(child.type) === 'object') && 'menuChildType' in child.type) {\n        var newChild = void 0;\n        var pos = void 0;\n        var props = {\n          root: root\n        };\n\n        if (['item', 'submenu', 'group'].indexOf(child.type.menuChildType) > -1) {\n          pos = posPrefix + '-' + indexWrapper.index++;\n          var key = typeof child.key === 'string' ? child.key : pos; // filter out duplicate keys\n\n          if (keyArray.indexOf(key) > -1) {\n            return;\n          }\n\n          keyArray.push(key);\n          var level = pos.split('-').length - 1;\n          k2n[key] = p2n[pos] = {\n            key: key,\n            pos: pos,\n            mode: child.props.mode,\n            type: child.type.menuChildType,\n            disabled: child.props.disabled,\n            label: child.props.label || child.props.children\n          };\n          props.level = level;\n          props.inlineLevel = inlineLevel;\n          props._key = key;\n          props.groupIndent = child.type.menuChildType === 'group' ? 1 : 0;\n        } // paddingLeft(or paddingRight in rtl) only make sense in inline mode\n        // parent know children's inlineLevel\n        // if parent's mode is popup, then children's inlineLevel must be 1;\n        // else inlineLevel should add 1\n\n\n        var childLevel = (child.props.mode || mode) === 'popup' ? 1 : inlineLevel + 1;\n\n        switch (child.type.menuChildType) {\n          case 'submenu':\n            newChild = cloneElement(child, props, loop(child.props.children, pos, undefined, childLevel));\n            break;\n\n          case 'group':\n            newChild = cloneElement(child, props, loop(child.props.children, posPrefix, indexWrapper, props.level));\n            break;\n\n          case 'item':\n          case 'divider':\n            newChild = cloneElement(child, props);\n            break;\n\n          default:\n            newChild = child;\n            break;\n        }\n\n        return newChild;\n      }\n\n      return child;\n    });\n  };\n\n  var newChildren = loop(arr, '0');\n  return {\n    newChildren: newChildren,\n    _k2n: k2n,\n    _p2n: p2n\n  };\n};\n/**\n * Menu\n */\n\n\nvar Menu = (_temp = _class = function (_Component) {\n  _inherits(Menu, _Component);\n\n  function Menu(props) {\n    _classCallCheck(this, Menu);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n    _this.getUpdateChildren = function () {\n      var _this$state = _this.state,\n          root = _this$state.root,\n          lastVisibleIndex = _this$state.lastVisibleIndex;\n      return getNewChildren(_extends({\n        root: root,\n        lastVisibleIndex: lastVisibleIndex\n      }, _this.props));\n    };\n\n    _this.menuContentRef = function (ref) {\n      _this.menuContent = ref;\n    };\n\n    _this.menuHeaderRef = function (ref) {\n      _this.menuHeader = ref;\n    };\n\n    _this.menuFooterRef = function (ref) {\n      _this.menuFooter = ref;\n    };\n\n    var _this$props = _this.props,\n        prefix = _this$props.prefix,\n        children = _this$props.children,\n        selectedKeys = _this$props.selectedKeys,\n        defaultSelectedKeys = _this$props.defaultSelectedKeys,\n        focusedKey = _this$props.focusedKey,\n        focusable = _this$props.focusable,\n        autoFocus = _this$props.autoFocus,\n        hozInLine = _this$props.hozInLine,\n        renderMore = _this$props.renderMore;\n    _this.state = {\n      lastVisibleIndex: undefined\n    };\n\n    var _getNewChildren = getNewChildren(_extends({\n      root: _this\n    }, _this.props)),\n        newChildren = _getNewChildren.newChildren,\n        _k2n = _getNewChildren._k2n,\n        _p2n = _getNewChildren._p2n;\n\n    var tabbableKey = focusable ? getFirstAvaliablelChildKey('0', _p2n) : undefined;\n    _this.state = {\n      root: _this,\n      lastVisibleIndex: undefined,\n      newChildren: newChildren,\n      _k2n: _k2n,\n      _p2n: _p2n,\n      tabbableKey: tabbableKey,\n      openKeys: _this.getInitOpenKeys(props, _k2n, _p2n),\n      selectedKeys: normalizeToArray(selectedKeys || defaultSelectedKeys),\n      focusedKey: !isNil(_this.props.focusedKey) ? focusedKey : focusable && autoFocus ? tabbableKey : null\n    };\n    bindCtx(_this, ['handleOpen', 'handleSelect', 'handleItemClick', 'handleItemKeyDown', 'onBlur', 'adjustChildrenWidth']);\n    _this.popupNodes = [];\n    return _this;\n  }\n\n  Menu.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n    var state = {};\n\n    if ('openKeys' in nextProps) {\n      state.openKeys = normalizeToArray(nextProps.openKeys); // 从展开状态变为收起状态，才需要清空openKeys\n    } else if ('mode' in nextProps && nextProps.mode === 'popup' && prevState.lastMode === 'inline') {\n      state.openKeys = [];\n    }\n\n    if ('selectedKeys' in nextProps) {\n      state.selectedKeys = normalizeToArray(nextProps.selectedKeys);\n    }\n\n    if ('focusedKey' in nextProps) {\n      state.focusedKey = nextProps.focusedKey;\n    }\n\n    state.lastMode = nextProps.mode;\n\n    var _getNewChildren2 = getNewChildren(_extends({\n      root: prevState.root,\n      lastVisibleIndex: prevState.lastVisibleIndex\n    }, nextProps)),\n        newChildren = _getNewChildren2.newChildren,\n        _k2n = _getNewChildren2._k2n,\n        _p2n = _getNewChildren2._p2n;\n\n    state.newChildren = newChildren;\n    state._k2n = _k2n;\n    state._p2n = _p2n;\n\n    if (nextProps.focusable) {\n      if (prevState.tabbableKey in _k2n) {\n        if (prevState.focusedKey) {\n          state.tabbableKey = prevState.focusedKey;\n        }\n      } else {\n        state.tabbableKey = getFirstAvaliablelChildKey('0', _p2n);\n      }\n    }\n\n    return state;\n  };\n\n  Menu.prototype.componentDidMount = function componentDidMount() {\n    this.menuNode = findDOMNode(this);\n    this.adjustChildrenWidth();\n\n    if (this.props.hozInLine) {\n      events.on(window, 'resize', this.adjustChildrenWidth);\n    }\n  };\n\n  Menu.prototype.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n    if (prevState.lastVisibleIndex !== this.state.lastVisibleIndex) {\n      this.adjustChildrenWidth();\n    }\n  };\n\n  Menu.prototype.componentWillUnmount = function componentWillUnmount() {\n    events.off(window, 'resize', this.adjustChildrenWidth);\n  };\n\n  Menu.prototype.adjustChildrenWidth = function adjustChildrenWidth() {\n    var _props = this.props,\n        direction = _props.direction,\n        prefix = _props.prefix,\n        header = _props.header,\n        footer = _props.footer,\n        hozInLine = _props.hozInLine;\n\n    if (direction !== 'hoz' || !hozInLine) {\n      return;\n    }\n\n    if (!this.menuNode && !this.menuContent) {\n      return;\n    }\n\n    var children = [],\n        spaceWidth = void 0;\n\n    if (header || footer) {\n      children = this.menuContent.children;\n      spaceWidth = getWidth(this.menuNode) - getWidth(this.menuHeader) - getWidth(this.menuFooter);\n    } else {\n      children = this.menuNode.children;\n      spaceWidth = getWidth(this.menuNode);\n    }\n\n    if (children.length < 2) {\n      return;\n    }\n\n    var currentSumWidth = 0,\n        lastVisibleIndex = -1;\n    var moreNode = '';\n    var menuItemNodes = [].slice.call(children).filter(function (node) {\n      if (node.className.split(' ').indexOf(prefix + 'menu-more') < 0) {\n        return true;\n      } else {\n        moreNode = node;\n      }\n\n      return false;\n    });\n    var overflowedItems = menuItemNodes.filter(function (c) {\n      return c.className.split(' ').indexOf(MENUITEM_OVERFLOWED_CLASSNAME) >= 0;\n    });\n    overflowedItems.forEach(function (c) {\n      dom.setStyle(c, 'display', 'inline-block');\n    });\n    dom.setStyle(moreNode, 'display', 'inline-block');\n    var moreWidth = getWidth(moreNode);\n    this.menuItemSizes = menuItemNodes.map(function (c) {\n      return getWidth(c);\n    });\n    var totalLen = this.menuItemSizes.length;\n    overflowedItems.forEach(function (c) {\n      dom.setStyle(c, 'display', 'none');\n    });\n    this.menuItemSizes.forEach(function (liWidth, i) {\n      currentSumWidth += liWidth;\n\n      if (i >= totalLen - 1 && currentSumWidth <= spaceWidth || currentSumWidth + moreWidth <= spaceWidth) {\n        lastVisibleIndex++;\n      }\n    });\n\n    if (lastVisibleIndex >= totalLen - 1) {\n      dom.setStyle(moreNode, 'display', 'none');\n    }\n\n    this.setState(_extends({\n      lastVisibleIndex: lastVisibleIndex\n    }, this.getUpdateChildren()));\n  };\n\n  Menu.prototype.onBlur = function onBlur(e) {\n    this.setState({\n      focusedKey: undefined\n    });\n    this.props.onBlur && this.props.onBlur(e);\n  };\n\n  Menu.prototype.getInitOpenKeys = function getInitOpenKeys(props, _k2n, _p2n) {\n    var initOpenKeys = void 0;\n    var openKeys = props.openKeys,\n        defaultOpenKeys = props.defaultOpenKeys,\n        defaultOpenAll = props.defaultOpenAll,\n        mode = props.mode,\n        openMode = props.openMode;\n\n    if (openKeys) {\n      initOpenKeys = openKeys;\n    } else if (defaultOpenAll && mode === 'inline' && openMode === 'multiple') {\n      initOpenKeys = Object.keys(_k2n).filter(function (key) {\n        return _k2n[key].type === 'submenu';\n      });\n    } else {\n      initOpenKeys = defaultOpenKeys;\n    }\n\n    return normalizeToArray(initOpenKeys);\n  };\n\n  Menu.prototype.handleOpen = function handleOpen(key, open, triggerType, e) {\n    var newOpenKeys = void 0;\n    var _props2 = this.props,\n        mode = _props2.mode,\n        openMode = _props2.openMode;\n    var _state = this.state,\n        openKeys = _state.openKeys,\n        _k2n = _state._k2n;\n    var index = openKeys.indexOf(key);\n\n    if (open && index === -1) {\n      if (mode === 'inline') {\n        if (openMode === 'single') {\n          newOpenKeys = openKeys.filter(function (k) {\n            return _k2n[k] && !isSibling(_k2n[key].pos, _k2n[k].pos);\n          });\n          newOpenKeys.push(key);\n        } else {\n          newOpenKeys = openKeys.concat(key);\n        }\n      } else {\n        newOpenKeys = openKeys.filter(function (k) {\n          return _k2n[k] && isAncestor(_k2n[key].pos, _k2n[k].pos);\n        });\n        newOpenKeys.push(key);\n      }\n    } else if (!open && index > -1) {\n      if (mode === 'inline') {\n        newOpenKeys = [].concat(openKeys.slice(0, index), openKeys.slice(index + 1));\n      } else if (triggerType === 'docClick') {\n        if (!this.popupNodes.concat(this.menuNode).some(function (node) {\n          return node.contains(e.target);\n        })) {\n          newOpenKeys = [];\n        }\n      } else {\n        newOpenKeys = openKeys.filter(function (k) {\n          return k !== key && _k2n[k] && !isAncestor(_k2n[k].pos, _k2n[key].pos);\n        });\n      }\n    }\n\n    if (newOpenKeys) {\n      if (isNil(this.props.openKeys)) {\n        this.setState(_extends({\n          openKeys: newOpenKeys\n        }, this.getUpdateChildren()));\n      }\n\n      this.props.onOpen(newOpenKeys, {\n        key: key,\n        open: open\n      });\n    }\n  };\n\n  Menu.prototype.getPath = function getPath(key, _k2n, _p2n) {\n    var keyPath = [];\n    var labelPath = [];\n    var pos = _k2n[key].pos;\n    var nums = pos.split('-');\n\n    for (var i = 1; i < nums.length - 1; i++) {\n      var parentNums = nums.slice(0, i + 1);\n      var parentPos = parentNums.join('-');\n      var parent = _p2n[parentPos];\n      keyPath.push(parent.key);\n      labelPath.push(parent.label);\n    }\n\n    return {\n      keyPath: keyPath,\n      labelPath: labelPath\n    };\n  };\n\n  Menu.prototype.handleSelect = function handleSelect(key, select, menuItem) {\n    var _state2 = this.state,\n        _k2n = _state2._k2n,\n        _p2n = _state2._p2n;\n    var pos = _k2n[key].pos;\n    var level = pos.split('-').length - 1;\n\n    if (this.props.shallowSelect && level > 1) {\n      return;\n    }\n\n    var newSelectedKeys = void 0;\n    var selectMode = this.props.selectMode;\n    var selectedKeys = this.state.selectedKeys;\n    var index = selectedKeys.indexOf(key);\n\n    if (select && index === -1) {\n      if (selectMode === 'single') {\n        newSelectedKeys = [key];\n      } else if (selectMode === 'multiple') {\n        newSelectedKeys = selectedKeys.concat(key);\n      }\n    } else if (!select && index > -1 && selectMode === 'multiple') {\n      newSelectedKeys = [].concat(selectedKeys.slice(0, index), selectedKeys.slice(index + 1));\n    }\n\n    if (newSelectedKeys) {\n      if (isNil(this.props.selectedKeys)) {\n        this.setState({\n          selectedKeys: newSelectedKeys\n        });\n      }\n\n      this.props.onSelect(newSelectedKeys, menuItem, _extends({\n        key: key,\n        select: select,\n        label: _k2n[key].label\n      }, this.getPath(key, _k2n, _p2n)));\n    }\n  };\n\n  Menu.prototype.handleItemClick = function handleItemClick(key, item, e) {\n    var _k2n = this.state._k2n;\n\n    if (this.props.focusable) {\n      if (isNil(this.props.focusedKey)) {\n        this.setState({\n          focusedKey: key\n        });\n      }\n\n      this.props.onItemFocus(key, item, e);\n    }\n\n    if (item.props.type === 'item') {\n      if (item.props.parentMode === 'popup' && this.state.openKeys.length) {\n        if (isNil(this.props.openKeys)) {\n          this.setState({\n            openKeys: []\n          });\n        }\n\n        this.props.onOpen([], {\n          key: this.state.openKeys.sort(function (prevKey, nextKey) {\n            return _k2n[nextKey].pos.split('-').length - _k2n[prevKey].pos.split('-').length;\n          })[0],\n          open: false\n        });\n      }\n\n      this.props.onItemClick(key, item, e);\n    }\n  };\n\n  Menu.prototype.getAvailableKey = function getAvailableKey(pos, prev) {\n    var _p2n = this.state._p2n;\n    var ps = Object.keys(_p2n).filter(function (p) {\n      return isAvailablePos(pos, p, _p2n);\n    });\n\n    if (ps.length > 1) {\n      var index = ps.indexOf(pos);\n      var targetIndex = void 0;\n\n      if (prev) {\n        targetIndex = index === 0 ? ps.length - 1 : index - 1;\n      } else {\n        targetIndex = index === ps.length - 1 ? 0 : index + 1;\n      }\n\n      return _p2n[ps[targetIndex]].key;\n    }\n\n    return null;\n  };\n\n  Menu.prototype.getParentKey = function getParentKey(pos) {\n    return this.state._p2n[pos.slice(0, pos.length - 2)].key;\n  };\n\n  Menu.prototype.handleItemKeyDown = function handleItemKeyDown(key, type, item, e) {\n    if ([KEYCODE.UP, KEYCODE.DOWN, KEYCODE.RIGHT, KEYCODE.LEFT, KEYCODE.ENTER, KEYCODE.ESC, KEYCODE.SPACE].indexOf(e.keyCode) > -1) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n\n    var focusedKey = this.state.focusedKey;\n    var _state3 = this.state,\n        _p2n = _state3._p2n,\n        _k2n = _state3._k2n;\n    var direction = this.props.direction;\n    var pos = _k2n[key].pos;\n    var level = pos.split('-').length - 1;\n\n    switch (e.keyCode) {\n      case KEYCODE.UP:\n        {\n          var avaliableKey = this.getAvailableKey(pos, true);\n\n          if (avaliableKey) {\n            focusedKey = avaliableKey;\n          }\n\n          break;\n        }\n\n      case KEYCODE.DOWN:\n        {\n          var _avaliableKey = void 0;\n\n          if (direction === 'hoz' && level === 1 && type === 'submenu') {\n            this.handleOpen(key, true);\n            _avaliableKey = getFirstAvaliablelChildKey(pos, _p2n);\n          } else {\n            _avaliableKey = this.getAvailableKey(pos, false);\n          }\n\n          if (_avaliableKey) {\n            focusedKey = _avaliableKey;\n          }\n\n          break;\n        }\n\n      case KEYCODE.RIGHT:\n        {\n          var _avaliableKey2 = void 0;\n\n          if (direction === 'hoz' && level === 1) {\n            _avaliableKey2 = this.getAvailableKey(pos, false);\n          } else if (type === 'submenu') {\n            this.handleOpen(key, true);\n            _avaliableKey2 = getFirstAvaliablelChildKey(pos, _p2n);\n          }\n\n          if (_avaliableKey2) {\n            focusedKey = _avaliableKey2;\n          }\n\n          break;\n        }\n\n      case KEYCODE.ENTER:\n        {\n          if (type === 'submenu') {\n            this.handleOpen(key, true);\n\n            var _avaliableKey3 = getFirstAvaliablelChildKey(pos, _p2n);\n\n            if (_avaliableKey3) {\n              focusedKey = _avaliableKey3;\n            }\n          }\n\n          break;\n        }\n\n      case KEYCODE.LEFT:\n        {\n          if (direction === 'hoz' && level === 1) {\n            var _avaliableKey4 = this.getAvailableKey(pos, true);\n\n            if (_avaliableKey4) {\n              focusedKey = _avaliableKey4;\n            }\n          } else if (level > 1) {\n            var parentKey = this.getParentKey(pos);\n            this.handleOpen(parentKey, false);\n            focusedKey = parentKey;\n          }\n\n          break;\n        }\n\n      case KEYCODE.ESC:\n        if (level > 1) {\n          var _parentKey = this.getParentKey(pos);\n\n          this.handleOpen(_parentKey, false);\n          focusedKey = _parentKey;\n        }\n\n        break;\n\n      case KEYCODE.TAB:\n        focusedKey = null;\n        break;\n\n      default:\n        break;\n    }\n\n    if (focusedKey !== this.state.focusedKey) {\n      if (isNil(this.props.focusedKey)) {\n        this.setState({\n          focusedKey: focusedKey\n        });\n      }\n\n      this.props.onItemKeyDown(focusedKey, item, e);\n      this.props.onItemFocus(focusedKey, e);\n    }\n  };\n\n  Menu.prototype.render = function render() {\n    var _cx2;\n\n    var _props3 = this.props,\n        prefix = _props3.prefix,\n        className = _props3.className,\n        direction = _props3.direction,\n        hozAlign = _props3.hozAlign,\n        header = _props3.header,\n        footer = _props3.footer,\n        embeddable = _props3.embeddable,\n        selectMode = _props3.selectMode,\n        hozInLine = _props3.hozInLine,\n        rtl = _props3.rtl,\n        flatenContent = _props3.flatenContent;\n    var newChildren = this.state.newChildren;\n    var others = pickOthers(Object.keys(Menu.propTypes), this.props);\n    var newClassName = cx((_cx2 = {}, _cx2[prefix + 'menu'] = true, _cx2[prefix + 'ver'] = direction === 'ver', _cx2[prefix + 'hoz'] = direction === 'hoz', _cx2[prefix + 'menu-embeddable'] = embeddable, _cx2[prefix + 'menu-nowrap'] = hozInLine, _cx2[prefix + 'menu-selectable-' + selectMode] = selectMode, _cx2[className] = !!className, _cx2));\n    var role = direction === 'hoz' ? 'menubar' : 'menu';\n    var ariaMultiselectable = void 0;\n\n    if ('selectMode' in this.props) {\n      role = 'listbox';\n      ariaMultiselectable = !!(selectMode === 'multiple');\n    }\n\n    var headerElement = header ? React.createElement('li', {\n      className: prefix + 'menu-header',\n      ref: this.menuHeaderRef\n    }, header) : null;\n    var itemsElement = !flatenContent && (header || footer) ? React.createElement('ul', {\n      className: prefix + 'menu-content',\n      ref: this.menuContentRef\n    }, newChildren) : newChildren;\n    var footerElement = footer ? React.createElement('li', {\n      className: prefix + 'menu-footer',\n      ref: this.menuFooterRef\n    }, footer) : null;\n    var shouldWrapItemsAndFooter = hozAlign === 'right' && !!header;\n\n    if (rtl) {\n      others.dir = 'rtl';\n    }\n\n    return React.createElement('ul', _extends({\n      role: role,\n      onBlur: this.onBlur,\n      className: newClassName,\n      onKeyDown: this.handleEnter,\n      'aria-multiselectable': ariaMultiselectable\n    }, others), headerElement, shouldWrapItemsAndFooter ? React.createElement('div', {\n      className: prefix + 'menu-hoz-right'\n    }, itemsElement, footerElement) : null, !shouldWrapItemsAndFooter ? itemsElement : null, !shouldWrapItemsAndFooter ? footerElement : null);\n  };\n\n  return Menu;\n}(Component), _class.isNextMenu = true, _class.propTypes = _extends({}, ConfigProvider.propTypes, {\n  prefix: PropTypes.string,\n  pure: PropTypes.bool,\n  rtl: PropTypes.bool,\n  className: PropTypes.string,\n\n  /**\n   * 菜单项和子菜单\n   */\n  children: PropTypes.node,\n\n  /**\n   * 点击菜单项触发的回调函数\n   * @param {String} key 点击的菜单项的 key 值\n   * @param {Object} item 点击的菜单项对象\n   * @param {Object} event 点击的事件对象\n   */\n  onItemClick: PropTypes.func,\n\n  /**\n   * 当前打开的子菜单的 key 值\n   */\n  openKeys: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n\n  /**\n   * 初始打开的子菜单的 key 值\n   */\n  defaultOpenKeys: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n\n  /**\n   * 初始展开所有的子菜单，只在 mode 设置为 'inline' 以及 openMode 设置为 'multiple' 下生效，优先级高于 defaultOpenKeys\n   */\n  defaultOpenAll: PropTypes.bool,\n\n  /**\n   * 打开或关闭子菜单触发的回调函数\n   * @param {Array} key 打开的所有子菜单的 key 值\n   * @param {Object} extra 额外参数\n   * @param {String} extra.key 当前操作子菜单的 key 值\n   * @param {Boolean} extra.open 是否是打开\n   */\n  onOpen: PropTypes.func,\n\n  /**\n   * 子菜单打开的模式\n   */\n  mode: PropTypes.oneOf(['inline', 'popup']),\n\n  /**\n   * 子菜单打开的触发行为\n   */\n  triggerType: PropTypes.oneOf(['click', 'hover']),\n\n  /**\n   * 展开内连子菜单的模式，同时可以展开一个子菜单还是多个子菜单，该属性仅在 mode 为 inline 时生效\n   */\n  openMode: PropTypes.oneOf(['single', 'multiple']),\n\n  /**\n   * 内连子菜单缩进距离\n   */\n  inlineIndent: PropTypes.number,\n  inlineArrowDirection: PropTypes.oneOf(['down', 'right']),\n\n  /**\n   * 是否自动让弹层的宽度和菜单项保持一致，如果弹层的宽度比菜单项小则和菜单项保持一致，如果宽度大于菜单项则不做处理\n   */\n  popupAutoWidth: PropTypes.bool,\n\n  /**\n   * 弹层的对齐方式\n   */\n  popupAlign: PropTypes.oneOf(['follow', 'outside']),\n\n  /**\n   * 弹层自定义 props\n   */\n  popupProps: PropTypes.oneOfType([PropTypes.object, PropTypes.func]),\n\n  /**\n   * 弹出子菜单自定义 className\n   */\n  popupClassName: PropTypes.string,\n\n  /**\n   * 弹出子菜单自定义 style\n   */\n  popupStyle: PropTypes.object,\n\n  /**\n   * 当前选中菜单项的 key 值\n   */\n  selectedKeys: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n\n  /**\n   * 初始选中菜单项的 key 值\n   */\n  defaultSelectedKeys: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n\n  /**\n   * 选中或取消选中菜单项触发的回调函数\n   * @param {Array} selectedKeys 选中的所有菜单项的值\n   * @param {Object} item 选中或取消选中的菜单项\n   * @param {Object} extra 额外参数\n   * @param {Boolean} extra.select 是否是选中\n   * @param {Array} extra.key 菜单项的 key\n   * @param {Object} extra.label 菜单项的文本\n   * @param {Array} extra.keyPath 菜单项 key 的路径\n   */\n  onSelect: PropTypes.func,\n\n  /**\n   * 选中模式，单选还是多选，默认无值，不可选\n   */\n  selectMode: PropTypes.oneOf(['single', 'multiple']),\n\n  /**\n   * 是否只能选择第一层菜单项（不能选择子菜单中的菜单项）\n   */\n  shallowSelect: PropTypes.bool,\n\n  /**\n   * 是否显示选中图标，如果设置为 false 需配合配置平台设置选中时的背景色以示区分\n   */\n  hasSelectedIcon: PropTypes.bool,\n  labelToggleChecked: PropTypes.bool,\n\n  /**\n   * 是否将选中图标居右，仅当 hasSelectedIcon 为true 时生效。\n   * 注意：SubMenu 上的选中图标一直居左，不受此API控制\n   */\n  isSelectIconRight: PropTypes.bool,\n\n  /**\n   * 菜单第一层展示方向\n   */\n  direction: PropTypes.oneOf(['ver', 'hoz']),\n\n  /**\n   * 横向菜单条 item 和 footer 的对齐方向，在 direction 设置为 'hoz' 并且 header 存在时生效\n   */\n  hozAlign: PropTypes.oneOf(['left', 'right']),\n\n  /**\n   * 横向菜单模式下，是否维持在一行，即超出一行折叠成 SubMenu 显示， 仅在 direction='hoz' mode='popup' 时生效\n   */\n  hozInLine: PropTypes.bool,\n  renderMore: PropTypes.func,\n\n  /**\n   * 自定义菜单头部\n   */\n  header: PropTypes.node,\n\n  /**\n   * 自定义菜单尾部\n   */\n  footer: PropTypes.node,\n\n  /**\n   * 是否自动获得焦点\n   */\n  autoFocus: PropTypes.bool,\n\n  /**\n   * 当前获得焦点的子菜单或菜单项 key 值\n   */\n  focusedKey: PropTypes.string,\n  focusable: PropTypes.bool,\n  onItemFocus: PropTypes.func,\n  onBlur: PropTypes.func,\n\n  /**\n   * 是否开启嵌入式模式，一般用于Layout的布局中，开启后没有默认背景、外层border、box-shadow，可以配合`<Menu style={{lineHeight: '100px'}}>` 自定义高度\n   * @version 1.18\n   */\n  embeddable: PropTypes.bool,\n  onItemKeyDown: PropTypes.func,\n  expandAnimation: PropTypes.bool,\n  itemClassName: PropTypes.string,\n\n  /**\n   * 可配置的icons，包括 select 等\n   */\n  icons: PropTypes.object,\n  // content 是否为单层模式，目前主要在有 header 或 footer 的时候有意义\n  flatenContent: PropTypes.bool\n}), _class.defaultProps = {\n  prefix: 'next-',\n  pure: false,\n  defaultOpenKeys: [],\n  defaultOpenAll: false,\n  onOpen: noop,\n  mode: 'inline',\n  triggerType: 'click',\n  openMode: 'multiple',\n  inlineIndent: 20,\n  inlineArrowDirection: 'down',\n  popupAutoWidth: false,\n  popupAlign: 'follow',\n  popupProps: {},\n  defaultSelectedKeys: [],\n  onSelect: noop,\n  shallowSelect: false,\n  hasSelectedIcon: true,\n  isSelectIconRight: false,\n  labelToggleChecked: true,\n  direction: 'ver',\n  hozAlign: 'left',\n  hozInLine: false,\n  autoFocus: false,\n  focusable: true,\n  embeddable: false,\n  onItemFocus: noop,\n  onItemKeyDown: noop,\n  onItemClick: noop,\n  expandAnimation: true,\n  icons: {}\n}, _temp);\nMenu.displayName = 'Menu';\nexport default polyfill(Menu);","map":{"version":3,"sources":["/Users/Chris/Project/lunch-order-backstage/node_modules/@alifd/next/es/menu/view/menu.js"],"names":["_extends","_classCallCheck","_possibleConstructorReturn","_inherits","_typeof","_class","_temp","React","Component","Children","cloneElement","findDOMNode","PropTypes","cx","polyfill","SubMenu","ConfigProvider","func","obj","dom","events","KEYCODE","getWidth","normalizeToArray","isSibling","isAncestor","isAvailablePos","getFirstAvaliablelChildKey","bindCtx","pickOthers","isNil","noop","MENUITEM_OVERFLOWED_CLASSNAME","getIndicatorsItem","items","isPlaceholder","_cx","prefix","arguments","length","undefined","renderMore","moreCls","style","visibility","display","moreNode","renderMoreCls","props","className","isValidElement","createElement","label","noIcon","addIndicators","_ref","children","lastVisibleIndex","arr","forEach","child","index","overflowedItems","key","slice","map","c","i","push","getNewChildren","_ref2","root","mode","hozInLine","k2n","p2n","loop","posPrefix","indexWrapper","inlineLevel","keyArray","type","newChild","pos","indexOf","menuChildType","level","split","disabled","_key","groupIndent","childLevel","newChildren","_k2n","_p2n","Menu","_Component","_this","call","getUpdateChildren","_this$state","state","menuContentRef","ref","menuContent","menuHeaderRef","menuHeader","menuFooterRef","menuFooter","_this$props","selectedKeys","defaultSelectedKeys","focusedKey","focusable","autoFocus","_getNewChildren","tabbableKey","openKeys","getInitOpenKeys","popupNodes","getDerivedStateFromProps","nextProps","prevState","lastMode","_getNewChildren2","prototype","componentDidMount","menuNode","adjustChildrenWidth","on","window","componentDidUpdate","prevProps","componentWillUnmount","off","_props","direction","header","footer","spaceWidth","currentSumWidth","menuItemNodes","filter","node","setStyle","moreWidth","menuItemSizes","totalLen","liWidth","setState","onBlur","e","initOpenKeys","defaultOpenKeys","defaultOpenAll","openMode","Object","keys","handleOpen","open","triggerType","newOpenKeys","_props2","_state","k","concat","some","contains","target","onOpen","getPath","keyPath","labelPath","nums","parentNums","parentPos","join","parent","handleSelect","select","menuItem","_state2","shallowSelect","newSelectedKeys","selectMode","onSelect","handleItemClick","item","onItemFocus","parentMode","sort","prevKey","nextKey","onItemClick","getAvailableKey","prev","ps","p","targetIndex","getParentKey","handleItemKeyDown","UP","DOWN","RIGHT","LEFT","ENTER","ESC","SPACE","keyCode","preventDefault","stopPropagation","_state3","avaliableKey","_avaliableKey","_avaliableKey2","_avaliableKey3","_avaliableKey4","parentKey","_parentKey","TAB","onItemKeyDown","render","_cx2","_props3","hozAlign","embeddable","rtl","flatenContent","others","propTypes","newClassName","role","ariaMultiselectable","headerElement","itemsElement","footerElement","shouldWrapItemsAndFooter","dir","onKeyDown","handleEnter","isNextMenu","string","pure","bool","oneOfType","array","oneOf","inlineIndent","number","inlineArrowDirection","popupAutoWidth","popupAlign","popupProps","object","popupClassName","popupStyle","hasSelectedIcon","labelToggleChecked","isSelectIconRight","expandAnimation","itemClassName","icons","defaultProps","displayName"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport _typeof from 'babel-runtime/helpers/typeof';\n\nvar _class, _temp;\n\nimport React, { Component, Children, cloneElement } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport { polyfill } from 'react-lifecycles-compat';\nimport SubMenu from './sub-menu';\nimport ConfigProvider from '../../config-provider';\nimport { func, obj, dom, events, KEYCODE } from '../../util';\nimport { getWidth, normalizeToArray, isSibling, isAncestor, isAvailablePos, getFirstAvaliablelChildKey } from './util';\n\nvar bindCtx = func.bindCtx;\nvar pickOthers = obj.pickOthers,\n    isNil = obj.isNil;\n\nvar noop = function noop() {};\nvar MENUITEM_OVERFLOWED_CLASSNAME = 'menuitem-overflowed';\n\nvar getIndicatorsItem = function getIndicatorsItem(items, isPlaceholder) {\n    var _cx;\n\n    var prefix = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n    var renderMore = arguments[3];\n\n    var moreCls = cx((_cx = {}, _cx[prefix + 'menu-more'] = true, _cx));\n\n    var style = {};\n    // keep placehold to get width\n    if (isPlaceholder) {\n        style.visibility = 'hidden';\n        style.display = 'inline-block';\n        // indicators which not in use, just display: none\n    } else if (items && items.length === 0) {\n        style.display = 'none';\n        style.visibility = 'unset';\n    }\n\n    if (renderMore && typeof renderMore === 'function') {\n        var moreNode = renderMore(items);\n        var renderMoreCls = cx(moreCls, moreNode.props && moreNode.props.className);\n\n        return React.isValidElement(moreNode) ? React.cloneElement(moreNode, {\n            style: style,\n            className: renderMoreCls\n        }) : moreNode;\n    }\n\n    return React.createElement(\n        SubMenu,\n        { label: '\\xB7\\xB7\\xB7', noIcon: true, className: moreCls, style: style },\n        items\n    );\n};\n\nvar addIndicators = function addIndicators(_ref) {\n    var children = _ref.children,\n        lastVisibleIndex = _ref.lastVisibleIndex,\n        prefix = _ref.prefix,\n        renderMore = _ref.renderMore;\n\n    var arr = [];\n\n    children.forEach(function (child, index) {\n        if (!child) {\n            return;\n        }\n        var overflowedItems = [];\n\n        if (index > lastVisibleIndex) {\n            child = React.cloneElement(child, {\n                key: 'more-' + index,\n                style: { display: 'none' },\n                className: (child && child.className || '') + ' ' + MENUITEM_OVERFLOWED_CLASSNAME\n            });\n        }\n\n        if (index === lastVisibleIndex + 1) {\n            overflowedItems = children.slice(lastVisibleIndex + 1).map(function (c, i) {\n                return React.cloneElement(c, {\n                    key: 'more-' + index + '-' + i\n                });\n            });\n            arr.push(getIndicatorsItem(overflowedItems, false, prefix, renderMore));\n        }\n\n        arr.push(child);\n    });\n\n    arr.push(getIndicatorsItem([], true, prefix, renderMore));\n\n    return arr;\n};\n\nvar getNewChildren = function getNewChildren(_ref2) {\n    var children = _ref2.children,\n        root = _ref2.root,\n        mode = _ref2.mode,\n        lastVisibleIndex = _ref2.lastVisibleIndex,\n        hozInLine = _ref2.hozInLine,\n        prefix = _ref2.prefix,\n        renderMore = _ref2.renderMore;\n\n    var k2n = {};\n    var p2n = {};\n\n    var arr = hozInLine ? addIndicators({\n        children: children,\n        lastVisibleIndex: lastVisibleIndex,\n        prefix: prefix,\n        renderMore: renderMore\n    }) : children;\n\n    var loop = function loop(children, posPrefix) {\n        var indexWrapper = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : { index: 0 };\n        var inlineLevel = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n\n        var keyArray = [];\n        return Children.map(children, function (child) {\n            if (child && (typeof child.type === 'function' ||\n            // `React.forwardRef(render)` returns a forwarding\n            // object that includes `render` method, and the specific\n            // `child.type` will be an object instead of a class or\n            // function.\n            _typeof(child.type) === 'object') && 'menuChildType' in child.type) {\n                var newChild = void 0;\n\n                var pos = void 0;\n                var props = { root: root };\n\n                if (['item', 'submenu', 'group'].indexOf(child.type.menuChildType) > -1) {\n                    pos = posPrefix + '-' + indexWrapper.index++;\n                    var key = typeof child.key === 'string' ? child.key : pos;\n\n                    // filter out duplicate keys\n                    if (keyArray.indexOf(key) > -1) {\n                        return;\n                    }\n\n                    keyArray.push(key);\n\n                    var level = pos.split('-').length - 1;\n                    k2n[key] = p2n[pos] = {\n                        key: key,\n                        pos: pos,\n                        mode: child.props.mode,\n                        type: child.type.menuChildType,\n                        disabled: child.props.disabled,\n                        label: child.props.label || child.props.children\n                    };\n\n                    props.level = level;\n                    props.inlineLevel = inlineLevel;\n                    props._key = key;\n                    props.groupIndent = child.type.menuChildType === 'group' ? 1 : 0;\n                }\n\n                // paddingLeft(or paddingRight in rtl) only make sense in inline mode\n                // parent know children's inlineLevel\n                // if parent's mode is popup, then children's inlineLevel must be 1;\n                // else inlineLevel should add 1\n                var childLevel = (child.props.mode || mode) === 'popup' ? 1 : inlineLevel + 1;\n\n                switch (child.type.menuChildType) {\n                    case 'submenu':\n                        newChild = cloneElement(child, props, loop(child.props.children, pos, undefined, childLevel));\n                        break;\n                    case 'group':\n                        newChild = cloneElement(child, props, loop(child.props.children, posPrefix, indexWrapper, props.level));\n                        break;\n                    case 'item':\n                    case 'divider':\n                        newChild = cloneElement(child, props);\n                        break;\n                    default:\n                        newChild = child;\n                        break;\n                }\n\n                return newChild;\n            }\n\n            return child;\n        });\n    };\n\n    var newChildren = loop(arr, '0');\n\n    return {\n        newChildren: newChildren,\n        _k2n: k2n,\n        _p2n: p2n\n    };\n};\n\n/**\n * Menu\n */\nvar Menu = (_temp = _class = function (_Component) {\n    _inherits(Menu, _Component);\n\n    function Menu(props) {\n        _classCallCheck(this, Menu);\n\n        var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n        _this.getUpdateChildren = function () {\n            var _this$state = _this.state,\n                root = _this$state.root,\n                lastVisibleIndex = _this$state.lastVisibleIndex;\n\n\n            return getNewChildren(_extends({\n                root: root,\n                lastVisibleIndex: lastVisibleIndex\n            }, _this.props));\n        };\n\n        _this.menuContentRef = function (ref) {\n            _this.menuContent = ref;\n        };\n\n        _this.menuHeaderRef = function (ref) {\n            _this.menuHeader = ref;\n        };\n\n        _this.menuFooterRef = function (ref) {\n            _this.menuFooter = ref;\n        };\n\n        var _this$props = _this.props,\n            prefix = _this$props.prefix,\n            children = _this$props.children,\n            selectedKeys = _this$props.selectedKeys,\n            defaultSelectedKeys = _this$props.defaultSelectedKeys,\n            focusedKey = _this$props.focusedKey,\n            focusable = _this$props.focusable,\n            autoFocus = _this$props.autoFocus,\n            hozInLine = _this$props.hozInLine,\n            renderMore = _this$props.renderMore;\n\n\n        _this.state = {\n            lastVisibleIndex: undefined\n        };\n\n        var _getNewChildren = getNewChildren(_extends({\n            root: _this\n        }, _this.props)),\n            newChildren = _getNewChildren.newChildren,\n            _k2n = _getNewChildren._k2n,\n            _p2n = _getNewChildren._p2n;\n\n        var tabbableKey = focusable ? getFirstAvaliablelChildKey('0', _p2n) : undefined;\n\n        _this.state = {\n            root: _this,\n            lastVisibleIndex: undefined,\n            newChildren: newChildren,\n            _k2n: _k2n,\n            _p2n: _p2n,\n            tabbableKey: tabbableKey,\n            openKeys: _this.getInitOpenKeys(props, _k2n, _p2n),\n            selectedKeys: normalizeToArray(selectedKeys || defaultSelectedKeys),\n            focusedKey: !isNil(_this.props.focusedKey) ? focusedKey : focusable && autoFocus ? tabbableKey : null\n        };\n\n        bindCtx(_this, ['handleOpen', 'handleSelect', 'handleItemClick', 'handleItemKeyDown', 'onBlur', 'adjustChildrenWidth']);\n\n        _this.popupNodes = [];\n        return _this;\n    }\n\n    Menu.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n        var state = {};\n\n        if ('openKeys' in nextProps) {\n            state.openKeys = normalizeToArray(nextProps.openKeys);\n            // 从展开状态变为收起状态，才需要清空openKeys\n        } else if ('mode' in nextProps && nextProps.mode === 'popup' && prevState.lastMode === 'inline') {\n            state.openKeys = [];\n        }\n\n        if ('selectedKeys' in nextProps) {\n            state.selectedKeys = normalizeToArray(nextProps.selectedKeys);\n        }\n        if ('focusedKey' in nextProps) {\n            state.focusedKey = nextProps.focusedKey;\n        }\n\n        state.lastMode = nextProps.mode;\n\n        var _getNewChildren2 = getNewChildren(_extends({\n            root: prevState.root,\n            lastVisibleIndex: prevState.lastVisibleIndex\n        }, nextProps)),\n            newChildren = _getNewChildren2.newChildren,\n            _k2n = _getNewChildren2._k2n,\n            _p2n = _getNewChildren2._p2n;\n\n        state.newChildren = newChildren;\n        state._k2n = _k2n;\n        state._p2n = _p2n;\n\n        if (nextProps.focusable) {\n            if (prevState.tabbableKey in _k2n) {\n                if (prevState.focusedKey) {\n                    state.tabbableKey = prevState.focusedKey;\n                }\n            } else {\n                state.tabbableKey = getFirstAvaliablelChildKey('0', _p2n);\n            }\n        }\n\n        return state;\n    };\n\n    Menu.prototype.componentDidMount = function componentDidMount() {\n        this.menuNode = findDOMNode(this);\n\n        this.adjustChildrenWidth();\n\n        if (this.props.hozInLine) {\n            events.on(window, 'resize', this.adjustChildrenWidth);\n        }\n    };\n\n    Menu.prototype.componentDidUpdate = function componentDidUpdate(prevProps, prevState) {\n        if (prevState.lastVisibleIndex !== this.state.lastVisibleIndex) {\n            this.adjustChildrenWidth();\n        }\n    };\n\n    Menu.prototype.componentWillUnmount = function componentWillUnmount() {\n        events.off(window, 'resize', this.adjustChildrenWidth);\n    };\n\n    Menu.prototype.adjustChildrenWidth = function adjustChildrenWidth() {\n        var _props = this.props,\n            direction = _props.direction,\n            prefix = _props.prefix,\n            header = _props.header,\n            footer = _props.footer,\n            hozInLine = _props.hozInLine;\n\n        if (direction !== 'hoz' || !hozInLine) {\n            return;\n        }\n\n        if (!this.menuNode && !this.menuContent) {\n            return;\n        }\n\n        var children = [],\n            spaceWidth = void 0;\n\n        if (header || footer) {\n            children = this.menuContent.children;\n            spaceWidth = getWidth(this.menuNode) - getWidth(this.menuHeader) - getWidth(this.menuFooter);\n        } else {\n            children = this.menuNode.children;\n            spaceWidth = getWidth(this.menuNode);\n        }\n\n        if (children.length < 2) {\n            return;\n        }\n\n        var currentSumWidth = 0,\n            lastVisibleIndex = -1;\n\n        var moreNode = '';\n\n        var menuItemNodes = [].slice.call(children).filter(function (node) {\n            if (node.className.split(' ').indexOf(prefix + 'menu-more') < 0) {\n                return true;\n            } else {\n                moreNode = node;\n            }\n            return false;\n        });\n\n        var overflowedItems = menuItemNodes.filter(function (c) {\n            return c.className.split(' ').indexOf(MENUITEM_OVERFLOWED_CLASSNAME) >= 0;\n        });\n\n        overflowedItems.forEach(function (c) {\n            dom.setStyle(c, 'display', 'inline-block');\n        });\n\n        dom.setStyle(moreNode, 'display', 'inline-block');\n        var moreWidth = getWidth(moreNode);\n\n        this.menuItemSizes = menuItemNodes.map(function (c) {\n            return getWidth(c);\n        });\n        var totalLen = this.menuItemSizes.length;\n\n        overflowedItems.forEach(function (c) {\n            dom.setStyle(c, 'display', 'none');\n        });\n\n        this.menuItemSizes.forEach(function (liWidth, i) {\n            currentSumWidth += liWidth;\n            if (i >= totalLen - 1 && currentSumWidth <= spaceWidth || currentSumWidth + moreWidth <= spaceWidth) {\n                lastVisibleIndex++;\n            }\n        });\n\n        if (lastVisibleIndex >= totalLen - 1) {\n            dom.setStyle(moreNode, 'display', 'none');\n        }\n\n        this.setState(_extends({\n            lastVisibleIndex: lastVisibleIndex\n        }, this.getUpdateChildren()));\n    };\n\n    Menu.prototype.onBlur = function onBlur(e) {\n        this.setState({\n            focusedKey: undefined\n        });\n\n        this.props.onBlur && this.props.onBlur(e);\n    };\n\n    Menu.prototype.getInitOpenKeys = function getInitOpenKeys(props, _k2n, _p2n) {\n        var initOpenKeys = void 0;\n\n        var openKeys = props.openKeys,\n            defaultOpenKeys = props.defaultOpenKeys,\n            defaultOpenAll = props.defaultOpenAll,\n            mode = props.mode,\n            openMode = props.openMode;\n\n        if (openKeys) {\n            initOpenKeys = openKeys;\n        } else if (defaultOpenAll && mode === 'inline' && openMode === 'multiple') {\n            initOpenKeys = Object.keys(_k2n).filter(function (key) {\n                return _k2n[key].type === 'submenu';\n            });\n        } else {\n            initOpenKeys = defaultOpenKeys;\n        }\n\n        return normalizeToArray(initOpenKeys);\n    };\n\n    Menu.prototype.handleOpen = function handleOpen(key, open, triggerType, e) {\n        var newOpenKeys = void 0;\n\n        var _props2 = this.props,\n            mode = _props2.mode,\n            openMode = _props2.openMode;\n        var _state = this.state,\n            openKeys = _state.openKeys,\n            _k2n = _state._k2n;\n\n        var index = openKeys.indexOf(key);\n        if (open && index === -1) {\n            if (mode === 'inline') {\n                if (openMode === 'single') {\n                    newOpenKeys = openKeys.filter(function (k) {\n                        return _k2n[k] && !isSibling(_k2n[key].pos, _k2n[k].pos);\n                    });\n                    newOpenKeys.push(key);\n                } else {\n                    newOpenKeys = openKeys.concat(key);\n                }\n            } else {\n                newOpenKeys = openKeys.filter(function (k) {\n                    return _k2n[k] && isAncestor(_k2n[key].pos, _k2n[k].pos);\n                });\n                newOpenKeys.push(key);\n            }\n        } else if (!open && index > -1) {\n            if (mode === 'inline') {\n                newOpenKeys = [].concat(openKeys.slice(0, index), openKeys.slice(index + 1));\n            } else if (triggerType === 'docClick') {\n                if (!this.popupNodes.concat(this.menuNode).some(function (node) {\n                    return node.contains(e.target);\n                })) {\n                    newOpenKeys = [];\n                }\n            } else {\n                newOpenKeys = openKeys.filter(function (k) {\n                    return k !== key && _k2n[k] && !isAncestor(_k2n[k].pos, _k2n[key].pos);\n                });\n            }\n        }\n\n        if (newOpenKeys) {\n            if (isNil(this.props.openKeys)) {\n                this.setState(_extends({\n                    openKeys: newOpenKeys\n                }, this.getUpdateChildren()));\n            }\n\n            this.props.onOpen(newOpenKeys, {\n                key: key,\n                open: open\n            });\n        }\n    };\n\n    Menu.prototype.getPath = function getPath(key, _k2n, _p2n) {\n        var keyPath = [];\n        var labelPath = [];\n\n        var pos = _k2n[key].pos;\n        var nums = pos.split('-');\n        for (var i = 1; i < nums.length - 1; i++) {\n            var parentNums = nums.slice(0, i + 1);\n            var parentPos = parentNums.join('-');\n            var parent = _p2n[parentPos];\n            keyPath.push(parent.key);\n            labelPath.push(parent.label);\n        }\n\n        return {\n            keyPath: keyPath,\n            labelPath: labelPath\n        };\n    };\n\n    Menu.prototype.handleSelect = function handleSelect(key, select, menuItem) {\n        var _state2 = this.state,\n            _k2n = _state2._k2n,\n            _p2n = _state2._p2n;\n\n        var pos = _k2n[key].pos;\n        var level = pos.split('-').length - 1;\n        if (this.props.shallowSelect && level > 1) {\n            return;\n        }\n\n        var newSelectedKeys = void 0;\n\n        var selectMode = this.props.selectMode;\n        var selectedKeys = this.state.selectedKeys;\n\n        var index = selectedKeys.indexOf(key);\n        if (select && index === -1) {\n            if (selectMode === 'single') {\n                newSelectedKeys = [key];\n            } else if (selectMode === 'multiple') {\n                newSelectedKeys = selectedKeys.concat(key);\n            }\n        } else if (!select && index > -1 && selectMode === 'multiple') {\n            newSelectedKeys = [].concat(selectedKeys.slice(0, index), selectedKeys.slice(index + 1));\n        }\n\n        if (newSelectedKeys) {\n            if (isNil(this.props.selectedKeys)) {\n                this.setState({\n                    selectedKeys: newSelectedKeys\n                });\n            }\n\n            this.props.onSelect(newSelectedKeys, menuItem, _extends({\n                key: key,\n                select: select,\n                label: _k2n[key].label\n            }, this.getPath(key, _k2n, _p2n)));\n        }\n    };\n\n    Menu.prototype.handleItemClick = function handleItemClick(key, item, e) {\n        var _k2n = this.state._k2n;\n\n        if (this.props.focusable) {\n            if (isNil(this.props.focusedKey)) {\n                this.setState({\n                    focusedKey: key\n                });\n            }\n\n            this.props.onItemFocus(key, item, e);\n        }\n\n        if (item.props.type === 'item') {\n            if (item.props.parentMode === 'popup' && this.state.openKeys.length) {\n                if (isNil(this.props.openKeys)) {\n                    this.setState({\n                        openKeys: []\n                    });\n                }\n\n                this.props.onOpen([], {\n                    key: this.state.openKeys.sort(function (prevKey, nextKey) {\n                        return _k2n[nextKey].pos.split('-').length - _k2n[prevKey].pos.split('-').length;\n                    })[0],\n                    open: false\n                });\n            }\n\n            this.props.onItemClick(key, item, e);\n        }\n    };\n\n    Menu.prototype.getAvailableKey = function getAvailableKey(pos, prev) {\n        var _p2n = this.state._p2n;\n\n        var ps = Object.keys(_p2n).filter(function (p) {\n            return isAvailablePos(pos, p, _p2n);\n        });\n        if (ps.length > 1) {\n            var index = ps.indexOf(pos);\n            var targetIndex = void 0;\n            if (prev) {\n                targetIndex = index === 0 ? ps.length - 1 : index - 1;\n            } else {\n                targetIndex = index === ps.length - 1 ? 0 : index + 1;\n            }\n\n            return _p2n[ps[targetIndex]].key;\n        }\n\n        return null;\n    };\n\n    Menu.prototype.getParentKey = function getParentKey(pos) {\n        return this.state._p2n[pos.slice(0, pos.length - 2)].key;\n    };\n\n    Menu.prototype.handleItemKeyDown = function handleItemKeyDown(key, type, item, e) {\n        if ([KEYCODE.UP, KEYCODE.DOWN, KEYCODE.RIGHT, KEYCODE.LEFT, KEYCODE.ENTER, KEYCODE.ESC, KEYCODE.SPACE].indexOf(e.keyCode) > -1) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n\n        var focusedKey = this.state.focusedKey;\n        var _state3 = this.state,\n            _p2n = _state3._p2n,\n            _k2n = _state3._k2n;\n        var direction = this.props.direction;\n\n        var pos = _k2n[key].pos;\n        var level = pos.split('-').length - 1;\n        switch (e.keyCode) {\n            case KEYCODE.UP:\n                {\n                    var avaliableKey = this.getAvailableKey(pos, true);\n                    if (avaliableKey) {\n                        focusedKey = avaliableKey;\n                    }\n                    break;\n                }\n            case KEYCODE.DOWN:\n                {\n                    var _avaliableKey = void 0;\n                    if (direction === 'hoz' && level === 1 && type === 'submenu') {\n                        this.handleOpen(key, true);\n                        _avaliableKey = getFirstAvaliablelChildKey(pos, _p2n);\n                    } else {\n                        _avaliableKey = this.getAvailableKey(pos, false);\n                    }\n                    if (_avaliableKey) {\n                        focusedKey = _avaliableKey;\n                    }\n                    break;\n                }\n            case KEYCODE.RIGHT:\n                {\n                    var _avaliableKey2 = void 0;\n                    if (direction === 'hoz' && level === 1) {\n                        _avaliableKey2 = this.getAvailableKey(pos, false);\n                    } else if (type === 'submenu') {\n                        this.handleOpen(key, true);\n                        _avaliableKey2 = getFirstAvaliablelChildKey(pos, _p2n);\n                    }\n                    if (_avaliableKey2) {\n                        focusedKey = _avaliableKey2;\n                    }\n                    break;\n                }\n            case KEYCODE.ENTER:\n                {\n                    if (type === 'submenu') {\n                        this.handleOpen(key, true);\n                        var _avaliableKey3 = getFirstAvaliablelChildKey(pos, _p2n);\n                        if (_avaliableKey3) {\n                            focusedKey = _avaliableKey3;\n                        }\n                    }\n                    break;\n                }\n            case KEYCODE.LEFT:\n                {\n                    if (direction === 'hoz' && level === 1) {\n                        var _avaliableKey4 = this.getAvailableKey(pos, true);\n                        if (_avaliableKey4) {\n                            focusedKey = _avaliableKey4;\n                        }\n                    } else if (level > 1) {\n                        var parentKey = this.getParentKey(pos);\n                        this.handleOpen(parentKey, false);\n                        focusedKey = parentKey;\n                    }\n                    break;\n                }\n            case KEYCODE.ESC:\n                if (level > 1) {\n                    var _parentKey = this.getParentKey(pos);\n                    this.handleOpen(_parentKey, false);\n                    focusedKey = _parentKey;\n                }\n                break;\n\n            case KEYCODE.TAB:\n                focusedKey = null;\n                break;\n            default:\n                break;\n        }\n\n        if (focusedKey !== this.state.focusedKey) {\n            if (isNil(this.props.focusedKey)) {\n                this.setState({\n                    focusedKey: focusedKey\n                });\n            }\n\n            this.props.onItemKeyDown(focusedKey, item, e);\n            this.props.onItemFocus(focusedKey, e);\n        }\n    };\n\n    Menu.prototype.render = function render() {\n        var _cx2;\n\n        var _props3 = this.props,\n            prefix = _props3.prefix,\n            className = _props3.className,\n            direction = _props3.direction,\n            hozAlign = _props3.hozAlign,\n            header = _props3.header,\n            footer = _props3.footer,\n            embeddable = _props3.embeddable,\n            selectMode = _props3.selectMode,\n            hozInLine = _props3.hozInLine,\n            rtl = _props3.rtl,\n            flatenContent = _props3.flatenContent;\n        var newChildren = this.state.newChildren;\n\n        var others = pickOthers(Object.keys(Menu.propTypes), this.props);\n\n        var newClassName = cx((_cx2 = {}, _cx2[prefix + 'menu'] = true, _cx2[prefix + 'ver'] = direction === 'ver', _cx2[prefix + 'hoz'] = direction === 'hoz', _cx2[prefix + 'menu-embeddable'] = embeddable, _cx2[prefix + 'menu-nowrap'] = hozInLine, _cx2[prefix + 'menu-selectable-' + selectMode] = selectMode, _cx2[className] = !!className, _cx2));\n\n        var role = direction === 'hoz' ? 'menubar' : 'menu';\n        var ariaMultiselectable = void 0;\n        if ('selectMode' in this.props) {\n            role = 'listbox';\n            ariaMultiselectable = !!(selectMode === 'multiple');\n        }\n\n        var headerElement = header ? React.createElement(\n            'li',\n            { className: prefix + 'menu-header', ref: this.menuHeaderRef },\n            header\n        ) : null;\n        var itemsElement = !flatenContent && (header || footer) ? React.createElement(\n            'ul',\n            { className: prefix + 'menu-content', ref: this.menuContentRef },\n            newChildren\n        ) : newChildren;\n        var footerElement = footer ? React.createElement(\n            'li',\n            { className: prefix + 'menu-footer', ref: this.menuFooterRef },\n            footer\n        ) : null;\n        var shouldWrapItemsAndFooter = hozAlign === 'right' && !!header;\n\n        if (rtl) {\n            others.dir = 'rtl';\n        }\n\n        return React.createElement(\n            'ul',\n            _extends({\n                role: role,\n                onBlur: this.onBlur,\n                className: newClassName,\n                onKeyDown: this.handleEnter,\n                'aria-multiselectable': ariaMultiselectable\n            }, others),\n            headerElement,\n            shouldWrapItemsAndFooter ? React.createElement(\n                'div',\n                { className: prefix + 'menu-hoz-right' },\n                itemsElement,\n                footerElement\n            ) : null,\n            !shouldWrapItemsAndFooter ? itemsElement : null,\n            !shouldWrapItemsAndFooter ? footerElement : null\n        );\n    };\n\n    return Menu;\n}(Component), _class.isNextMenu = true, _class.propTypes = _extends({}, ConfigProvider.propTypes, {\n    prefix: PropTypes.string,\n    pure: PropTypes.bool,\n    rtl: PropTypes.bool,\n    className: PropTypes.string,\n    /**\n     * 菜单项和子菜单\n     */\n    children: PropTypes.node,\n    /**\n     * 点击菜单项触发的回调函数\n     * @param {String} key 点击的菜单项的 key 值\n     * @param {Object} item 点击的菜单项对象\n     * @param {Object} event 点击的事件对象\n     */\n    onItemClick: PropTypes.func,\n    /**\n     * 当前打开的子菜单的 key 值\n     */\n    openKeys: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n    /**\n     * 初始打开的子菜单的 key 值\n     */\n    defaultOpenKeys: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n    /**\n     * 初始展开所有的子菜单，只在 mode 设置为 'inline' 以及 openMode 设置为 'multiple' 下生效，优先级高于 defaultOpenKeys\n     */\n    defaultOpenAll: PropTypes.bool,\n    /**\n     * 打开或关闭子菜单触发的回调函数\n     * @param {Array} key 打开的所有子菜单的 key 值\n     * @param {Object} extra 额外参数\n     * @param {String} extra.key 当前操作子菜单的 key 值\n     * @param {Boolean} extra.open 是否是打开\n     */\n    onOpen: PropTypes.func,\n    /**\n     * 子菜单打开的模式\n     */\n    mode: PropTypes.oneOf(['inline', 'popup']),\n    /**\n     * 子菜单打开的触发行为\n     */\n    triggerType: PropTypes.oneOf(['click', 'hover']),\n    /**\n     * 展开内连子菜单的模式，同时可以展开一个子菜单还是多个子菜单，该属性仅在 mode 为 inline 时生效\n     */\n    openMode: PropTypes.oneOf(['single', 'multiple']),\n    /**\n     * 内连子菜单缩进距离\n     */\n    inlineIndent: PropTypes.number,\n    inlineArrowDirection: PropTypes.oneOf(['down', 'right']),\n    /**\n     * 是否自动让弹层的宽度和菜单项保持一致，如果弹层的宽度比菜单项小则和菜单项保持一致，如果宽度大于菜单项则不做处理\n     */\n    popupAutoWidth: PropTypes.bool,\n    /**\n     * 弹层的对齐方式\n     */\n    popupAlign: PropTypes.oneOf(['follow', 'outside']),\n    /**\n     * 弹层自定义 props\n     */\n    popupProps: PropTypes.oneOfType([PropTypes.object, PropTypes.func]),\n    /**\n     * 弹出子菜单自定义 className\n     */\n    popupClassName: PropTypes.string,\n    /**\n     * 弹出子菜单自定义 style\n     */\n    popupStyle: PropTypes.object,\n    /**\n     * 当前选中菜单项的 key 值\n     */\n    selectedKeys: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n    /**\n     * 初始选中菜单项的 key 值\n     */\n    defaultSelectedKeys: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n    /**\n     * 选中或取消选中菜单项触发的回调函数\n     * @param {Array} selectedKeys 选中的所有菜单项的值\n     * @param {Object} item 选中或取消选中的菜单项\n     * @param {Object} extra 额外参数\n     * @param {Boolean} extra.select 是否是选中\n     * @param {Array} extra.key 菜单项的 key\n     * @param {Object} extra.label 菜单项的文本\n     * @param {Array} extra.keyPath 菜单项 key 的路径\n     */\n    onSelect: PropTypes.func,\n    /**\n     * 选中模式，单选还是多选，默认无值，不可选\n     */\n    selectMode: PropTypes.oneOf(['single', 'multiple']),\n    /**\n     * 是否只能选择第一层菜单项（不能选择子菜单中的菜单项）\n     */\n    shallowSelect: PropTypes.bool,\n    /**\n     * 是否显示选中图标，如果设置为 false 需配合配置平台设置选中时的背景色以示区分\n     */\n    hasSelectedIcon: PropTypes.bool,\n    labelToggleChecked: PropTypes.bool,\n    /**\n     * 是否将选中图标居右，仅当 hasSelectedIcon 为true 时生效。\n     * 注意：SubMenu 上的选中图标一直居左，不受此API控制\n     */\n    isSelectIconRight: PropTypes.bool,\n    /**\n     * 菜单第一层展示方向\n     */\n    direction: PropTypes.oneOf(['ver', 'hoz']),\n    /**\n     * 横向菜单条 item 和 footer 的对齐方向，在 direction 设置为 'hoz' 并且 header 存在时生效\n     */\n    hozAlign: PropTypes.oneOf(['left', 'right']),\n    /**\n     * 横向菜单模式下，是否维持在一行，即超出一行折叠成 SubMenu 显示， 仅在 direction='hoz' mode='popup' 时生效\n     */\n    hozInLine: PropTypes.bool,\n    renderMore: PropTypes.func,\n    /**\n     * 自定义菜单头部\n     */\n    header: PropTypes.node,\n    /**\n     * 自定义菜单尾部\n     */\n    footer: PropTypes.node,\n    /**\n     * 是否自动获得焦点\n     */\n    autoFocus: PropTypes.bool,\n    /**\n     * 当前获得焦点的子菜单或菜单项 key 值\n     */\n    focusedKey: PropTypes.string,\n    focusable: PropTypes.bool,\n    onItemFocus: PropTypes.func,\n    onBlur: PropTypes.func,\n    /**\n     * 是否开启嵌入式模式，一般用于Layout的布局中，开启后没有默认背景、外层border、box-shadow，可以配合`<Menu style={{lineHeight: '100px'}}>` 自定义高度\n     * @version 1.18\n     */\n    embeddable: PropTypes.bool,\n    onItemKeyDown: PropTypes.func,\n    expandAnimation: PropTypes.bool,\n    itemClassName: PropTypes.string,\n    /**\n     * 可配置的icons，包括 select 等\n     */\n    icons: PropTypes.object,\n    // content 是否为单层模式，目前主要在有 header 或 footer 的时候有意义\n    flatenContent: PropTypes.bool\n}), _class.defaultProps = {\n    prefix: 'next-',\n    pure: false,\n    defaultOpenKeys: [],\n    defaultOpenAll: false,\n    onOpen: noop,\n    mode: 'inline',\n    triggerType: 'click',\n    openMode: 'multiple',\n    inlineIndent: 20,\n    inlineArrowDirection: 'down',\n    popupAutoWidth: false,\n    popupAlign: 'follow',\n    popupProps: {},\n    defaultSelectedKeys: [],\n    onSelect: noop,\n    shallowSelect: false,\n    hasSelectedIcon: true,\n    isSelectIconRight: false,\n    labelToggleChecked: true,\n    direction: 'ver',\n    hozAlign: 'left',\n    hozInLine: false,\n    autoFocus: false,\n    focusable: true,\n    embeddable: false,\n    onItemFocus: noop,\n    onItemKeyDown: noop,\n    onItemClick: noop,\n    expandAnimation: true,\n    icons: {}\n}, _temp);\nMenu.displayName = 'Menu';\n\n\nexport default polyfill(Menu);"]},"metadata":{},"sourceType":"module"}